



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="Hexo" href="http://example.com/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="Hexo" href="http://example.com/atom.xml" />
<link rel="alternate" type="application/json" title="Hexo" href="http://example.com/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  

<link rel="canonical" href="http://example.com/yuque/%E7%A0%B4%E8%A7%A3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B9%8B%E8%AE%A4%E8%AF%86%E5%A3%B3%E4%B8%8E%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%89%B9%E5%BE%81">



  <title>破解基础知识之认识壳与程序的特征 |
Yume Shoka = Hexo</title>
<meta name="generator" content="Hexo 5.4.2"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">破解基础知识之认识壳与程序的特征
  </h1>

          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Yume Shoka</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicli9lfebj20zk0m84qp.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclwuom7cj20zk0m8dvn.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicm0fdw5cj20zk0m8hdt.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipexe4oykj20zk0m87ji.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicitht3xtj20zk0m8k5v.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipew28b65j20zk0m8hdt.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="page wrap">
    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="en">
  <link itemprop="mainEntityOfPage" href="http://example.com/yuque/%E7%A0%B4%E8%A7%A3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B9%8B%E8%AE%A4%E8%AF%86%E5%A3%B3%E4%B8%8E%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%89%B9%E5%BE%81.html">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="John Doe">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Hexo">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="破解基础知识之认识壳与程序的特征"><a class="markdownIt-Anchor" href="#破解基础知识之认识壳与程序的特征">#</a> 破解基础知识之认识壳与程序的特征</h1>
<p>一个程序从编译出来的时候一般都是没有壳的，不同编译器编译出的无壳程序也是不相同的，认识了不同编译器编译出来的无壳的程序，再去看无壳程序被加壳程序加壳后的样子就轻松很多，经过对比从而了解不同语言无壳程序和加壳后程序的特征是什么，特征主要从 “入口点代码”、“程序区段” 和 “加载模块” 等信息来确定。<br>
一：程序是什么语言编译的<br>
从目前国内接触到程序看，比较流行的编译器有：VC 系列、易语言、.NET、Delphi，一些曾经用的很多但渐渐少了有：VB、ASM、BC++，还有一些用的比较少的有：AutoIt、PB、QT 等，结合实例来看看 “入口点代码”、“程序区段” 和 “加载模块” 等特征。</p>
<p><strong>一般使用 exeinfo PE 来识别壳和编译程序，但是还需要根据区段信息 (比如.data,.text)，并且结合代码入口特征来充分判断。</strong></p>
<p>PEinfo 也可以识别，但是由于已经暂停维护，可能会导致误报</p>
<h2 id="vc60"><a class="markdownIt-Anchor" href="#vc60">#</a> vc6.0</h2>
<p>VC++ 6.0 编译，无壳程序<br>
<img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691322093772-857dd715-8cf2-44d9-b23a-398421702e98.png" alt="img"></p>
<p>** 入口特征：**<strong> 入口点代码是固定的代码，入口调用的 API 也是相同的，其中有的 push 地址不同程序可能不同；区段有四个也是固定的.text、.rdata、.data 和.rsrc。</strong></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691322197630-5d58b322-0a5b-4323-abe7-1bf1e637ba71.png" alt="img"></p>
<p>区段特征：</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691322254484-5f7cb10b-e78f-43ef-84e5-de30b7966f7e.png" alt="img"></p>
<p>特征码： <code>55 8B EC 6A FF 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? 64 A1 00 00 00 00 50 64 89 25 00 00 00 00</code></p>
<h3 id="vc"><a class="markdownIt-Anchor" href="#vc">#</a> VC++</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">55            PUSH EBP</span><br><span class="line">8BEC          MOV EBP,ESP</span><br><span class="line">83EC 44       SUB ESP,44</span><br><span class="line">56            PUSH ESI</span><br></pre></td></tr></table></figure>
<h3 id="vc-7"><a class="markdownIt-Anchor" href="#vc-7">#</a> VC 7</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">6A 70              push 70</span><br><span class="line">68 50110001        push hh.01001150</span><br><span class="line">E8 1D020000        call hh.010017B0</span><br><span class="line">33DB               xor ebx,ebx</span><br></pre></td></tr></table></figure>
<h2 id="vs-2008-vs2013"><a class="markdownIt-Anchor" href="#vs-2008-vs2013">#</a> VS 2008 &amp; VS2013</h2>
<ul>
<li>VS 版本的不同会导致编写出的程序特征（链接器、入口点、区段）</li>
<li>debug 下编译的程序区段的数量相对于 Release 多一些</li>
<li>release 的入口存在 call ??? jmp ???，debug 可能是两个 call</li>
</ul>
<table>
<thead>
<tr>
<th>VS 版本</th>
<th>链接器版本</th>
</tr>
</thead>
<tbody>
<tr>
<td>VC 6.0</td>
<td>6.0</td>
</tr>
<tr>
<td>VC2003</td>
<td>7.0 / 7.1</td>
</tr>
<tr>
<td>VS2005</td>
<td>8.0</td>
</tr>
<tr>
<td>VS2008</td>
<td>9.0</td>
</tr>
<tr>
<td>VS2010</td>
<td>10.0</td>
</tr>
<tr>
<td>VS2012</td>
<td>11.0</td>
</tr>
<tr>
<td>VS2013</td>
<td>12.0</td>
</tr>
<tr>
<td>VS2015</td>
<td>14.0</td>
</tr>
<tr>
<td>VS2017</td>
<td>14.1</td>
</tr>
<tr>
<td>VS2019</td>
<td>14.2</td>
</tr>
</tbody>
</table>
<p>vs2008</p>
<h2 id="img"><a class="markdownIt-Anchor" href="#img">#</a> <img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691322421609-b0e2afb8-7268-4810-928d-f9007bda023a.png" alt="img"></h2>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691322345046-9456598a-725e-4cda-80c9-cb2fd55db728.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691322373598-505b1168-36a2-4b1e-9051-d1e0a3749b78.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691322436721-3e1d88db-fb93-42c0-bf9a-40680ed4e205.png" alt="img"></p>
<p><strong>VS 特点：入口点只有两行代码，一个 CALL 后直接 JMP，第一个 CALL 进去后调用的 API 也是相同的；区段相对于 VC6 多了一个.reloc (重定位表)。</strong></p>
<p>vs2013</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691326508367-03e5f838-e55e-4985-aca4-7e45a6058ea3.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691326395257-a4c9de95-eda8-4045-9353-801efaea18fd.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691326523699-f364a81d-4386-4d7d-87ae-989cd725182f.png" alt="img"></p>
<h2 id=""><a class="markdownIt-Anchor" href="#">#</a> </h2>
<h2 id="易语言"><a class="markdownIt-Anchor" href="#易语言">#</a> 易语言</h2>
<p>分为独立编译和非独立编译</p>
<p>独立编译后被识别别 VC6 (ver 0.0.3.8)</p>
<p>由于易语言独立编译是调用 VC 的链接程序编译的，所以从区段和入口代码特征和 VC 相同</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691326604441-acaba62b-9730-44d7-86b4-c24ccffbdc46.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691326622752-8f273f4d-a260-44a6-8915-c2fb50e4ed71.png" alt="img"></p>
<p>新版 exeinfoPE 识别为 E language/EPL</p>
<p>非独立编译</p>
<p>能识别到下面的 ascii，并且有 krnln.fnr 的字符，程序入口会有很多 jmp</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691327254877-fdb1d47f-50f8-49c4-b547-8f8b9492be34.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691327354167-5e4bea0c-75a6-441e-a887-63872f0b45ac.png" alt="img"></p>
<p>搜索中文区段可以看到特征</p>
<p>push -&gt;call -&gt;jump</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691327119952-534f4cba-e2c9-4743-aa32-8d73bf0ec84c.png" alt="img"></p>
<p>运行之后加载 krmln.fnr</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691327538279-9a8728e5-4faf-4f4b-a90b-1a9dd3d910ec.png" alt="img"></p>
<p>独立编译</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691378010048-65f8bc01-ed74-4436-96e0-00d034da52e5.png" alt="img"></p>
<p>还是会有很多 jmp 调用 api</p>
<p>独立编译 / 非独立编译都被识别为四个区段</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691326794006-2cb32b2d-acbc-40c9-81bd-7801fb22eeaf.png" alt="img"></p>
<p>易语言特点：可以从程序里找一些 call 的调用最终都会走到上面核心代码图位置，这个方法可以区分和 VC 的区别，非独立编译比较容易识别，入口特征和模块特征都有 krnln.fnr。</p>
<h2 id="delhpi"><a class="markdownIt-Anchor" href="#delhpi">#</a> Delhpi</h2>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691327958760-b956d3aa-b448-4028-8cc1-6504c58d259c.png" alt="img"></p>
<p>code + data + bss (未初始化的数据)</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691328056663-4d72358a-ddfc-4bb5-bf1c-df12790764fa.png" alt="img"></p>
<p>OEP：</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692120367597-f3d864ff-8e85-4873-9c31-28431966926a.png" alt="img"></p>
<p><strong>特征：入口点有五个 call，第一个 call 的内部调用了 GetModuleHandleA，最后有一堆 00</strong></p>
<p>第一个 call 内部：</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692120503799-1b8d7135-9a31-48c3-93ea-a0720d806d7d.png" alt="img"></p>
<p>和 BC++ 特征相同，都是使用 FF25 调到函数。</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692120564115-a5542349-b96a-42fb-9f1c-239991b8452f.png" alt="img"></p>
<p>特征码： <code>55 8B EC 83 C4 F0 B8 ?? ?? ?? ?? E8 ?? ?? ?? ??</code></p>
<h2 id="net"><a class="markdownIt-Anchor" href="#net">#</a> .NET</h2>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691328139436-e6a08444-7bdf-4ba0-8bf8-1cad816c95a8.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691328150358-b452e18e-cfb1-4c77-977b-8868bff0f2ad.png" alt="img"></p>
<p>E <span class="exturl" data-url="aHR0cDovL3huLS1maXE1aG42aXN2aWV0aXU2OGUuTkVU">中加载了很多.NET</span> 运行库</p>
<h2 id="asm"><a class="markdownIt-Anchor" href="#asm">#</a> ASM</h2>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691328174126-7d15f970-2e91-45ac-b879-53363a985d10.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691328185713-b527610c-1f16-4da1-aa5c-2f2a45be2692.png" alt="img"></p>
<p><strong>特征：小，入口点直接就是逻辑代码</strong></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692120918358-96244087-1d08-425e-abe2-66f3cf1c72ca.png" alt="img"></p>
<h2 id="bc-60"><a class="markdownIt-Anchor" href="#bc-60">#</a> BC++ 6.0</h2>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691328238593-28c558d2-6489-4d33-afe0-ca2fb1587523.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691328255445-12363e16-002f-4c1a-a2bd-eefd497a118f.png" alt="img"></p>
<p><strong>特征：第一行是一个短跳转，跳过了字符串 fb:C++HOOK，跳转的最后一行是 CPPdebugHook，第一个调用的函数是 GetModuleHandleA</strong></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692119660536-c22032f5-cb53-4ee4-b67a-758bf4a7ee1c.png" alt="img"></p>
<p>BC++ 编写的程序，调用 IAT 函数会使用到 FF25 ?? ?? ?? ??</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692119903432-c2c30611-498f-4e0c-af9d-e47f6442c805.png" alt="img"></p>
<p>PEID 匹配特征码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EB 10 66 62 3A 43 2B 2B 48 4F 4F 4B 90</span><br></pre></td></tr></table></figure>
<h2 id="vb"><a class="markdownIt-Anchor" href="#vb">#</a> VB</h2>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692121839157-e6c403dd-235c-4f9f-ab06-a32160a98f2b.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692121852275-81446f4a-4c0a-4fd4-8119-d3679e562e2c.png" alt="img"></p>
<p>特征：push - call - 一堆 00</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692121772590-e0d3b355-9ff9-4352-92ca-7c50d6258be4.png" alt="img"></p>
<h2 id="各种软件优缺点"><a class="markdownIt-Anchor" href="#各种软件优缺点">#</a> 各种软件优缺点</h2>
<p>1、通过 [PEiD](<span class="exturl" data-url="aHR0cDovL2Rvd24uNTJwb2ppZS5jbi9Ub29scy9QRXRvb2xzL1BFaUQ=">http://down.52pojie.cn/Tools/PEtools/PEiD</span> 0.95.rar)、<span class="exturl" data-url="aHR0cDovL2Rvd24uNTJwb2ppZS5jbi9Ub29scy9QRXRvb2xzL0V4ZWluZm9QRS56aXA=">Exeinfo PE</span> 等<span class="exturl" data-url="aHR0cDovL3d3dy41MnBvamllLmNuL2ZvcnVtLnBocD9tb2Q9Zm9ydW1kaXNwbGF5JmFtcDtmaWQ9NCZhbXA7ZmlsdGVyPXR5cGVpZCZhbXA7dHlwZWlkPTEyNA==">查壳工具</span>内置各种壳的十六进制特征码进行对比查壳，说下优缺点吧。</p>
<p>PEiD、FFI、FastScanner、RDG Packer Detector 这类程序都是通过目录下的 userdb.txt（查壳程序不同可能数据库名有出入）数据库进行加壳程序特征对比的，由于 userdb.txt 文件都是好多年前的了，全球基本都在用 fly 在 09 年发布的<span class="exturl" data-url="aHR0cDovL3d3dy41MnBvamllLmNuL3RocmVhZC0zMTQ1OC0xLTEuaHRtbA=="> UpKPEiDSign</span>，即使有新的也都基于他制作的版本之上进行更新的，而且更新都没有太好效果，由于原理都是通过加壳程序的特征进行对应，而这些加壳特征都是个人总结而来，对加壳程序的模糊搜索对比造成可靠性不高，特别是对于 VMProtect 这类加密壳程序，经常被识别成一些算七八糟都没见过的加壳内容，特别是显示 UPolyX，基本都是误报，对新手的误导很严重，但对于传统的一些压缩壳的识别效果还是很好的，当然了，有利有弊，正是由于它的开放性特征库，也方便给大家提供自己编写特征的方法，来识别一些新的壳，期待大家能做出自己的加壳特征来。</p>
<p>\2. Exeinfo PE 属于新一代查壳工具，作者目前还在更新，它和 PEiD 的区别可能就在于它的特征库是作者自己维护，不支持外部修改，新版好像也开始支持外部特征库了，这款查壳工具的加壳特征库比较准确而且范围很广，如 Themida、WinLicense、VMProtect、ZProtect、Shielden 都可以轻松识别出来，但对于具体加壳程序的版本都是模糊的，其实个人认为加壳版本真的不重要，这个后面再具体说道，<span class="exturl" data-url="aHR0cDovL3d3dy41MnBvamllLmNuL3RocmVhZC0xNjk3NzktMS0xLmh0bWw=">Exeinfo PE</span> 可以说是目前可以说最好的查壳工具了，推荐大家使用。</p>
<p><strong>入口特征</strong>可以通过<span class="exturl" data-url="aHR0cDovL3d3dy41MnBvamllLmNuL3RocmVhZC0xNDk4Ni0xLTEuaHRtbA=="> OllyDBG</span> 载入获得，载入后可以按一下 “Ctrl+A”，让 OD 分析一下代码，就可以把入口点一些特征字符串分析出来，从下图的入口信息可以轻松看出，这是一款 Safengine 加壳的程序，对于 Shielden、Safengine、VProtect 这类加壳程序都可以使用这种方法判断出来。</p>
<p>windows 程序状态大体可以分为以下几种类型：未加壳、压缩壳、传统加密壳、代码虚拟化保护、.Net 程序加密</p>
<p>加壳的目的：为了隐藏程序真正的 OEP（入口点），防止被破解。</p>
<p>1、查壳：用于分析软件有没有加壳，加壳是所使用的哪种壳。常用工具（PEID、Ollydbg、）。详细操作过程可参看《<span class="exturl" data-url="aHR0cHM6Ly9saW5rLnpoaWh1LmNvbS8/dGFyZ2V0PWh0dHBzJTNBLy9tYXguYm9vazExOC5jb20vaHRtbC8yMDIwLzA4MTgvNzA0NTA2NTAzNjAwMjE2MS5zaHRt">破解基础 - 你到底有没有</span>》。</p>
<p>2、寻找 OEP：OEP 是程序加壳前真正的入口点，外壳初始化的现场环境（各寄存器值）和原程序的现场环境是相同的，加壳程序初始化时保存各寄存器的值，外壳执行完毕，会恢复各寄存器内容。</p>
<p>3、抓取内存映像文件（Dump）：完成外壳程序解压还原后，在内存中找到运行的目标 PE 进程数据，从内存中抓取出来，然后在用文件的形式保存下来。保存下来的文件可能不能正常运行，有可能是壳对 IAT 进行了加密。</p>
<p><strong>抓取内存映像文件</strong>详细介绍可参考：<span class="exturl" data-url="aHR0cHM6Ly9saW5rLnpoaWh1LmNvbS8/dGFyZ2V0PWh0dHBzJTNBLy9iYnMua2FueHVlLmNvbS90aHJlYWQtMTc2MjQuaHRt">浅谈脱壳中的 Dump 技术</span></p>
<p>4、输入表重建（修改 IAT）：一些加密壳为了防止输入表被还原，会在 IAT 里填充一些扰乱解析的地址（例如：壳中用来 HOOK-API 的外壳代码地址），为了获得没有加密的 IAT，一般可跟踪加壳程序对 IAT 处理过程，修改相关指令，阻止外壳加密 IAT。</p>
<p><strong>输入表重建</strong>详细介绍可参考文件：<span class="exturl" data-url="aHR0cHM6Ly9saW5rLnpoaWh1LmNvbS8/dGFyZ2V0PWh0dHBzJTNBLy93ZW5rdS5iYWlkdS5jb20vdmlldy9jNzI2ODk1MWFiMTE0NDMxYjkwZDZjODVlYzNhODdjMjQwMjg4YTI3Lmh0bWwlM0Zfd2t0c18lM0QxNjczMzQwMTMzMDA4JTI2YmRRdWVyeSUzRCVFOCVCRSU5MyVFNSU4NSVBNSVFOCVBMSVBOCVFOSU4NyU4RCVFNSVCQiVCQQ==">重建输入表 - 百度文库</span></p>
<p>压缩 ==》 减小程序体积【ASPacK、UPX、PECompack 等】 保护程序 ==》 用了各种反跟踪技术保护程序不被调试、脱壳等【ASProtect、Armadillo、EXECryptor 等】</p>
<h2 id="upx"><a class="markdownIt-Anchor" href="#upx">#</a> upx</h2>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691385586468-62427d40-d9af-4e05-838b-d09d41462873.png" alt="img"></p>
<h3 id="单步跟踪"><a class="markdownIt-Anchor" href="#单步跟踪">#</a> 单步跟踪</h3>
<p>1. 找到 OEP</p>
<p>不能向上跳转，向下跳如果下一行还是跳转 (jmp,call) 就再隔一行。只需要看红线跳转</p>
<p>直到看到大跨度跳转，就是跳往 OEP</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691387531273-60a1114c-8a83-4fed-b794-dcff2c48e50a.png" alt="img"></p>
<p>jmp     0047738C</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691667435596-eb04c9d4-6112-4712-9cc2-b8ca0f9768ce.png" alt="img"></p>
<p>2. 脱壳</p>
<p>可以使用 OD 或者 loadpe</p>
<p>OD 有两种方式：方式 1 和方式二。使用 ollydump</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691667679217-88fc1fbc-ef58-4f5e-80ef-7204a3000298.png" alt="img"></p>
<p>loadpe</p>
<p>修正镜像大小 -&gt; 完整转存</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691667878094-12996432-2a8e-4e1a-ac54-0a714785ae05.png" alt="img"></p>
<p>输入表重建，修复转存文件</p>
<h3 id="esp"><a class="markdownIt-Anchor" href="#esp">#</a> ESP</h3>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691668738533-b13f4d99-ad13-4056-895c-30641f90d4cf.png" alt="img"></p>
<p>dd esp 或者在数据窗口中跟随 esp</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691668783221-7711206f-c165-44da-a169-0c1aec5d00dc.png" alt="img"></p>
<p>在数据窗口中下硬件访问断点，word</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691668830671-17fbeca6-cd59-4538-aabf-124e897d49fd.png" alt="img"></p>
<p>跳转到 oep</p>
<p>删除硬件断点</p>
<h3 id="二次内存镜像"><a class="markdownIt-Anchor" href="#二次内存镜像">#</a> 二次内存镜像</h3>
<p>先解压 rsrc 以前的所有内容，在对上面的内容下段</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691669028805-2d8fa529-5912-4d89-92c8-054f7cbb1058.png" alt="img"></p>
<p>先对 rsrc 下 F2，在对 upx0 下 F2</p>
<h3 id="查找"><a class="markdownIt-Anchor" href="#查找">#</a> 查找</h3>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691669186095-f95dcfbc-5020-4e64-8a8c-4d6a039a797a.png" alt="img"></p>
<p>直接找 popad，适用于大部分 upx 和 asp</p>
<h2 id="asp"><a class="markdownIt-Anchor" href="#asp">#</a> ASP</h2>
<h3 id="1单步跟踪"><a class="markdownIt-Anchor" href="#1单步跟踪">#</a> 1. 单步跟踪</h3>
<p>和脱 upx 一样。但是如果碰到 call 程序直接执行，需要 F7 跟进去，一直到 popad，ret 之后就是 oep 了</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691670968741-912d0e76-a1b2-4327-9aaf-a240c7019d14.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691671000567-67ab5952-286b-4d7b-93a5-e753c462e643.png" alt="img"></p>
<p>使用 ollydump 脱壳</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691671093327-f4641010-d421-435b-a534-d8cec1148217.png" alt="img"></p>
<h3 id="2esp"><a class="markdownIt-Anchor" href="#2esp">#</a> 2.ESP</h3>
<p>和 upx 一样，下硬件访问断点，断下之后，下面的 retn 就是跳转到 oep</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691671254675-772670a5-dab3-4183-9d08-f3eb17945a6e.png" alt="img"></p>
<h3 id="查找popad"><a class="markdownIt-Anchor" href="#查找popad">#</a> 查找 popad</h3>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691671469100-08d9b7d4-2827-409f-8d27-5c420b9854ce.png" alt="img"></p>
<p>如果有多个 popad，ctrl+L 查找下一个</p>
<h3 id="内存镜像"><a class="markdownIt-Anchor" href="#内存镜像">#</a> 内存镜像</h3>
<p>memory 中 rsrc 下一次断，401000 第二次下段</p>
<p>然后单步法</p>
<h3 id="模拟跟踪"><a class="markdownIt-Anchor" href="#模拟跟踪">#</a> 模拟跟踪</h3>
<p>tc eip &lt; .aspack 地址</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691671906465-475463b2-ff0d-4097-9a4b-bde083a051d4.png" alt="img"></p>
<h3 id="sfx"><a class="markdownIt-Anchor" href="#sfx">#</a> SFX</h3>
<p>选项中</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691671977857-06da110e-50fa-4021-b1e4-9cfa024041c4.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691672022771-269530e3-a7dc-45b3-81e3-b810672bdae1.png" alt="img"></p>
<h2 id="nsp"><a class="markdownIt-Anchor" href="#nsp">#</a> NSP</h2>
<h3 id="esp-2"><a class="markdownIt-Anchor" href="#esp-2">#</a> ESP</h3>
<p>1. 找到 oep</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691673821252-eaa85974-c355-4364-899c-f131d364ffba.png" alt="img"></p>
<p>2. 在 loadpe 中修正镜像大小，完整转存</p>
<p>3. 修复</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691673988015-79fa7bb4-10d8-41f1-ab47-e4f0daa08b09.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691674407759-dc8236f9-423c-44c6-9064-039398685ce9.png" alt="img"></p>
<h3 id="单步跟踪-2"><a class="markdownIt-Anchor" href="#单步跟踪-2">#</a> 单步跟踪</h3>
<p>和前两个方法一样</p>
<h3 id="模拟跟踪-2"><a class="markdownIt-Anchor" href="#模拟跟踪-2">#</a> 模拟跟踪</h3>
<p>tc eip&lt;nsp1 地址</p>
<h3 id="两次内存镜像"><a class="markdownIt-Anchor" href="#两次内存镜像">#</a> 两次内存镜像</h3>
<p>nsp0 下段，在单步</p>
<h3 id="特殊方法"><a class="markdownIt-Anchor" href="#特殊方法">#</a> 特殊方法</h3>
<p>at GetVersion</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691675154937-0929ff53-e897-45dd-bc1f-849d4deed05d.png" alt="img"></p>
<p>在 retn 出下段，执行到该行，在执行一次到 oep 之后</p>
<p>适用于北斗 3 前版本</p>
<h2 id="fsg"><a class="markdownIt-Anchor" href="#fsg">#</a> FSG</h2>
<h3 id="修复"><a class="markdownIt-Anchor" href="#修复">#</a> 修复</h3>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691861585317-d76f11b3-f597-4701-91b2-7a81da749f27.png" alt="img"></p>
<p>首先通过单步法找到连续的 jmp，最下面一个 jmp 就会 jmp 到 oep 的位置</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691861657612-28663ace-e5b3-425a-b59e-216d5099e587.png" alt="img"></p>
<p>进行转存并修复</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691861842793-74f4f642-3eae-4f96-be69-a910f0f9ce73.png" alt="img"></p>
<p>手动查找 IAT。使用任意函数找到 IAT</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691861934827-f263a896-da86-48aa-9242-18aed9601344.png" alt="img"></p>
<p>425000 开始是 iat</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691861971931-c8777287-10d2-4dec-91bd-7ff47f2b3a39.png" alt="img"></p>
<p>425284 是结束</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691862029875-752894bc-8ba6-465e-b5fc-ab6c644e1808.png" alt="img"></p>
<p>25000-25284。更改 rva，大小不想算可以直接写 1000</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691862078420-0d84c8e3-2075-45fe-b552-68d3bb0a4235.png" alt="img"></p>
<p>获取导入表，显示无效的，剪切指针，修正转存，即可修复 IAT</p>
<h3 id="esp-3"><a class="markdownIt-Anchor" href="#esp-3">#</a> esp</h3>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691862243093-5efb349c-75ca-419a-9ea5-738825b4231f.png" alt="img"></p>
<p>运行到 push 之后使用 esp</p>
<h3 id="特殊esp"><a class="markdownIt-Anchor" href="#特殊esp">#</a> 特殊 esp</h3>
<p>运行扫 push 上一行后，堆栈中第四行即为 OEP</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691862457958-cabe7346-d603-436b-995a-630afd5e34dc.png" alt="img"></p>
<p>反汇编窗口中跟随，下硬件断点，shitf+f9, 即可调到 oep</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691862563448-48abf9c2-ffbd-47f1-a05f-a171d9cecf73.png" alt="img"></p>
<h2 id="pe-compact-2x"><a class="markdownIt-Anchor" href="#pe-compact-2x">#</a> PE compact 2.x</h2>
<h3 id="单步"><a class="markdownIt-Anchor" href="#单步">#</a> 单步</h3>
<p>有会执行的 call 就跟进去，直到这个 jmp 调到 oep</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691863143297-44552944-29d5-42bf-bacb-8fe79baa5638.png" alt="img"></p>
<h3 id="esp-4"><a class="markdownIt-Anchor" href="#esp-4">#</a> esp</h3>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691863455880-33a85a54-b6ce-4bd0-82c8-7ef0a402dcc8.png" alt="img"></p>
<h3 id="-2"><a class="markdownIt-Anchor" href="#-2">#</a> ？</h3>
<p>BP VirtualFree</p>
<p>shitf + f9</p>
<p>取消断点</p>
<p>alt + F9 执行到用户代码</p>
<p>查找 push 8000</p>
<p>单步</p>
<h3 id="-3"><a class="markdownIt-Anchor" href="#-3">#</a> ？？</h3>
<p>BP VirtualFree</p>
<p>shift + f9</p>
<p>shift + f9</p>
<p>取消断点</p>
<p>alt + f9</p>
<h3 id="-4"><a class="markdownIt-Anchor" href="#-4">#</a> ？？？</h3>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691864286547-c7596ed3-808f-4fb2-b52c-53a9b5f473ae.png" alt="img"></p>
<p>BP 0045DE74</p>
<p>shift + f9</p>
<p>断点下到执行到 retn 下面一行，shift + f9</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691864344953-9ec42d09-2787-4c27-bcaa-72d3ffca92a4.png" alt="img"></p>
<p>单步</p>
<h3 id="-5"><a class="markdownIt-Anchor" href="#-5">#</a> ？？？？</h3>
<p>BP VirtualFree</p>
<p>shift + f9</p>
<p>取消断点</p>
<p>alt + F9</p>
<p>找到下一个 jmp，单步</p>
<h3 id="异常"><a class="markdownIt-Anchor" href="#异常">#</a> 异常</h3>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691866556739-8c91a555-07c3-4752-91ee-9a992c4db17c.png" alt="img"></p>
<p>重新运行程序，多次 shift + f9 直到程序运行</p>
<p>那么在程序运行前的一次 shift + f9，在堆栈窗口中找 se 句柄，在反汇编窗口中跟随</p>
<p>找到 retn 下一行，运行到，单步</p>
<h3 id="两次内存"><a class="markdownIt-Anchor" href="#两次内存">#</a> 两次内存</h3>
<p>rsrc 第一次下段</p>
<p>text 第二次下段</p>
<p>执行到 retn 下一行，单步</p>
<h3 id="at-getversion"><a class="markdownIt-Anchor" href="#at-getversion">#</a> at getversion</h3>
<p>at GetVersion 之后</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691867602913-91b2bc41-2862-448e-92ef-3ec0190cf46f.png" alt="img"></p>
<p>运行到 retn，F8，即可到达程序。向上翻就是 oep</p>
<h2 id="ezip"><a class="markdownIt-Anchor" href="#ezip">#</a> ezip</h2>
<h3 id="单步-2"><a class="markdownIt-Anchor" href="#单步-2">#</a> 单步</h3>
<p>不要管开局那堆 jmp</p>
<p>如果修复完不能运行，使用重建 pe</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691868544162-5d3531fe-b3a6-4543-b97b-be346cc4f260.png" alt="img"></p>
<h3 id="esp-5"><a class="markdownIt-Anchor" href="#esp-5">#</a> esp</h3>
<p>运行到这一行使用 esp 法</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691868340564-083060be-e469-4a02-9343-0e6d7c583cdd.png" alt="img"></p>
<h2 id="telock-098b1"><a class="markdownIt-Anchor" href="#telock-098b1">#</a> telock 0.98b1</h2>
<h3 id="最后一次异常"><a class="markdownIt-Anchor" href="#最后一次异常">#</a> 最后一次异常</h3>
<p>第 n-1 次异常，转到 se</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691868852795-6b31d1c3-d9b3-45b8-aeab-b65ef8398a46.png" alt="img"></p>
<p>下段，shift + f9，单步</p>
<p>找到大跳转</p>
<p>记下 oep</p>
<p>使用带壳程序进 irce 原版，查找无效的，L3 修复，修不了的就剪切，修复转存完整镜像的</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691869603904-b9c0ca8e-ff58-4302-9d7e-136b409ef71c.png" alt="img"></p>
<h3 id="模拟跟踪-3"><a class="markdownIt-Anchor" href="#模拟跟踪-3">#</a> 模拟跟踪</h3>
<p>第 n-1 次异常，转到 se</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691868852795-6b31d1c3-d9b3-45b8-aeab-b65ef8398a46.png" alt="img"></p>
<p>下段，shift + f9</p>
<p>tc eip &lt; 42c000</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691870439605-041576ba-52e2-4e8f-9d4f-832e4fc3f6c2.png" alt="img"></p>
<h3 id="两次内存-2"><a class="markdownIt-Anchor" href="#两次内存-2">#</a> 两次内存</h3>
<p>rsrc</p>
<p>text</p>
<h2 id="exe32"><a class="markdownIt-Anchor" href="#exe32">#</a> exe32</h2>
<h3 id="esp-6"><a class="markdownIt-Anchor" href="#esp-6">#</a> esp</h3>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691878970795-f3d276be-a86e-4d0e-b891-82b9d4dc6214.png" alt="img"></p>
<h3 id="isdeubggerpresent"><a class="markdownIt-Anchor" href="#isdeubggerpresent">#</a> IsDeubggerPresent</h3>
<p>BP IsDebuggerPresent</p>
<p>shift + F9</p>
<p>取消断点</p>
<p>alt+f9</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691879268149-b98b5700-b325-430a-81f6-135dae6d9117.png" alt="img"></p>
<p>两个 edi 相加的值就是 oep</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691879480404-346a3e10-5764-4ecb-9da6-9d62b218660e.png" alt="img"></p>
<h2 id="win"><a class="markdownIt-Anchor" href="#win">#</a> win</h2>
<h3 id="条件断点"><a class="markdownIt-Anchor" href="#条件断点">#</a> 条件断点</h3>
<p>单步到 je 0040A41E 下条件断点 eax == 0</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691880040944-b500cca5-fc10-4c5c-8d17-506c443e2ca5.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691880087946-d5e20e9b-a8eb-4af0-bd65-33617b1e7b93.png" alt="img"></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cueWlpNjY2LmNvbS9ibG9nLzM1MjY5NS5odG1s">https://www.yii666.com/blog/352695.html</span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vejVvbmswL3AvMTcyODcyMTUuaHRtbA==">https://www.cnblogs.com/z5onk0/p/17287215.html</span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC81OTc4OTM1NjA/dXRtX2lkPTA=">https://zhuanlan.zhihu.com/p/597893560?utm_id=0</span></p>
<h2 id="附加数据处理方法"><a class="markdownIt-Anchor" href="#附加数据处理方法">#</a> 附加数据处理方法</h2>
<p>显示 overlay 标识带有附加数据</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691924425544-ec6a3063-5c1f-410a-bcd3-4255a4c26a35.png" alt="img"></p>
<p>先脱壳，脱壳玩之后已经不能打开，接着找附加数据，打开源程序 8c00 之后的附加数据，一直复制到最后</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691925453725-4ed26015-e893-427f-9b33-46f487477eb5.png" alt="img"></p>
<p>在脱壳后的程序最后粘贴即可</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691925533815-16ac5d38-d33e-4d40-b240-138cfbf97ec1.png" alt="img"></p>
<p>建议使用 hex workshop</p>
<p>计算开始位置</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691925671678-2d48ab76-0c94-4ea0-83db-b0648cdcc33f.png" alt="img"></p>
<p>最后一个区段的大小的偏移 8800+400</p>
<p>或者使用 overlay 最终版</p>
<h2 id="去除自校验"><a class="markdownIt-Anchor" href="#去除自校验">#</a> 去除自校验</h2>
<p>程序脱壳后，和源程序对比，找到和源程序不一样的地方</p>
<p>两个程序都用 od 打开，下 bp CreateFileA</p>
<p>运行；</p>
<p>alt  + f9</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691926606396-7d1da3e2-1dbc-475c-99aa-0a4fdefc9441.png" alt="img"></p>
<p>逐行对比找到不一样的地方</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691926716723-983f556a-39ea-4281-8997-f06a42d46f48.png" alt="img"></p>
<p>脱壳后的跳转实现了，把脱壳后改成和原来改成一样的，保存</p>
<p>即可正常执行</p>
<h2 id="脱壳简单应用-汉化-diy"><a class="markdownIt-Anchor" href="#脱壳简单应用-汉化-diy">#</a> 脱壳简单应用 - 汉化 - diy</h2>
<p>vb 类软件用 getvbresource</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691928245980-1700974a-9416-4618-8fe1-c0c668bc0c90.png" alt="img"></p>
<p>c 类汉化用 reource hacker peexploer  xnresoure</p>
<p>如果不能显示说明脱壳没脱干净，需要 fix</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691928890548-35298b06-d833-4446-bfe0-ffb91fd68d93.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1691929350128-73ce7aaa-e998-4eb9-8632-d86d6f75b5cc.png" alt="img"></p>
<p>C++ 类</p>
<p>XNRreoute</p>
<h2 id="asp变形壳"><a class="markdownIt-Anchor" href="#asp变形壳">#</a> ASP 变形壳</h2>
<h3 id="单步-3"><a class="markdownIt-Anchor" href="#单步-3">#</a> 单步</h3>
<p>近 call F7 远 call F8</p>
<h3 id="脱asp变形壳01汉化版"><a class="markdownIt-Anchor" href="#脱asp变形壳01汉化版">#</a> 脱 ASP 变形壳 0.1 汉化版</h3>
<p>跟进第一个 jmp</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692024568863-1ea26d19-dd11-44a6-a0e6-0d37675b74b8.png" alt="img"></p>
<p>单步之后进入循环，统计多少次跳转之后会执行。注意下段</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692024633380-e5f2afa6-079a-4c05-8dd3-72a39ae0c316.png" alt="img"></p>
<p>58 次之后程序运行，指定到第 57 次</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692024780522-034c1f1b-f71f-4afe-bf5c-f97a393bf91f.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692024788064-932295cf-056d-4083-96a5-d74e8a8ec2a9.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692024842821-ab44a69b-2877-4cea-9c2f-0073457474a7.png" alt="img"></p>
<p>OEP</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692025386556-4dc068cc-f9e9-4833-9325-84aad1f47193.png" alt="img"></p>
<h2 id="脚本脱壳"><a class="markdownIt-Anchor" href="#脚本脱壳">#</a> 脚本脱壳</h2>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692026215720-82d7ae9f-47f4-4493-85c0-7072eb5db6b3.png" alt="img"></p>
<h2 id="acprotect"><a class="markdownIt-Anchor" href="#acprotect">#</a> ACProtect</h2>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692108232130-158286a0-16fa-428c-83c0-0550a8d37ed9.png" alt="img"></p>
<p>1。设置异常，隐藏 OD</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692107644450-d408a891-ef22-474e-983b-bae475e5ebe3.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692107684009-ae657984-4674-4ef0-be91-f6883c2532bf.png" alt="img"></p>
<p>shift + f9 到程序运行前的最后一次异常， 即 int</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692107760801-297313d1-5c6d-4877-ac12-5946ea90073f.png" alt="img"></p>
<p>2。SE 处下内存访问断点</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692107804905-da35a8f7-0f15-4272-b957-e79be099f6e2.png" alt="img"></p>
<p>3。SHIFT+F9，F2，再一次 SHIFT+F9，下断，再一次 SHIFT+F9。运行到下面</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692107859074-ecdf5d2b-da8f-430a-93f6-295e55dd6f13.png" alt="img"></p>
<p>4，取消所有断点</p>
<p>总共删除三个断点，两个 F2 一个内存访问</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692107899106-3a24607f-69d2-4a80-8510-4a0d18478794.png" alt="img"></p>
<p>5，内存，00401000。F2，SHIFT+F9</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692107941811-a6754180-3a2c-4bdb-99f5-0d99e89d596a.png" alt="img"></p>
<p>6，直达 OEP！！</p>
<p>7。修复，脱壳成功</p>
<h2 id="acprotect-stolen"><a class="markdownIt-Anchor" href="#acprotect-stolen">#</a> ACProtect （stolen）</h2>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692108271689-4d4df3f5-87e7-4e34-ac10-6306f81d3d79.png" alt="img"></p>
<p>和正常的 acprotect 一样，但是在第四步到 retn 之后需要找被偷的代码</p>
<p>编辑条件，c++ 入口特征为 push ebp</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692109620700-299d1bdb-5345-4989-bbd3-2ac5d120380d.png" alt="img"></p>
<p>ctrl + f11 跟踪进入 ，到被偷的代码，一共被偷了 6 个字节</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692110362910-022b0895-0c3d-4885-95e1-6fdba364668e.png" alt="img"></p>
<p>004254C9    55              push ebp</p>
<p>004254CA    8BEC            mov ebp,esp</p>
<p>004254CC    83EC 44         sub esp,44</p>
<p>重新到 oep，修复</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692110443317-1034e62d-6d64-46d5-b343-298a24134b3d.png" alt="img"></p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692110580998-48ac7587-e42c-4d8b-bac6-ca8abfb603bf.png" alt="img"></p>
<p>指定 10cc 为新的 eip</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692110653226-b5e7798b-8a3a-4b9c-ab3a-dd0acc0ef387.png" alt="img"></p>
<p>脱壳，不要选择重建输入表</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692110682961-079724ad-fe8f-445d-9f23-a9136ae454b7.png" alt="img"></p>
<p>修复：使用源程序修复，不要使用脱壳后的修复</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692110769727-ea6f6998-cc19-40ce-af52-e1b647afd710.png" alt="img"></p>
<p>修复完修正转存即可</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692112393653-beaf6d74-50bc-440a-9351-7b0db076591f.png" alt="img"></p>
<h2 id="寻找修饰的stolen-code"><a class="markdownIt-Anchor" href="#寻找修饰的stolen-code">#</a> 寻找修饰的 stolen code</h2>
<p>1。设置异常（忽略除 INT3 中断的所有异常），隐藏 OD</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692113944459-39308dc6-0ea1-44c8-bd27-7f63ae1709b9.png" alt="img"></p>
<p>2。来到入口点，F9 运行</p>
<p>004AC000 &gt;  60              pushad   // 记住这个</p>
<p>004AC001    4E              dec esi</p>
<p>004AC002    D3D6            rcl esi,cl</p>
<p>004AC004    4E              dec esi</p>
<p>004AC005    66:D3E8         shr ax,cl</p>
<p>004AC008    4E              dec esi</p>
<p>004AC009    8BC3            mov eax,ebx</p>
<p>004AC00B    48              dec eax</p>
<p>3。程序中断在这里</p>
<p>004BAB23    90              nop   // 这其实也是最后一次异常</p>
<p>004BAB24    64:67:8F06 0000 pop dword ptr fs:[0]</p>
<p>004BAB2A    83C4 04         add esp,4</p>
<p>004BAB2D    60              pushad</p>
<p>004BAB2E    E8 00000000     call NetClean.004BAB33</p>
<p>004BAB33    5E              pop esi</p>
<p>004BAB34    83EE 06         sub esi,6</p>
<p>004BAB37    B9 5B000000     mov ecx,5B</p>
<p>004BAB3C    29CE            sub esi,ecx</p>
<p>004BAB3E    BA 09E5B87E     mov edx,7EB8E509</p>
<p>004BAB43    C1E9 02         shr ecx,2</p>
<p>004BAB46    83E9 02         sub ecx,2</p>
<p>004BAB49    83F9 00         cmp ecx,0</p>
<p>004BAB4C    7C 1A           jl short NetClean.004BAB68</p>
<p>004BAB4E    8B048E          mov eax,dword ptr ds:[esi+ecx*4]</p>
<p>4。看堆栈，找 SE 句柄，数据窗口跟随，下硬件访问断点，shift+F9</p>
<p>5. 下断，再次 SHIFT+F9，下断，再次 SHIFT+F9，取消所有断点，直接 F4 到 RETN 处</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692114031627-1dc82b15-3345-4fab-9396-7441a0b1071b.png" alt="img"></p>
<p>6。下 d 12ffc0，下硬件断点。SHIFT+F9。</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692114198022-0f762ddc-17a1-402e-9e15-703f7a651ec8.png" alt="img"></p>
<p>7。记下 Stolen Code 。</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692114209739-604019cd-fc68-4d58-9b8a-0d6ec61091fc.png" alt="img"></p>
<p>004C9B31    55              push ebp</p>
<p>004C9B32    8BEC            mov ebp,esp</p>
<p>004C9B34    6A FF           push -1</p>
<p>8。找到内存，在 00401000 处下断，F2，SHIFT+F9。</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692114249236-07b93aab-e2d1-4f6f-ab18-ad9498fe05bb.png" alt="img"></p>
<p>004431F9    68 D8B24400     push NetClean.0044B2D8                 // 这里其实是假的 OEP！！</p>
<p>004431FE    68 B4334400     push NetClean.004433B4                    ; jmp 到</p>
<p>00443203    64:A1 00000000  mov eax,dword ptr fs:[0]</p>
<p>00443209    50              push eax</p>
<p>0044320A    64:8925 0000000&gt;mov dword ptr fs:[0],esp</p>
<p>00443211    83EC 68         sub esp,68</p>
<p>00443214    53              push ebx</p>
<p>9。写入真实的代码！！</p>
<p>注意先分析，在按字节滚动，不然代码会乱</p>
<p>ctrl + 方向键</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692114364239-2878caa4-6364-4254-b930-ef01245ce492.png" alt="img"></p>
<p>10。OD 插件脱壳，注意，修正 OEP 地址！！</p>
<p>11。IR 修复，用等级 3。不能修复的 CUT 掉。抓取修复。程序还是抱错！</p>
<p>12。用 OD 打开 11 步修复过得程序，做下处理。来到壳的入口。也就是第一步记下的地址</p>
<p>CTRL+G，004AC000</p>
<p>13，写入真的 OEP 代码。保存</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692114662976-fd5427e2-cb5d-4c90-a787-75375eef0e4c.png" alt="img"></p>
<p>14。Lord PE 修正入口点</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692115256052-b295219d-ff09-4f2e-a3c4-2b0099724f68.png" alt="img"></p>
<p>15。保存，脱壳成功！</p>

  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2023-08-16 01:59:17" itemprop="dateModified" datetime="2023-08-16T01:59:17+08:00">2023-08-16</time>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> Donate</button>
  <p>Give me a cup of [coffee]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="John Doe WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="John Doe Alipay">
        <p>Alipay</p>
      </div>
      
      <div>
        <img data-src="/images/paypal.png" alt="John Doe PayPal">
        <p>PayPal</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>Post author:  </strong>John Doe <i class="ic i-at"><em>@</em></i>Hexo
  </li>
  <li class="link">
    <strong>Post link: </strong>
    <a href="http://example.com/yuque/%E7%A0%B4%E8%A7%A3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B9%8B%E8%AE%A4%E8%AF%86%E5%A3%B3%E4%B8%8E%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%89%B9%E5%BE%81.html" title="破解基础知识之认识壳与程序的特征">http://example.com/yuque/破解基础知识之认识壳与程序的特征.html</a>
  </li>
  <li class="license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A0%B4%E8%A7%A3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B9%8B%E8%AE%A4%E8%AF%86%E5%A3%B3%E4%B8%8E%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%89%B9%E5%BE%81"><span class="toc-number">1.</span> <span class="toc-text"> 破解基础知识之认识壳与程序的特征</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#vc60"><span class="toc-number">1.1.</span> <span class="toc-text"> vc6.0</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#vc"><span class="toc-number">1.1.1.</span> <span class="toc-text"> VC++</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vc-7"><span class="toc-number">1.1.2.</span> <span class="toc-text"> VC 7</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vs-2008-vs2013"><span class="toc-number">1.2.</span> <span class="toc-text"> VS 2008 &amp; VS2013</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#img"><span class="toc-number">1.3.</span> <span class="toc-text"> </span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.4.</span> <span class="toc-text"> </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%98%93%E8%AF%AD%E8%A8%80"><span class="toc-number">1.5.</span> <span class="toc-text"> 易语言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#delhpi"><span class="toc-number">1.6.</span> <span class="toc-text"> Delhpi</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#net"><span class="toc-number">1.7.</span> <span class="toc-text"> .NET</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#asm"><span class="toc-number">1.8.</span> <span class="toc-text"> ASM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bc-60"><span class="toc-number">1.9.</span> <span class="toc-text"> BC++ 6.0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vb"><span class="toc-number">1.10.</span> <span class="toc-text"> VB</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%84%E7%A7%8D%E8%BD%AF%E4%BB%B6%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.11.</span> <span class="toc-text"> 各种软件优缺点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#upx"><span class="toc-number">1.12.</span> <span class="toc-text"> upx</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%AD%A5%E8%B7%9F%E8%B8%AA"><span class="toc-number">1.12.1.</span> <span class="toc-text"> 单步跟踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#esp"><span class="toc-number">1.12.2.</span> <span class="toc-text"> ESP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E6%AC%A1%E5%86%85%E5%AD%98%E9%95%9C%E5%83%8F"><span class="toc-number">1.12.3.</span> <span class="toc-text"> 二次内存镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE"><span class="toc-number">1.12.4.</span> <span class="toc-text"> 查找</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#asp"><span class="toc-number">1.13.</span> <span class="toc-text"> ASP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E5%8D%95%E6%AD%A5%E8%B7%9F%E8%B8%AA"><span class="toc-number">1.13.1.</span> <span class="toc-text"> 1. 单步跟踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2esp"><span class="toc-number">1.13.2.</span> <span class="toc-text"> 2.ESP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E6%89%BEpopad"><span class="toc-number">1.13.3.</span> <span class="toc-text"> 查找 popad</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E9%95%9C%E5%83%8F"><span class="toc-number">1.13.4.</span> <span class="toc-text"> 内存镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E8%B7%9F%E8%B8%AA"><span class="toc-number">1.13.5.</span> <span class="toc-text"> 模拟跟踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sfx"><span class="toc-number">1.13.6.</span> <span class="toc-text"> SFX</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nsp"><span class="toc-number">1.14.</span> <span class="toc-text"> NSP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#esp-2"><span class="toc-number">1.14.1.</span> <span class="toc-text"> ESP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%AD%A5%E8%B7%9F%E8%B8%AA-2"><span class="toc-number">1.14.2.</span> <span class="toc-text"> 单步跟踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E8%B7%9F%E8%B8%AA-2"><span class="toc-number">1.14.3.</span> <span class="toc-text"> 模拟跟踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E6%AC%A1%E5%86%85%E5%AD%98%E9%95%9C%E5%83%8F"><span class="toc-number">1.14.4.</span> <span class="toc-text"> 两次内存镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E6%96%B9%E6%B3%95"><span class="toc-number">1.14.5.</span> <span class="toc-text"> 特殊方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fsg"><span class="toc-number">1.15.</span> <span class="toc-text"> FSG</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E5%A4%8D"><span class="toc-number">1.15.1.</span> <span class="toc-text"> 修复</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#esp-3"><span class="toc-number">1.15.2.</span> <span class="toc-text"> esp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E6%AE%8Aesp"><span class="toc-number">1.15.3.</span> <span class="toc-text"> 特殊 esp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pe-compact-2x"><span class="toc-number">1.16.</span> <span class="toc-text"> PE compact 2.x</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%AD%A5"><span class="toc-number">1.16.1.</span> <span class="toc-text"> 单步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#esp-4"><span class="toc-number">1.16.2.</span> <span class="toc-text"> esp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-2"><span class="toc-number">1.16.3.</span> <span class="toc-text"> ？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-3"><span class="toc-number">1.16.4.</span> <span class="toc-text"> ？？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-4"><span class="toc-number">1.16.5.</span> <span class="toc-text"> ？？？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-5"><span class="toc-number">1.16.6.</span> <span class="toc-text"> ？？？？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8"><span class="toc-number">1.16.7.</span> <span class="toc-text"> 异常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E6%AC%A1%E5%86%85%E5%AD%98"><span class="toc-number">1.16.8.</span> <span class="toc-text"> 两次内存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#at-getversion"><span class="toc-number">1.16.9.</span> <span class="toc-text"> at getversion</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezip"><span class="toc-number">1.17.</span> <span class="toc-text"> ezip</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%AD%A5-2"><span class="toc-number">1.17.1.</span> <span class="toc-text"> 单步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#esp-5"><span class="toc-number">1.17.2.</span> <span class="toc-text"> esp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#telock-098b1"><span class="toc-number">1.18.</span> <span class="toc-text"> telock 0.98b1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%90%8E%E4%B8%80%E6%AC%A1%E5%BC%82%E5%B8%B8"><span class="toc-number">1.18.1.</span> <span class="toc-text"> 最后一次异常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E8%B7%9F%E8%B8%AA-3"><span class="toc-number">1.18.2.</span> <span class="toc-text"> 模拟跟踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E6%AC%A1%E5%86%85%E5%AD%98-2"><span class="toc-number">1.18.3.</span> <span class="toc-text"> 两次内存</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exe32"><span class="toc-number">1.19.</span> <span class="toc-text"> exe32</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#esp-6"><span class="toc-number">1.19.1.</span> <span class="toc-text"> esp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#isdeubggerpresent"><span class="toc-number">1.19.2.</span> <span class="toc-text"> IsDeubggerPresent</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#win"><span class="toc-number">1.20.</span> <span class="toc-text"> win</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%96%AD%E7%82%B9"><span class="toc-number">1.20.1.</span> <span class="toc-text"> 条件断点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%E5%8A%A0%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95"><span class="toc-number">1.21.</span> <span class="toc-text"> 附加数据处理方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%BB%E9%99%A4%E8%87%AA%E6%A0%A1%E9%AA%8C"><span class="toc-number">1.22.</span> <span class="toc-text"> 去除自校验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%84%B1%E5%A3%B3%E7%AE%80%E5%8D%95%E5%BA%94%E7%94%A8-%E6%B1%89%E5%8C%96-diy"><span class="toc-number">1.23.</span> <span class="toc-text"> 脱壳简单应用 - 汉化 - diy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#asp%E5%8F%98%E5%BD%A2%E5%A3%B3"><span class="toc-number">1.24.</span> <span class="toc-text"> ASP 变形壳</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%AD%A5-3"><span class="toc-number">1.24.1.</span> <span class="toc-text"> 单步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%84%B1asp%E5%8F%98%E5%BD%A2%E5%A3%B301%E6%B1%89%E5%8C%96%E7%89%88"><span class="toc-number">1.24.2.</span> <span class="toc-text"> 脱 ASP 变形壳 0.1 汉化版</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E8%84%B1%E5%A3%B3"><span class="toc-number">1.25.</span> <span class="toc-text"> 脚本脱壳</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#acprotect"><span class="toc-number">1.26.</span> <span class="toc-text"> ACProtect</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#acprotect-stolen"><span class="toc-number">1.27.</span> <span class="toc-text"> ACProtect （stolen）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BB%E6%89%BE%E4%BF%AE%E9%A5%B0%E7%9A%84stolen-code"><span class="toc-number">1.28.</span> <span class="toc-text"> 寻找修饰的 stolen code</span></a></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="John Doe"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">John Doe</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">34</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">4</span>
        <span class="name">categories</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">4</span>
        <span class="name">tags</span>
      </a>
    </div>
</nav>

<div class="social">
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>Random Posts</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/web%E5%AE%89%E5%85%A8/" title="In web安全">web安全</a>
</div>

    <span><a href="/2022/11/17/JWT%20%E5%9F%BA%E7%A1%80/" title="JWT">JWT</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2022/12/28/mysql/" title="Mysql">Mysql</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/04/15/Nginx/" title="Nginx">Nginx</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/03/27/http/" title="http">http</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/04/07/TCPIP_new/" title="TCP&#x2F;IP">TCP/IP</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%86%85%E7%BD%91/" title="In 内网">内网</a>
</div>

    <span><a href="/2022/12/25/%E5%86%85%E7%BD%91/" title="内网渗透">内网渗透</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/web%E5%AE%89%E5%85%A8/" title="In web安全">web安全</a>
</div>

    <span><a href="/2022/11/27/Docker%E9%80%83%E9%80%B8/" title="docker逃逸&amp;capabilities">docker逃逸&capabilities</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/web%E5%AE%89%E5%85%A8/" title="In web安全">web安全</a>
</div>

    <span><a href="/2022/03/16/SQL%E6%B3%A8%E5%85%A5/" title="SQL injection">SQL injection</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E7%A7%8B%E6%8B%9B/" title="In 秋招">秋招</a>
</div>

    <span><a href="/2022/10/28/%E7%A7%8B%E6%8B%9B%E9%9D%A2%E8%AF%95%E9%A2%98/" title="秋招面试题">秋招面试题</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/web%E5%AE%89%E5%85%A8/" title="In web安全">web安全</a>
</div>

    <span><a href="/2022/04/16/Upload/" title="File upload">File upload</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>Recent Comments</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">John Doe @ Yume Shoka</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: 'yuque/破解基础知识之认识壳与程序的特征',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,fancybox: true,
    copyright: 'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
