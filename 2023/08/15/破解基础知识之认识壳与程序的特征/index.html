



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="Hexo" href="http://example.com/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="Hexo" href="http://example.com/atom.xml" />
<link rel="alternate" type="application/json" title="Hexo" href="http://example.com/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  

<link rel="canonical" href="http://example.com/2023/08/15/%E7%A0%B4%E8%A7%A3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B9%8B%E8%AE%A4%E8%AF%86%E5%A3%B3%E4%B8%8E%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%89%B9%E5%BE%81/">



  <title>
破解基础知识之认识壳与程序的特征 |
Yume Shoka = Hexo</title>
<meta name="generator" content="Hexo 5.4.2"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">破解基础知识之认识壳与程序的特征
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2023-08-15 13:38:45">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2023-08-15T13:38:45+08:00">2023-08-15</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Yume Shoka</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclil3m4ej20zk0m8tn8.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipexj2jgzj20zk0m8b09.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipesng5oej20zk0m87d4.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipexe4oykj20zk0m87ji.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipesrnqv3j20zk0m8ava.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicmnywqgpj20zk0m8dwx.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="en">
  <link itemprop="mainEntityOfPage" href="http://example.com/2023/08/15/%E7%A0%B4%E8%A7%A3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B9%8B%E8%AE%A4%E8%AF%86%E5%A3%B3%E4%B8%8E%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%89%B9%E5%BE%81/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="John Doe">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Hexo">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="破解基础知识之认识壳与程序的特征"><a class="markdownIt-Anchor" href="#破解基础知识之认识壳与程序的特征">#</a> 破解基础知识之认识壳与程序的特征</h1>
<p>一个程序从编译出来的时候一般都是没有壳的，不同编译器编译出的无壳程序也是不相同的，认识了不同编译器编译出来的无壳的程序，再去看无壳程序被加壳程序加壳后的样子就轻松很多，经过对比从而了解不同语言无壳程序和加壳后程序的特征是什么，特征主要从 “入口点代码”、“程序区段” 和 “加载模块” 等信息来确定。<br>
一：程序是什么语言编译的<br>
从目前国内接触到程序看，比较流行的编译器有：VC 系列、易语言、.NET、Delphi，一些曾经用的很多但渐渐少了有：VB、ASM、BC++，还有一些用的比较少的有：AutoIt、PB、QT 等，结合实例来看看 “入口点代码”、“程序区段” 和 “加载模块” 等特征。</p>
<p><strong>一般使用 exeinfo PE 来识别壳和编译程序，但是还需要根据区段信息 (比如.data,.text)，并且结合代码入口特征来充分判断。</strong></p>
<p>PEinfo 也可以识别，但是由于已经暂停维护，可能会导致误报</p>
<h2 id="vc60"><a class="markdownIt-Anchor" href="#vc60">#</a> vc6.0</h2>
<p>VC++ 6.0 编译，无壳程序<br>
<img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822081440427.png" alt="image-20230822081440427"></p>
<p>** 入口特征：**<strong> 入口点代码是固定的代码，入口调用的 API 也是相同的，其中有的 push 地址不同程序可能不同；区段有四个也是固定的.text、.rdata、.data 和.rsrc。</strong></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822081500143.png" alt="image-20230822081500143"></p>
<p>区段特征：</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822081516456.png" alt="image-20230822081516456"></p>
<p>特征码： <code>55 8B EC 6A FF 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? 64 A1 00 00 00 00 50 64 89 25 00 00 00 00</code></p>
<h3 id="vc"><a class="markdownIt-Anchor" href="#vc">#</a> VC++</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">55            PUSH EBP</span><br><span class="line">8BEC          MOV EBP,ESP</span><br><span class="line">83EC 44       SUB ESP,44</span><br><span class="line">56            PUSH ESI</span><br></pre></td></tr></table></figure>
<h3 id="vc-7"><a class="markdownIt-Anchor" href="#vc-7">#</a> VC 7</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">6A 70              push 70</span><br><span class="line">68 50110001        push hh.01001150</span><br><span class="line">E8 1D020000        call hh.010017B0</span><br><span class="line">33DB               xor ebx,ebx</span><br></pre></td></tr></table></figure>
<h2 id="vs-2008-vs2013"><a class="markdownIt-Anchor" href="#vs-2008-vs2013">#</a> VS 2008 &amp; VS2013</h2>
<ul>
<li>VS 版本的不同会导致编写出的程序特征（链接器、入口点、区段）</li>
<li>debug 下编译的程序区段的数量相对于 Release 多一些</li>
<li>release 的入口存在 call ??? jmp ???，debug 可能是两个 call</li>
</ul>
<table>
<thead>
<tr>
<th>VS 版本</th>
<th>链接器版本</th>
</tr>
</thead>
<tbody>
<tr>
<td>VC 6.0</td>
<td>6.0</td>
</tr>
<tr>
<td>VC2003</td>
<td>7.0 / 7.1</td>
</tr>
<tr>
<td>VS2005</td>
<td>8.0</td>
</tr>
<tr>
<td>VS2008</td>
<td>9.0</td>
</tr>
<tr>
<td>VS2010</td>
<td>10.0</td>
</tr>
<tr>
<td>VS2012</td>
<td>11.0</td>
</tr>
<tr>
<td>VS2013</td>
<td>12.0</td>
</tr>
<tr>
<td>VS2015</td>
<td>14.0</td>
</tr>
<tr>
<td>VS2017</td>
<td>14.1</td>
</tr>
<tr>
<td>VS2019</td>
<td>14.2</td>
</tr>
</tbody>
</table>
<p>vs2008</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822081537484.png" alt="image-20230822081537484"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822081552368.png" alt="image-20230822081552368"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822081608085.png" alt="image-20230822081608085"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822081624203.png" alt="image-20230822081624203"></p>
<p><strong>VS 特点：入口点只有两行代码，一个 CALL 后直接 JMP，第一个 CALL 进去后调用的 API 也是相同的；区段相对于 VC6 多了一个.reloc (重定位表)。</strong></p>
<p>vs2013</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822081651343.png" alt="image-20230822081651343"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822081706723.png" alt="image-20230822081706723"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822081723924.png" alt="image-20230822081723924"></p>
<h2 id="易语言"><a class="markdownIt-Anchor" href="#易语言">#</a> 易语言</h2>
<p>分为独立编译和非独立编译</p>
<p>独立编译后被识别别 VC6 (ver 0.0.3.8)</p>
<p>由于易语言独立编译是调用 VC 的链接程序编译的，所以从区段和入口代码特征和 VC 相同</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822081745844.png" alt="image-20230822081745844"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822081802797.png" alt="image-20230822081802797"></p>
<p>新版 exeinfoPE 识别为 E language/EPL</p>
<p>非独立编译</p>
<p>能识别到下面的 ascii，并且有 krnln.fnr 的字符，程序入口会有很多 jmp</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822081822439.png" alt="image-20230822081822439"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822081836097.png" alt="image-20230822081836097"></p>
<p>搜索中文区段可以看到特征</p>
<p>push -&gt;call -&gt;jump</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822081850049.png" alt="image-20230822081850049"></p>
<p>运行之后加载 krmln.fnr</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822081904654.png" alt="image-20230822081904654"></p>
<p>独立编译</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082005089.png" alt="image-20230822082005089"></p>
<p>还是会有很多 jmp 调用 api</p>
<p>独立编译 / 非独立编译都被识别为四个区段</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082017114.png" alt="image-20230822082017114"></p>
<p>易语言特点：可以从程序里找一些 call 的调用最终都会走到上面核心代码图位置，这个方法可以区分和 VC 的区别，非独立编译比较容易识别，入口特征和模块特征都有 krnln.fnr。</p>
<h2 id="delhpi"><a class="markdownIt-Anchor" href="#delhpi">#</a> Delhpi</h2>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082030859.png" alt="image-20230822082030859"></p>
<p>code + data + bss (未初始化的数据)</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082042537.png" alt="image-20230822082042537"></p>
<p>OEP：</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082121357.png" alt="image-20230822082121357"></p>
<p><strong>特征：入口点有五个 call，第一个 call 的内部调用了 GetModuleHandleA，最后有一堆 00</strong></p>
<p>第一个 call 内部：</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082142314.png" alt="image-20230822082142314"></p>
<p>和 BC++ 特征相同，都是使用 FF25 调到函数。</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082155469.png" alt="image-20230822082155469"></p>
<p>特征码： <code>55 8B EC 83 C4 F0 B8 ?? ?? ?? ?? E8 ?? ?? ?? ??</code></p>
<h2 id="net"><a class="markdownIt-Anchor" href="#net">#</a> .NET</h2>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082215761.png" alt="image-20230822082215761"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082227320.png" alt="image-20230822082227320"></p>
<p>E <span class="exturl" data-url="aHR0cDovL3huLS1maXE1aG42aXN2aWV0aXU2OGUuTkVU">中加载了很多.NET</span> 运行库</p>
<h2 id="asm"><a class="markdownIt-Anchor" href="#asm">#</a> ASM</h2>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082250064.png" alt="image-20230822082250064"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082315269.png" alt="image-20230822082315269"></p>
<p><strong>特征：小，入口点直接就是逻辑代码</strong></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082328241.png" alt="image-20230822082328241"></p>
<h2 id="bc-60"><a class="markdownIt-Anchor" href="#bc-60">#</a> BC++ 6.0</h2>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082346333.png" alt="image-20230822082346333"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082358971.png" alt="image-20230822082358971"></p>
<p><strong>特征：第一行是一个短跳转，跳过了字符串 fb:C++HOOK，跳转的最后一行是 CPPdebugHook，第一个调用的函数是 GetModuleHandleA</strong></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082412419.png" alt="image-20230822082412419"></p>
<p>BC++ 编写的程序，调用 IAT 函数会使用到 FF25 ?? ?? ?? ??</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082423700.png" alt="image-20230822082423700"></p>
<p>PEID 匹配特征码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EB 10 66 62 3A 43 2B 2B 48 4F 4F 4B 90</span><br></pre></td></tr></table></figure>
<h2 id="vb"><a class="markdownIt-Anchor" href="#vb">#</a> VB</h2>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082434530.png" alt="image-20230822082434530"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082445276.png" alt="image-20230822082445276"></p>
<p>特征：push - call - 一堆 00</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082457006.png" alt="image-20230822082457006"></p>
<h2 id="各种软件优缺点"><a class="markdownIt-Anchor" href="#各种软件优缺点">#</a> 各种软件优缺点</h2>
<p>1、通过 [PEiD](<span class="exturl" data-url="aHR0cDovL2Rvd24uNTJwb2ppZS5jbi9Ub29scy9QRXRvb2xzL1BFaUQ=">http://down.52pojie.cn/Tools/PEtools/PEiD</span> 0.95.rar)、<span class="exturl" data-url="aHR0cDovL2Rvd24uNTJwb2ppZS5jbi9Ub29scy9QRXRvb2xzL0V4ZWluZm9QRS56aXA=">Exeinfo PE</span> 等<span class="exturl" data-url="aHR0cDovL3d3dy41MnBvamllLmNuL2ZvcnVtLnBocD9tb2Q9Zm9ydW1kaXNwbGF5JmFtcDtmaWQ9NCZhbXA7ZmlsdGVyPXR5cGVpZCZhbXA7dHlwZWlkPTEyNA==">查壳工具</span>内置各种壳的十六进制特征码进行对比查壳，说下优缺点吧。</p>
<p>PEiD、FFI、FastScanner、RDG Packer Detector 这类程序都是通过目录下的 userdb.txt（查壳程序不同可能数据库名有出入）数据库进行加壳程序特征对比的，由于 userdb.txt 文件都是好多年前的了，全球基本都在用 fly 在 09 年发布的<span class="exturl" data-url="aHR0cDovL3d3dy41MnBvamllLmNuL3RocmVhZC0zMTQ1OC0xLTEuaHRtbA=="> UpKPEiDSign</span>，即使有新的也都基于他制作的版本之上进行更新的，而且更新都没有太好效果，由于原理都是通过加壳程序的特征进行对应，而这些加壳特征都是个人总结而来，对加壳程序的模糊搜索对比造成可靠性不高，特别是对于 VMProtect 这类加密壳程序，经常被识别成一些算七八糟都没见过的加壳内容，特别是显示 UPolyX，基本都是误报，对新手的误导很严重，但对于传统的一些压缩壳的识别效果还是很好的，当然了，有利有弊，正是由于它的开放性特征库，也方便给大家提供自己编写特征的方法，来识别一些新的壳，期待大家能做出自己的加壳特征来。</p>
<p>\2. Exeinfo PE 属于新一代查壳工具，作者目前还在更新，它和 PEiD 的区别可能就在于它的特征库是作者自己维护，不支持外部修改，新版好像也开始支持外部特征库了，这款查壳工具的加壳特征库比较准确而且范围很广，如 Themida、WinLicense、VMProtect、ZProtect、Shielden 都可以轻松识别出来，但对于具体加壳程序的版本都是模糊的，其实个人认为加壳版本真的不重要，这个后面再具体说道，<span class="exturl" data-url="aHR0cDovL3d3dy41MnBvamllLmNuL3RocmVhZC0xNjk3NzktMS0xLmh0bWw=">Exeinfo PE</span> 可以说是目前可以说最好的查壳工具了，推荐大家使用。</p>
<p><strong>入口特征</strong>可以通过<span class="exturl" data-url="aHR0cDovL3d3dy41MnBvamllLmNuL3RocmVhZC0xNDk4Ni0xLTEuaHRtbA=="> OllyDBG</span> 载入获得，载入后可以按一下 “Ctrl+A”，让 OD 分析一下代码，就可以把入口点一些特征字符串分析出来，从下图的入口信息可以轻松看出，这是一款 Safengine 加壳的程序，对于 Shielden、Safengine、VProtect 这类加壳程序都可以使用这种方法判断出来。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cueHhoYWNrLnRvcC9hcmNoaXZlcy9uaS14aWFuZy1qaS1jaHUtLWJ1LXRvbmcteXUteWFuLWNoZW5nLXh1LWRlLXJ1LWtvdS10ZS16aGVuZw==">https://www.xxhack.top/archives/ni-xiang-ji-chu--bu-tong-yu-yan-cheng-xu-de-ru-kou-te-zheng</span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpd2VuOTMwNzIzL2FydGljbGUvZGV0YWlscy80OTQ3MjM3Nw==">https://blog.csdn.net/liwen930723/article/details/49472377</span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuNTJwb2ppZS5jbi90aHJlYWQtMjM0NzM5LTEtMS5odG1s">https://www.52pojie.cn/thread-234739-1-1.html</span></p>
<p>windows 程序状态大体可以分为以下几种类型：未加壳、压缩壳、传统加密壳、代码虚拟化保护、.Net 程序加密</p>
<p>加壳的目的：为了隐藏程序真正的 OEP（入口点），防止被破解。</p>
<p>1、查壳：用于分析软件有没有加壳，加壳是所使用的哪种壳。常用工具（PEID、Ollydbg、）。详细操作过程可参看《<span class="exturl" data-url="aHR0cHM6Ly9saW5rLnpoaWh1LmNvbS8/dGFyZ2V0PWh0dHBzJTNBLy9tYXguYm9vazExOC5jb20vaHRtbC8yMDIwLzA4MTgvNzA0NTA2NTAzNjAwMjE2MS5zaHRt">破解基础 - 你到底有没有</span>》。</p>
<p>2、寻找 OEP：OEP 是程序加壳前真正的入口点，外壳初始化的现场环境（各寄存器值）和原程序的现场环境是相同的，加壳程序初始化时保存各寄存器的值，外壳执行完毕，会恢复各寄存器内容。</p>
<p>3、抓取内存映像文件（Dump）：完成外壳程序解压还原后，在内存中找到运行的目标 PE 进程数据，从内存中抓取出来，然后在用文件的形式保存下来。保存下来的文件可能不能正常运行，有可能是壳对 IAT 进行了加密。</p>
<p><strong>抓取内存映像文件</strong>详细介绍可参考：<span class="exturl" data-url="aHR0cHM6Ly9saW5rLnpoaWh1LmNvbS8/dGFyZ2V0PWh0dHBzJTNBLy9iYnMua2FueHVlLmNvbS90aHJlYWQtMTc2MjQuaHRt">浅谈脱壳中的 Dump 技术</span></p>
<p>4、输入表重建（修改 IAT）：一些加密壳为了防止输入表被还原，会在 IAT 里填充一些扰乱解析的地址（例如：壳中用来 HOOK-API 的外壳代码地址），为了获得没有加密的 IAT，一般可跟踪加壳程序对 IAT 处理过程，修改相关指令，阻止外壳加密 IAT。</p>
<p><strong>输入表重建</strong>详细介绍可参考文件：<span class="exturl" data-url="aHR0cHM6Ly9saW5rLnpoaWh1LmNvbS8/dGFyZ2V0PWh0dHBzJTNBLy93ZW5rdS5iYWlkdS5jb20vdmlldy9jNzI2ODk1MWFiMTE0NDMxYjkwZDZjODVlYzNhODdjMjQwMjg4YTI3Lmh0bWwlM0Zfd2t0c18lM0QxNjczMzQwMTMzMDA4JTI2YmRRdWVyeSUzRCVFOCVCRSU5MyVFNSU4NSVBNSVFOCVBMSVBOCVFOSU4NyU4RCVFNSVCQiVCQQ==">重建输入表 - 百度文库</span></p>
<p>压缩 ==》 减小程序体积【ASPacK、UPX、PECompack 等】 保护程序 ==》 用了各种反跟踪技术保护程序不被调试、脱壳等【ASProtect、Armadillo、EXECryptor 等】</p>
<h2 id="upx"><a class="markdownIt-Anchor" href="#upx">#</a> upx</h2>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082556084.png" alt="image-20230822082556084"></p>
<h3 id="单步跟踪"><a class="markdownIt-Anchor" href="#单步跟踪">#</a> 单步跟踪</h3>
<p>1. 找到 OEP</p>
<p>不能向上跳转，向下跳如果下一行还是跳转 (jmp,call) 就再隔一行。只需要看红线跳转</p>
<p>直到看到大跨度跳转，就是跳往 OEP</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082607763.png" alt="image-20230822082607763"></p>
<p>jmp     0047738C</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082642574.png" alt="image-20230822082642574"></p>
<p>2. 脱壳</p>
<p>可以使用 OD 或者 loadpe</p>
<p>OD 有两种方式：方式 1 和方式二。使用 ollydump</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082702108.png" alt="image-20230822082702108"></p>
<p>loadpe</p>
<p>修正镜像大小 -&gt; 完整转存</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082719412.png" alt="image-20230822082719412"></p>
<p>输入表重建，修复转存文件</p>
<h3 id="esp"><a class="markdownIt-Anchor" href="#esp">#</a> ESP</h3>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082743504.png" alt="image-20230822082743504"></p>
<p>dd esp 或者在数据窗口中跟随 esp</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082756289.png" alt="image-20230822082756289"></p>
<p>在数据窗口中下硬件访问断点，word</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082810312.png" alt="image-20230822082810312"></p>
<p>跳转到 oep</p>
<p>删除硬件断点</p>
<h3 id="二次内存镜像"><a class="markdownIt-Anchor" href="#二次内存镜像">#</a> 二次内存镜像</h3>
<p>先解压 rsrc 以前的所有内容，在对上面的内容下段</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082835523.png" alt="image-20230822082835523"></p>
<p>先对 rsrc 下 F2，在对 upx0 下 F2</p>
<h3 id="查找"><a class="markdownIt-Anchor" href="#查找">#</a> 查找</h3>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082851190.png" alt="image-20230822082851190"></p>
<p>直接找 popad，适用于大部分 upx 和 asp</p>
<h2 id="asp"><a class="markdownIt-Anchor" href="#asp">#</a> ASP</h2>
<h3 id="1单步跟踪"><a class="markdownIt-Anchor" href="#1单步跟踪">#</a> 1. 单步跟踪</h3>
<p>和脱 upx 一样。但是如果碰到 call 程序直接执行，需要 F7 跟进去，一直到 popad，ret 之后就是 oep 了</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082905760.png" alt="image-20230822082905760"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082921137.png" alt="image-20230822082921137"></p>
<p>使用 ollydump 脱壳</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082932908.png" alt="image-20230822082932908"></p>
<h3 id="2esp"><a class="markdownIt-Anchor" href="#2esp">#</a> 2.ESP</h3>
<p>和 upx 一样，下硬件访问断点，断下之后，下面的 retn 就是跳转到 oep</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822082954787.png" alt="image-20230822082954787"></p>
<h3 id="查找popad"><a class="markdownIt-Anchor" href="#查找popad">#</a> 查找 popad</h3>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083008532.png" alt="image-20230822083008532"></p>
<p>如果有多个 popad，ctrl+L 查找下一个</p>
<h3 id="内存镜像"><a class="markdownIt-Anchor" href="#内存镜像">#</a> 内存镜像</h3>
<p>memory 中 rsrc 下一次断，401000 第二次下段</p>
<p>然后单步法</p>
<h3 id="模拟跟踪"><a class="markdownIt-Anchor" href="#模拟跟踪">#</a> 模拟跟踪</h3>
<p>tc eip &lt; .aspack 地址</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083024652.png" alt="image-20230822083024652"></p>
<h3 id="sfx"><a class="markdownIt-Anchor" href="#sfx">#</a> SFX</h3>
<p>选项中</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083039582.png" alt="image-20230822083039582"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083052191.png" alt="image-20230822083052191"></p>
<h2 id="nsp"><a class="markdownIt-Anchor" href="#nsp">#</a> NSP</h2>
<h3 id="esp-2"><a class="markdownIt-Anchor" href="#esp-2">#</a> ESP</h3>
<p>1. 找到 oep</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083104779.png" alt="image-20230822083104779"></p>
<p>2. 在 loadpe 中修正镜像大小，完整转存</p>
<p>3. 修复</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083129331.png" alt="image-20230822083129331"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083139488.png" alt="image-20230822083139488"></p>
<h3 id="单步跟踪-2"><a class="markdownIt-Anchor" href="#单步跟踪-2">#</a> 单步跟踪</h3>
<p>和前两个方法一样</p>
<h3 id="模拟跟踪-2"><a class="markdownIt-Anchor" href="#模拟跟踪-2">#</a> 模拟跟踪</h3>
<p>tc eip&lt;nsp1 地址</p>
<h3 id="两次内存镜像"><a class="markdownIt-Anchor" href="#两次内存镜像">#</a> 两次内存镜像</h3>
<p>nsp0 下段，在单步</p>
<h3 id="特殊方法"><a class="markdownIt-Anchor" href="#特殊方法">#</a> 特殊方法</h3>
<p>at GetVersion</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083157718.png" alt="image-20230822083157718"></p>
<p>在 retn 出下段，执行到该行，在执行一次到 oep 之后</p>
<p>适用于北斗 3 前版本</p>
<h2 id="fsg"><a class="markdownIt-Anchor" href="#fsg">#</a> FSG</h2>
<h3 id="修复"><a class="markdownIt-Anchor" href="#修复">#</a> 修复</h3>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083212702.png" alt="image-20230822083212702"></p>
<p>首先通过单步法找到连续的 jmp，最下面一个 jmp 就会 jmp 到 oep 的位置</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083228686.png" alt="image-20230822083228686"></p>
<p>进行转存并修复</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083243079.png" alt="image-20230822083243079"></p>
<p>手动查找 IAT。使用任意函数找到 IAT</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083303882.png" alt="image-20230822083303882"></p>
<p>425000 开始是 iat</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083317145.png" alt="image-20230822083317145"></p>
<p>425284 是结束</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083332766.png" alt="image-20230822083332766"></p>
<p>25000-25284。更改 rva，大小不想算可以直接写 1000</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083347811.png" alt="image-20230822083347811"></p>
<p>获取导入表，显示无效的，剪切指针，修正转存，即可修复 IAT</p>
<h3 id="esp-3"><a class="markdownIt-Anchor" href="#esp-3">#</a> esp</h3>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083402143.png" alt="image-20230822083402143"></p>
<p>运行到 push 之后使用 esp</p>
<h3 id="特殊esp"><a class="markdownIt-Anchor" href="#特殊esp">#</a> 特殊 esp</h3>
<p>运行扫 push 上一行后，堆栈中第四行即为 OEP</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083418966.png" alt="image-20230822083418966"></p>
<p>反汇编窗口中跟随，下硬件断点，shitf+f9, 即可调到 oep</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083432375.png" alt="image-20230822083432375"></p>
<h2 id="pe-compact-2x"><a class="markdownIt-Anchor" href="#pe-compact-2x">#</a> PE compact 2.x</h2>
<h3 id="单步"><a class="markdownIt-Anchor" href="#单步">#</a> 单步</h3>
<p>有会执行的 call 就跟进去，直到这个 jmp 调到 oep</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083453982.png" alt="image-20230822083453982"></p>
<h3 id="esp-4"><a class="markdownIt-Anchor" href="#esp-4">#</a> esp</h3>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083507205.png" alt="image-20230822083507205"></p>
<h3 id=""><a class="markdownIt-Anchor" href="#">#</a> ？</h3>
<p>BP VirtualFree</p>
<p>shitf + f9</p>
<p>取消断点</p>
<p>alt + F9 执行到用户代码</p>
<p>查找 push 8000</p>
<p>单步</p>
<h3 id="-2"><a class="markdownIt-Anchor" href="#-2">#</a> ？？</h3>
<p>BP VirtualFree</p>
<p>shift + f9</p>
<p>shift + f9</p>
<p>取消断点</p>
<p>alt + f9</p>
<h3 id="-3"><a class="markdownIt-Anchor" href="#-3">#</a> ？？？</h3>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083520274.png" alt="image-20230822083520274"></p>
<p>BP 0045DE74</p>
<p>shift + f9</p>
<p>断点下到执行到 retn 下面一行，shift + f9</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083531604.png" alt="image-20230822083531604"></p>
<p>单步</p>
<h3 id="-4"><a class="markdownIt-Anchor" href="#-4">#</a> ？？？？</h3>
<p>BP VirtualFree</p>
<p>shift + f9</p>
<p>取消断点</p>
<p>alt + F9</p>
<p>找到下一个 jmp，单步</p>
<h3 id="异常"><a class="markdownIt-Anchor" href="#异常">#</a> 异常</h3>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083547111.png" alt="image-20230822083547111"></p>
<p>重新运行程序，多次 shift + f9 直到程序运行</p>
<p>那么在程序运行前的一次 shift + f9，在堆栈窗口中找 se 句柄，在反汇编窗口中跟随</p>
<p>找到 retn 下一行，运行到，单步</p>
<h3 id="两次内存"><a class="markdownIt-Anchor" href="#两次内存">#</a> 两次内存</h3>
<p>rsrc 第一次下段</p>
<p>text 第二次下段</p>
<p>执行到 retn 下一行，单步</p>
<h3 id="at-getversion"><a class="markdownIt-Anchor" href="#at-getversion">#</a> at getversion</h3>
<p>at GetVersion 之后</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083606646.png" alt="image-20230822083606646"></p>
<p>运行到 retn，F8，即可到达程序。向上翻就是 oep</p>
<h2 id="ezip"><a class="markdownIt-Anchor" href="#ezip">#</a> ezip</h2>
<h3 id="单步-2"><a class="markdownIt-Anchor" href="#单步-2">#</a> 单步</h3>
<p>不要管开局那堆 jmp</p>
<p>如果修复完不能运行，使用重建 pe</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083621475.png" alt="image-20230822083621475"></p>
<h3 id="esp-5"><a class="markdownIt-Anchor" href="#esp-5">#</a> esp</h3>
<p>运行到这一行使用 esp 法</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083635266.png" alt="image-20230822083635266"></p>
<h2 id="telock-098b1"><a class="markdownIt-Anchor" href="#telock-098b1">#</a> telock 0.98b1</h2>
<h3 id="最后一次异常"><a class="markdownIt-Anchor" href="#最后一次异常">#</a> 最后一次异常</h3>
<p>第 n-1 次异常，转到 se</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083648254.png" alt="image-20230822083648254"></p>
<p>下段，shift + f9，单步</p>
<p>找到大跳转</p>
<p>记下 oep</p>
<p>使用带壳程序进 irce 原版，查找无效的，L3 修复，修不了的就剪切，修复转存完整镜像的</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083659624.png" alt="image-20230822083659624"></p>
<h3 id="模拟跟踪-3"><a class="markdownIt-Anchor" href="#模拟跟踪-3">#</a> 模拟跟踪</h3>
<p>第 n-1 次异常，转到 se</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083719816.png" alt="image-20230822083719816"></p>
<p>下段，shift + f9</p>
<p>tc eip &lt; 42c000</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083735883.png" alt="image-20230822083735883"></p>
<h3 id="两次内存-2"><a class="markdownIt-Anchor" href="#两次内存-2">#</a> 两次内存</h3>
<p>rsrc</p>
<p>text</p>
<h2 id="exe32"><a class="markdownIt-Anchor" href="#exe32">#</a> exe32</h2>
<h3 id="esp-6"><a class="markdownIt-Anchor" href="#esp-6">#</a> esp</h3>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083751223.png" alt="image-20230822083751223"></p>
<h3 id="isdeubggerpresent"><a class="markdownIt-Anchor" href="#isdeubggerpresent">#</a> IsDeubggerPresent</h3>
<p>BP IsDebuggerPresent</p>
<p>shift + F9</p>
<p>取消断点</p>
<p>alt+f9</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083802156.png" alt="image-20230822083802156"></p>
<p>两个 edi 相加的值就是 oep</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083813219.png" alt="image-20230822083813219"></p>
<h2 id="win"><a class="markdownIt-Anchor" href="#win">#</a> win</h2>
<h3 id="条件断点"><a class="markdownIt-Anchor" href="#条件断点">#</a> 条件断点</h3>
<p>单步到 je 0040A41E 下条件断点 eax == 0</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083836244.png" alt="image-20230822083836244"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083847088.png" alt="image-20230822083847088"></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cueWlpNjY2LmNvbS9ibG9nLzM1MjY5NS5odG1s">https://www.yii666.com/blog/352695.html</span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vejVvbmswL3AvMTcyODcyMTUuaHRtbA==">https://www.cnblogs.com/z5onk0/p/17287215.html</span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC81OTc4OTM1NjA/dXRtX2lkPTA=">https://zhuanlan.zhihu.com/p/597893560?utm_id=0</span></p>
<h2 id="附加数据处理方法"><a class="markdownIt-Anchor" href="#附加数据处理方法">#</a> 附加数据处理方法</h2>
<p>显示 overlay 标识带有附加数据</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230822083909084.png" alt="image-20230822083909084"></p>
<p>先脱壳，脱壳玩之后已经不能打开，接着找附加数据，打开源程序 8c00 之后的附加数据，一直复制到最后</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202125880.png" alt="image-20230823202125880"></p>
<p>在脱壳后的程序最后粘贴即可</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202143088.png" alt="image-20230823202143088"></p>
<p>建议使用 hex workshop</p>
<p>计算开始位置</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202203988.png" alt="image-20230823202203988"></p>
<p>最后一个区段的大小的偏移 8800+400</p>
<p>或者使用 overlay 最终版</p>
<h2 id="去除自校验"><a class="markdownIt-Anchor" href="#去除自校验">#</a> 去除自校验</h2>
<p>程序脱壳后，和源程序对比，找到和源程序不一样的地方</p>
<p>两个程序都用 od 打开，下 bp CreateFileA</p>
<p>运行；</p>
<p>alt  + f9</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202221116.png" alt="image-20230823202221116"></p>
<p>逐行对比找到不一样的地方</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202234145.png" alt="image-20230823202234145"></p>
<p>脱壳后的跳转实现了，把脱壳后改成和原来改成一样的，保存</p>
<p>即可正常执行</p>
<h2 id="脱壳简单应用-汉化-diy"><a class="markdownIt-Anchor" href="#脱壳简单应用-汉化-diy">#</a> 脱壳简单应用 - 汉化 - diy</h2>
<p>vb 类软件用 getvbresource</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202249108.png" alt="image-20230823202249108"></p>
<p>c 类汉化用 reource hacker peexploer  xnresoure</p>
<p>如果不能显示说明脱壳没脱干净，需要 fix</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202304474.png" alt="image-20230823202304474"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202316491.png" alt="image-20230823202316491"></p>
<p>C++ 类</p>
<p>XNRreoute</p>
<h2 id="asp变形壳"><a class="markdownIt-Anchor" href="#asp变形壳">#</a> ASP 变形壳</h2>
<h3 id="单步-3"><a class="markdownIt-Anchor" href="#单步-3">#</a> 单步</h3>
<p>近 call F7 远 call F8</p>
<h3 id="脱asp变形壳01汉化版"><a class="markdownIt-Anchor" href="#脱asp变形壳01汉化版">#</a> 脱 ASP 变形壳 0.1 汉化版</h3>
<p>跟进第一个 jmp</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202332415.png" alt="image-20230823202332415"></p>
<p>单步之后进入循环，统计多少次跳转之后会执行。注意下段</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202357774.png" alt="image-20230823202357774"></p>
<p>58 次之后程序运行，指定到第 57 次</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202408619.png" alt="image-20230823202408619"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202420672.png" alt="image-20230823202420672"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202429950.png" alt="image-20230823202429950"></p>
<p>OEP</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202448642.png" alt="image-20230823202448642"></p>
<h2 id="脚本脱壳"><a class="markdownIt-Anchor" href="#脚本脱壳">#</a> 脚本脱壳</h2>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202505697.png" alt="image-20230823202505697"></p>
<h2 id="acprotect"><a class="markdownIt-Anchor" href="#acprotect">#</a> ACProtect</h2>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202517781.png" alt="image-20230823202517781"></p>
<p>1。设置异常，隐藏 OD</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202532446.png" alt="image-20230823202532446"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202543177.png" alt="image-20230823202543177"></p>
<p>shift + f9 到程序运行前的最后一次异常， 即 int</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202558623.png" alt="image-20230823202558623"></p>
<p>2。SE 处下内存访问断点</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202610173.png" alt="image-20230823202610173"></p>
<p>3。SHIFT+F9，F2，再一次 SHIFT+F9，下断，再一次 SHIFT+F9。运行到下面</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202621786.png" alt="image-20230823202621786"></p>
<p>4，取消所有断点</p>
<p>总共删除三个断点，两个 F2 一个内存访问</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202633995.png" alt="image-20230823202633995"></p>
<p>5，内存，00401000。F2，SHIFT+F9</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202651096.png" alt="image-20230823202651096"></p>
<p>6，直达 OEP！！</p>
<p>7。修复，脱壳成功</p>
<h2 id="acprotect-stolen"><a class="markdownIt-Anchor" href="#acprotect-stolen">#</a> ACProtect （stolen）</h2>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202701371.png" alt="image-20230823202701371"></p>
<p>和正常的 acprotect 一样，但是在第四步到 retn 之后需要找被偷的代码</p>
<p>编辑条件，c++ 入口特征为 push ebp</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202716512.png" alt="image-20230823202716512"></p>
<p>ctrl + f11 跟踪进入 ，到被偷的代码，一共被偷了 6 个字节</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202729791.png" alt="image-20230823202729791"></p>
<p>004254C9    55              push ebp</p>
<p>004254CA    8BEC            mov ebp,esp</p>
<p>004254CC    83EC 44         sub esp,44</p>
<p>重新到 oep，修复</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202743559.png" alt="image-20230823202743559"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202757044.png" alt="image-20230823202757044"></p>
<p>指定 10cc 为新的 eip</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202812165.png" alt="image-20230823202812165"></p>
<p>脱壳，不要选择重建输入表</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202824896.png" alt="image-20230823202824896"></p>
<p>修复：使用源程序修复，不要使用脱壳后的修复</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202838534.png" alt="image-20230823202838534"></p>
<p>修复完修正转存即可</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202854598.png" alt="image-20230823202854598"></p>
<h2 id="寻找修饰的stolen-code"><a class="markdownIt-Anchor" href="#寻找修饰的stolen-code">#</a> 寻找修饰的 stolen code</h2>
<p>1。设置异常（忽略除 INT3 中断的所有异常），隐藏 OD</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202905273.png" alt="image-20230823202905273"></p>
<p>2。来到入口点，F9 运行</p>
<p>004AC000 &gt;  60              pushad   // 记住这个</p>
<p>004AC001    4E              dec esi</p>
<p>004AC002    D3D6            rcl esi,cl</p>
<p>004AC004    4E              dec esi</p>
<p>004AC005    66:D3E8         shr ax,cl</p>
<p>004AC008    4E              dec esi</p>
<p>004AC009    8BC3            mov eax,ebx</p>
<p>004AC00B    48              dec eax</p>
<p>3。程序中断在这里</p>
<p>004BAB23    90              nop   // 这其实也是最后一次异常</p>
<p>004BAB24    64:67:8F06 0000 pop dword ptr fs:[0]</p>
<p>004BAB2A    83C4 04         add esp,4</p>
<p>004BAB2D    60              pushad</p>
<p>004BAB2E    E8 00000000     call NetClean.004BAB33</p>
<p>004BAB33    5E              pop esi</p>
<p>004BAB34    83EE 06         sub esi,6</p>
<p>004BAB37    B9 5B000000     mov ecx,5B</p>
<p>004BAB3C    29CE            sub esi,ecx</p>
<p>004BAB3E    BA 09E5B87E     mov edx,7EB8E509</p>
<p>004BAB43    C1E9 02         shr ecx,2</p>
<p>004BAB46    83E9 02         sub ecx,2</p>
<p>004BAB49    83F9 00         cmp ecx,0</p>
<p>004BAB4C    7C 1A           jl short NetClean.004BAB68</p>
<p>004BAB4E    8B048E          mov eax,dword ptr ds:[esi+ecx*4]</p>
<p>4。看堆栈，找 SE 句柄，数据窗口跟随，下硬件访问断点，shift+F9</p>
<p>5. 下断，再次 SHIFT+F9，下断，再次 SHIFT+F9，取消所有断点，直接 F4 到 RETN 处</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202918479.png" alt="image-20230823202918479"></p>
<p>6。下 d 12ffc0，下硬件断点。SHIFT+F9。</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823202932026.png" alt="image-20230823202932026"></p>
<p>7。记下 Stolen Code 。</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203013137.png" alt="image-20230823203013137"></p>
<p>004C9B31    55              push ebp</p>
<p>004C9B32    8BEC            mov ebp,esp</p>
<p>004C9B34    6A FF           push -1</p>
<p>8。找到内存，在 00401000 处下断，F2，SHIFT+F9。</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203022284.png" alt="image-20230823203022284"></p>
<p>004431F9    68 D8B24400     push NetClean.0044B2D8                 // 这里其实是假的 OEP！！</p>
<p>004431FE    68 B4334400     push NetClean.004433B4                    ; jmp 到</p>
<p>00443203    64:A1 00000000  mov eax,dword ptr fs:[0]</p>
<p>00443209    50              push eax</p>
<p>0044320A    64:8925 0000000&gt;mov dword ptr fs:[0],esp</p>
<p>00443211    83EC 68         sub esp,68</p>
<p>00443214    53              push ebx</p>
<p>9。写入真实的代码！！</p>
<p>注意先分析，在按字节滚动，不然代码会乱</p>
<p>ctrl + 方向键</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203035385.png" alt="image-20230823203035385"></p>
<p>10。OD 插件脱壳，注意，修正 OEP 地址！！</p>
<p>11。IR 修复，用等级 3。不能修复的 CUT 掉。抓取修复。程序还是抱错！</p>
<p>12。用 OD 打开 11 步修复过得程序，做下处理。来到壳的入口。也就是第一步记下的地址</p>
<p>CTRL+G，004AC000</p>
<p>13，写入真的 OEP 代码。保存</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203053278.png" alt="image-20230823203053278"></p>
<p>14。Lord PE 修正入口点</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203103610.png" alt="image-20230823203103610"></p>
<p>15。保存，脱壳成功！</p>
<h2 id="acprotect-2x"><a class="markdownIt-Anchor" href="#acprotect-2x">#</a> ACProtect 2.x</h2>
<p>VB 程序：</p>
<p>先根据 ACP 上面的方法找到 oep</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203115600.png" alt="image-20230823203115600"></p>
<p>修复：</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203133544.png" alt="image-20230823203133544"></p>
<p>VB 第一个 push 是堆栈中第二行的值</p>
<p>第二个 call 是最后一个 jmp 的值</p>
<p>程序二：</p>
<p>1. 下断：bp GetCurrentProcessId，F9</p>
<p><img data-src="https://cdn.nlark.com/yuque/0/2023/png/2759285/1692130047921-73cddd0d-1b5b-4e0a-ad4c-32593ad10999.png" alt="img"></p>
<p>2。</p>
<p>7C809940 &gt;  64:A1 18000000  mov eax,dword ptr fs:[18]  // 断在这，取消断点</p>
<p>7C809946    8B40 20         mov eax,dword ptr ds:[eax+20]</p>
<p>7C809949    C3              retn</p>
<p>3。用 Lord PE 查 OD 的 PID。</p>
<p>4。把 2 中的代码改为</p>
<p>7C809940 &gt;  B8 3C150000     mov eax,153C （当然，PID 号每次都会变）</p>
<p>7C809945    90              nop</p>
<p>7C809946    90              nop</p>
<p>7C809947    90              nop</p>
<p>7C809948    90              nop</p>
<p>7C809949    C3              retn</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203215898.png" alt="image-20230823203215898"></p>
<p>5。下断，BP GetModuleHandleA，F9</p>
<p>6。</p>
<p>7C80B6C1 &gt;  8BFF            mov edi,edi   // 断在这</p>
<p>7C80B6C3    55              push ebp</p>
<p>7C80B6C4    8BEC            mov ebp,esp</p>
<p>7C80B6C6    837D 08 00      cmp dword ptr ss:[ebp+8],0</p>
<p>7C80B6CA    74 18           je short kernel32.7C80B6E4</p>
<p>7C80B6CC    FF75 08         push dword ptr ss:[ebp+8]</p>
<p>7C80B6CF    E8 C0290000     call kernel32.7C80E094</p>
<p>7C80B6D4    85C0            test eax,eax</p>
<p>7C80B6D6    74 08           je short kernel32.7C80B6E0</p>
<p>7C80B6D8    FF70 04         push dword ptr ds:[eax+4]</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203229480.png" alt="image-20230823203229480"></p>
<p>7。来到内存，在 CODE 断下内存访问断点，F9 运行，出现 NAG 窗口，点确定后，来到 OEP！！！</p>
<p>00402150    55              push ebp  //OEP！！</p>
<p>00402151    8BEC            mov ebp,esp</p>
<p>00402153    83C4 F0         add esp,-10</p>
<p>00402156    53              push ebx</p>
<p>00402157    B8 10214000     mov eax,ACP_Feed.00402110</p>
<p>0040215C    E8 4FFCFFFF     call ACP_Feed.00401DB0</p>
<p>00402161    68 C4214000     push ACP_Feed.004021C4                    ; ASCII “ACProtect Feedback Form”</p>
<p>00402166    6A 00           push 0</p>
<p>00402168    6A 00           push 0</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203240237.png" alt="image-20230823203240237"></p>
<p>8。脱壳，修复。用等级 3！或者手动找 MessageBoxA</p>
<p>9。抓取，脱壳成功！！</p>
<h3 id="-5"><a class="markdownIt-Anchor" href="#-5">#</a> </h3>
<h2 id="特殊的acprotect"><a class="markdownIt-Anchor" href="#特殊的acprotect">#</a> 特殊的 ACProtect</h2>
<p>取消忽略 int3，程序断在这边</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203249815.png" alt="image-20230823203249815"></p>
<p>使用堆栈窗口中 se 大法</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203259109.png" alt="image-20230823203259109"></p>
<p>取消所有断点</p>
<p>找到假的 oep</p>
<p>重新载入，使用 esp 大法</p>
<p>运行到程序执行前</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203310181.png" alt="image-20230823203310181"></p>
<p>脱壳</p>
<p>修正，完整转存</p>
<p>修复，oep 写假的 oep</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203322391.png" alt="image-20230823203322391"></p>
<p>修复 IAT 未果，剪切 iat，修复转存，转存之前把 oep 改到运行之前的地址</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203332596.png" alt="image-20230823203332596"></p>
<h2 id="anti-protect"><a class="markdownIt-Anchor" href="#anti-protect">#</a> anti protect</h2>
<p>补区段</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br></pre></td><td class="code"><pre><span class="line">1、忽略所有异常</span><br><span class="line"></span><br><span class="line">2、打开内存镜像，在.rdata处F2，SHIFT+F9</span><br><span class="line"></span><br><span class="line">没有.rdata用.idata</span><br><span class="line"></span><br><span class="line">3、</span><br><span class="line">0043383D    8B46 0C             mov eax,dword ptr ds:[esi+C]     //中断在这里</span><br><span class="line">00433840    0BC0                or eax,eax</span><br><span class="line">00433842    0F84 25020000       je NgaMy.00433A6D</span><br><span class="line">00433848    8366 0C 00          and dword ptr ds:[esi+C],0</span><br><span class="line">0043384C    03C2                add eax,edx</span><br><span class="line">0043384E    8BD8                mov ebx,eax</span><br><span class="line">00433850    56                  push esi</span><br><span class="line">00433851    57                  push edi</span><br><span class="line">00433852    50                  push eax</span><br><span class="line">00433853    8BF3                mov esi,ebx</span><br><span class="line">00433855    8BFB                mov edi,ebx</span><br><span class="line">00433857    AC                  lods byte ptr ds:[esi]</span><br><span class="line">00433858    C0C0 03             rol al,3</span><br><span class="line">0043385B    AA                  stos byte ptr es:[edi]</span><br><span class="line">0043385C    803F 00             cmp byte ptr ds:[edi],0</span><br><span class="line">0043385F  ^ 75 F6               jnz short NgaMy.00433857</span><br><span class="line">00433861    58                  pop eax</span><br><span class="line">00433862    5F                  pop edi</span><br><span class="line">00433863    5E                  pop esi</span><br><span class="line">00433864    50                  push eax</span><br><span class="line">00433865    FF95 90E24100       call dword ptr ss:[ebp+41E290]</span><br><span class="line">0043386B    0BC0                or eax,eax</span><br><span class="line">0043386D    75 43               jnz short NgaMy.004338B2</span><br><span class="line">0043386F    90                  nop</span><br><span class="line">00433870    90                  nop</span><br><span class="line">00433871    90                  nop</span><br><span class="line">00433872    90                  nop</span><br><span class="line">00433873    53                  push ebx</span><br><span class="line">00433874    FF95 94E24100       call dword ptr ss:[ebp+41E294]</span><br><span class="line">0043387A    0BC0                or eax,eax</span><br><span class="line">0043387C    75 34               jnz short NgaMy.004338B2</span><br><span class="line">0043387E    90                  nop</span><br><span class="line">0043387F    90                  nop</span><br><span class="line">00433880    90                  nop</span><br><span class="line">00433881    90                  nop</span><br><span class="line">00433882    8B95 1FFC4000       mov edx,dword ptr ss:[ebp+40FC1F]</span><br><span class="line">00433888    0195 1D1F4000       add dword ptr ss:[ebp+401F1D],edx</span><br><span class="line">0043388E    0195 211F4000       add dword ptr ss:[ebp+401F21],edx</span><br><span class="line">00433894    6A 00               push 0</span><br><span class="line">00433896    FFB5 1D1F4000       push dword ptr ss:[ebp+401F1D]</span><br><span class="line">0043389C    FFB5 211F4000       push dword ptr ss:[ebp+401F21]</span><br><span class="line">004338A2    6A 00               push 0</span><br><span class="line">004338A4    FF95 9CE24100       call dword ptr ss:[ebp+41E29C]</span><br><span class="line">004338AA    6A 00               push 0</span><br><span class="line">004338AC    FF95 98E24100       call dword ptr ss:[ebp+41E298]</span><br><span class="line">004338B2    60                  pushad</span><br><span class="line">004338B3    2BC0                sub eax,eax</span><br><span class="line">004338B5    8803                mov byte ptr ds:[ebx],al</span><br><span class="line">004338B7    43                  inc ebx</span><br><span class="line">004338B8    3803                cmp byte ptr ds:[ebx],al</span><br><span class="line">004338BA  ^ 75 F9               jnz short NgaMy.004338B5</span><br><span class="line">004338BC    61                  popad</span><br><span class="line">004338BD    8985 17FC4000       mov dword ptr ss:[ebp+40FC17],eax</span><br><span class="line">004338C3    C785 1BFC4000 00000&gt;mov dword ptr ss:[ebp+40FC1B],0</span><br><span class="line">004338CD    8B95 1FFC4000       mov edx,dword ptr ss:[ebp+40FC1F]</span><br><span class="line">004338D3    8B06                mov eax,dword ptr ds:[esi]</span><br><span class="line">004338D5    0BC0                or eax,eax</span><br><span class="line">004338D7    75 07               jnz short NgaMy.004338E0</span><br><span class="line">004338D9    90                  nop</span><br><span class="line">004338DA    90                  nop</span><br><span class="line">004338DB    90                  nop</span><br><span class="line">004338DC    90                  nop</span><br><span class="line">004338DD    8B46 10             mov eax,dword ptr ds:[esi+10]</span><br><span class="line">004338E0    03C2                add eax,edx</span><br><span class="line">004338E2    0385 1BFC4000       add eax,dword ptr ss:[ebp+40FC1B]</span><br><span class="line">004338E8    8B18                mov ebx,dword ptr ds:[eax]</span><br><span class="line">004338EA    8B7E 10             mov edi,dword ptr ds:[esi+10]</span><br><span class="line">004338ED    03FA                add edi,edx</span><br><span class="line">004338EF    03BD 1BFC4000       add edi,dword ptr ss:[ebp+40FC1B]</span><br><span class="line">004338F5    85DB                test ebx,ebx</span><br><span class="line">004338F7    0F84 62010000       je NgaMy.00433A5F</span><br><span class="line">004338FD    F7C3 00000080       test ebx,80000000</span><br><span class="line">00433903    75 1D               jnz short NgaMy.00433922</span><br><span class="line">00433905    90                  nop</span><br><span class="line">00433906    90                  nop</span><br><span class="line">00433907    90                  nop</span><br><span class="line">00433908    90                  nop</span><br><span class="line">00433909    03DA                add ebx,edx</span><br><span class="line">0043390B    83C3 02             add ebx,2</span><br><span class="line">0043390E    56                  push esi</span><br><span class="line">0043390F    57                  push edi</span><br><span class="line">00433910    50                  push eax</span><br><span class="line">00433911    8BF3                mov esi,ebx</span><br><span class="line">00433913    8BFB                mov edi,ebx</span><br><span class="line">00433915    AC                  lods byte ptr ds:[esi]</span><br><span class="line">00433916    C0C0 03             rol al,3</span><br><span class="line">00433919    AA                  stos byte ptr es:[edi]</span><br><span class="line">0043391A    803F 00             cmp byte ptr ds:[edi],0</span><br><span class="line">0043391D  ^ 75 F6               jnz short NgaMy.00433915</span><br><span class="line">0043391F    58                  pop eax</span><br><span class="line">00433920    5F                  pop edi</span><br><span class="line">00433921    5E                  pop esi</span><br><span class="line">00433922    3B9D 1FFC4000       cmp ebx,dword ptr ss:[ebp+40FC1F]</span><br><span class="line">00433928    7C 11               jl short NgaMy.0043393B</span><br><span class="line">0043392A    90                  nop</span><br><span class="line">0043392B    90                  nop</span><br><span class="line">0043392C    90                  nop</span><br><span class="line">0043392D    90                  nop</span><br><span class="line">0043392E    83BD 02244000 00    cmp dword ptr ss:[ebp+402402],0</span><br><span class="line">00433935    75 0A               jnz short NgaMy.00433941</span><br><span class="line">00433937    90                  nop</span><br><span class="line">00433938    90                  nop</span><br><span class="line">00433939    90                  nop</span><br><span class="line">0043393A    90                  nop</span><br><span class="line">0043393B    81E3 FFFFFF0F       and ebx,0FFFFFFF</span><br><span class="line">00433941    53                  push ebx</span><br><span class="line">00433942    FFB5 17FC4000       push dword ptr ss:[ebp+40FC17]</span><br><span class="line">00433948    FF95 8CE24100       call dword ptr ss:[ebp+41E28C]</span><br><span class="line">0043394E    3B9D 1FFC4000       cmp ebx,dword ptr ss:[ebp+40FC1F]</span><br><span class="line">00433954    7C 0F               jl short NgaMy.00433965</span><br><span class="line">00433956    90                  nop</span><br><span class="line">00433957    90                  nop</span><br><span class="line">00433958    90                  nop</span><br><span class="line">00433959    90                  nop</span><br><span class="line">0043395A    60                  pushad</span><br><span class="line">0043395B    2BC0                sub eax,eax</span><br><span class="line">0043395D    8803                mov byte ptr ds:[ebx],al</span><br><span class="line">0043395F    43                  inc ebx</span><br><span class="line">00433960    3803                cmp byte ptr ds:[ebx],al</span><br><span class="line">00433962  ^ 75 F9               jnz short NgaMy.0043395D</span><br><span class="line">00433964    61                  popad</span><br><span class="line">00433965    0BC0                or eax,eax</span><br><span class="line">00433967  ^ 0F84 15FFFFFF       je NgaMy.00433882</span><br><span class="line">0043396D    3B85 9CE24100       cmp eax,dword ptr ss:[ebp+41E29C]          //处理MessageBoxA</span><br><span class="line">00433973    74 20               je short NgaMy.00433995                    //NOP掉</span><br><span class="line">00433975    90                  nop</span><br><span class="line">00433976    90                  nop</span><br><span class="line">00433977    90                  nop</span><br><span class="line">00433978    90                  nop</span><br><span class="line">00433979    3B85 9D014100       cmp eax,dword ptr ss:[ebp+41019D]          //处理RegisterHotKey</span><br><span class="line">0043397F    74 09               je short NgaMy.0043398A                    //NOP掉</span><br><span class="line">00433981    90                  nop</span><br><span class="line">00433982    90                  nop</span><br><span class="line">00433983    90                  nop</span><br><span class="line">00433984    90                  nop</span><br><span class="line">00433985    EB 14               jmp short NgaMy.0043399B</span><br><span class="line">00433987    90                  nop</span><br><span class="line">00433988    90                  nop</span><br><span class="line">00433989    90                  nop</span><br><span class="line">0043398A    8D85 0A024100       lea eax,dword ptr ss:[ebp+41020A]</span><br><span class="line">00433990    EB 09               jmp short NgaMy.0043399B</span><br><span class="line">00433992    90                  nop</span><br><span class="line">00433993    90                  nop</span><br><span class="line">00433994    90                  nop</span><br><span class="line">00433995    8D85 24024100       lea eax,dword ptr ss:[ebp+410224]</span><br><span class="line">0043399B    56                  push esi</span><br><span class="line">0043399C    FFB5 17FC4000       push dword ptr ss:[ebp+40FC17]</span><br><span class="line">004339A2    5E                  pop esi</span><br><span class="line">004339A3    39B5 FA234000       cmp dword ptr ss:[ebp+4023FA],esi</span><br><span class="line">004339A9    74 15               je short NgaMy.004339C0</span><br><span class="line">004339AB    90                  nop</span><br><span class="line">004339AC    90                  nop</span><br><span class="line">004339AD    90                  nop</span><br><span class="line">004339AE    90                  nop</span><br><span class="line">004339AF    39B5 FE234000       cmp dword ptr ss:[ebp+4023FE],esi</span><br><span class="line">004339B5    74 09               je short NgaMy.004339C0</span><br><span class="line">004339B7    90                  nop</span><br><span class="line">004339B8    90                  nop</span><br><span class="line">004339B9    90                  nop</span><br><span class="line">004339BA    90                  nop</span><br><span class="line">004339BB    EB 63               jmp short NgaMy.00433A20</span><br><span class="line">004339BD    90                  nop</span><br><span class="line">004339BE    90                  nop</span><br><span class="line">004339BF    90                  nop</span><br><span class="line">004339C0    80BD D2594100 00    cmp byte ptr ss:[ebp+4159D2],0</span><br><span class="line">004339C7    74 57               je short NgaMy.00433A20                //magic跳，改JMP</span><br><span class="line">004339C9    90                  nop</span><br><span class="line">004339CA    90                  nop</span><br><span class="line">004339CB    90                  nop</span><br><span class="line">004339CC    90                  nop</span><br><span class="line">004339CD    EB 07               jmp short NgaMy.004339D6</span><br><span class="line">004339CF    90                  nop</span><br><span class="line">004339D0    90                  nop</span><br><span class="line">004339D1    90                  nop</span><br><span class="line">004339D2    0100                add dword ptr ds:[eax],eax</span><br><span class="line">004339D4    0000                add byte ptr ds:[eax],al</span><br><span class="line">004339D6    8BB5 E4FC4000       mov esi,dword ptr ss:[ebp+40FCE4]</span><br><span class="line">004339DC    83C6 0D             add esi,0D</span><br><span class="line">004339DF    81EE EA1B4000       sub esi,NgaMy.00401BEA</span><br><span class="line">004339E5    2BF5                sub esi,ebp</span><br><span class="line">004339E7    83FE 00             cmp esi,0</span><br><span class="line">004339EA    7F 34               jg short NgaMy.00433A20</span><br><span class="line">004339EC    90                  nop</span><br><span class="line">004339ED    90                  nop</span><br><span class="line">004339EE    90                  nop</span><br><span class="line">004339EF    90                  nop</span><br><span class="line"></span><br><span class="line">4、在00401000处内存访问断点，SHIFT+F9</span><br><span class="line"></span><br><span class="line">00403D38    68 8C3D4000         push NgaMy.00403D8C             //中断在这里</span><br><span class="line">00403D3D    64:A1 00000000      mov eax,dword ptr fs:[0]</span><br><span class="line">00403D43    50                  push eax</span><br><span class="line">00403D44    8B4424 10           mov eax,dword ptr ss:[esp+10]</span><br><span class="line">00403D48    896C24 10           mov dword ptr ss:[esp+10],ebp</span><br><span class="line">00403D4C    8D6C24 10           lea ebp,dword ptr ss:[esp+10]</span><br><span class="line">00403D50    2BE0                sub esp,eax</span><br><span class="line">00403D52    53                  push ebx</span><br><span class="line">00403D53    56                  push esi</span><br><span class="line">00403D54    57                  push edi</span><br><span class="line">00403D55    8B45 F8             mov eax,dword ptr ss:[ebp-8]</span><br><span class="line">00403D58    8965 E8             mov dword ptr ss:[ebp-18],esp</span><br><span class="line">00403D5B    50                  push eax</span><br><span class="line">00403D5C    8B45 FC             mov eax,dword ptr ss:[ebp-4]</span><br><span class="line">00403D5F    C745 FC FFFFFFFF    mov dword ptr ss:[ebp-4],-1</span><br><span class="line">00403D66    8945 F8             mov dword ptr ss:[ebp-8],eax</span><br><span class="line">00403D69    8D45 F0             lea eax,dword ptr ss:[ebp-10]</span><br><span class="line">00403D6C    64:A3 00000000      mov dword ptr fs:[0],eax</span><br><span class="line">00403D72    C3                  retn                       //运行到这里，然后F8</span><br><span class="line"></span><br><span class="line">5、接着SHIFT+F9</span><br><span class="line"></span><br><span class="line">00405560    3D 00100000         cmp eax,1000                //中断在这里</span><br><span class="line">00405565    73 0E               jnb short NgaMy.00405575</span><br><span class="line">00405567    F7D8                neg eax</span><br><span class="line">00405569    03C4                add eax,esp</span><br><span class="line">0040556B    83C0 04             add eax,4</span><br><span class="line">0040556E    8500                test dword ptr ds:[eax],eax</span><br><span class="line">00405570    94                  xchg eax,esp</span><br><span class="line">00405571    8B00                mov eax,dword ptr ds:[eax]</span><br><span class="line">00405573    50                  push eax</span><br><span class="line">00405574    C3                  retn                    //F4，然后F8</span><br><span class="line"></span><br><span class="line">6。再SHIFT+F9</span><br><span class="line"></span><br><span class="line">0040305C    83F9 02             cmp ecx,2              //中断在这里，这里就是假OEP</span><br><span class="line">0040305F    74 0C               je short NgaMy.0040306D</span><br><span class="line">00403061    81CE 00800000       or esi,8000</span><br><span class="line">00403067    8935 B0DE4000       mov dword ptr ds:[40DEB0],esi</span><br><span class="line">0040306D    C1E0 08             shl eax,8</span><br><span class="line">00403070    03C2                add eax,edx</span><br><span class="line">00403072    A3 B4DE4000         mov dword ptr ds:[40DEB4],eax</span><br><span class="line">00403077    33F6                xor esi,esi</span><br><span class="line">00403079    56                  push esi</span><br><span class="line">0040307A    8B3D B0A04000       mov edi,dword ptr ds:[40A0B0]                   ; kernel32.GetModuleHandleA</span><br><span class="line">00403080    FFD7                call edi</span><br><span class="line">00403082    66:8138 4D5A        cmp word ptr ds:[eax],5A4D</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">7。脱壳，修复</span><br><span class="line"></span><br><span class="line">8、重新载入，在pushad 下用ESP定律</span><br><span class="line"></span><br><span class="line">hr 0012ffa4，SHIFT+F9（5次），来到这里</span><br><span class="line"></span><br><span class="line">004365F4    8915 F5FD4100       mov dword ptr ds:[41FDF5],edx                   ; ntdll.KiFastSystemCallRet</span><br><span class="line">004365FA    FF35 F5FD4100       push dword ptr ds:[41FDF5]</span><br><span class="line">00436600    8F05 2DFE4100       pop dword ptr ds:[41FE2D]</span><br><span class="line">00436606    FF35 2DFE4100       push dword ptr ds:[41FE2D]</span><br><span class="line">0043660C    C70424 60000000     mov dword ptr ss:[esp],60</span><br><span class="line">00436613    56                  push esi</span><br><span class="line">00436614    890C24              mov dword ptr ss:[esp],ecx</span><br><span class="line">00436617    68 8DFD4100         push NgaMy.0041FD8D</span><br><span class="line">0043661C    59                  pop ecx</span><br><span class="line">0043661D    8919                mov dword ptr ds:[ecx],ebx</span><br><span class="line">0043661F    8B0C24              mov ecx,dword ptr ss:[esp]</span><br><span class="line">00436622    8F05 ADFE4100       pop dword ptr ds:[41FEAD]</span><br><span class="line">00436628    FF35 8DFD4100       push dword ptr ds:[41FD8D]</span><br><span class="line">0043662E    C70424 48A24000     mov dword ptr ss:[esp],NgaMy.0040A248</span><br><span class="line">00436635    8905 B9FD4100       mov dword ptr ds:[41FDB9],eax</span><br><span class="line">0043663B    FF35 B9FD4100       push dword ptr ds:[41FDB9]</span><br><span class="line">00436641    90                  nop</span><br><span class="line">00436642    90                  nop</span><br><span class="line">00436643    60                  pushad</span><br><span class="line">00436644    E8 01000000         call NgaMy.0043664A             //F4到这里，然后用ESP</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pushad 上面的就是Stolen Code（NOP可以不复制），复制下来：</span><br><span class="line"></span><br><span class="line">89 15 F5 FD 41 00 FF 35 F5 FD 41 00 8F 05 2D FE 41 00 FF 35 2D FE 41 00 C7 04 24 60 00 00 00 56</span><br><span class="line">89 0C 24 68 8D FD 41 00 59 89 19 8B 0C 24 8F 05 AD FE 41 00 FF 35 8D FD 41 00 C7 04 24 48 A2 40</span><br><span class="line">00 89 05 B9 FD 41 00 FF 35 B9 FD 41 00</span><br><span class="line"></span><br><span class="line">9、hr 0012ff98，F9</span><br><span class="line"></span><br><span class="line">00436F16    68 1DFD4100         push NgaMy.0041FD1D</span><br><span class="line">00436F1B    58                  pop eax</span><br><span class="line">00436F1C    8930                mov dword ptr ds:[eax],esi</span><br><span class="line">00436F1E    8F05 79FC4100       pop dword ptr ds:[41FC79]</span><br><span class="line">00436F24    8B05 79FC4100       mov eax,dword ptr ds:[41FC79]</span><br><span class="line">00436F2A    FF35 1DFD4100       push dword ptr ds:[41FD1D]</span><br><span class="line">00436F30    56                  push esi</span><br><span class="line">00436F31    891C24              mov dword ptr ss:[esp],ebx</span><br><span class="line">00436F34    C70424 383D4000     mov dword ptr ss:[esp],NgaMy.00403D38</span><br><span class="line">00436F3B    8B3424              mov esi,dword ptr ss:[esp]</span><br><span class="line">00436F3E    8F05 A5FE4100       pop dword ptr ds:[41FEA5]</span><br><span class="line">00436F44    8905 01FF4100       mov dword ptr ds:[41FF01],eax</span><br><span class="line">00436F4A    FF35 01FF4100       push dword ptr ds:[41FF01]</span><br><span class="line">00436F50    891C24              mov dword ptr ss:[esp],ebx</span><br><span class="line">00436F53    56                  push esi</span><br><span class="line">00436F54    C70424 45FE4100     mov dword ptr ss:[esp],NgaMy.0041FE45</span><br><span class="line">00436F5B    8F05 31FE4100       pop dword ptr ds:[41FE31]</span><br><span class="line">00436F61    90                  nop</span><br><span class="line">00436F62    90                  nop</span><br><span class="line">00436F63    60                  pushad                </span><br><span class="line">00436F64    E8 01000000         call NgaMy.00436F6A</span><br><span class="line"></span><br><span class="line">都是同样处理！！</span><br><span class="line"></span><br><span class="line">68 1D FD 41 00 58 89 30 8F 05 79 FC 41 00 8B 05 79 FC 41 00 FF 35 1D FD 41 00 56 89 1C 24 C7 04</span><br><span class="line">24 38 3D 40 00 8B 34 24 8F 05 A5 FE 41 00 89 05 01 FF 41 00 FF 35 01 FF 41 00 89 1C 24 56 C7 04</span><br><span class="line">24 45 FE 41 00 8F 05 31 FE 41 00</span><br><span class="line"></span><br><span class="line">10、hr 0012ff94，F9</span><br><span class="line"></span><br><span class="line">0043783F    8B1D 31FE4100       mov ebx,dword ptr ds:[41FE31]                   ; NgaMy.0041FE45</span><br><span class="line">00437845    8933                mov dword ptr ds:[ebx],esi</span><br><span class="line">00437847    8F05 39FC4100       pop dword ptr ds:[41FC39]</span><br><span class="line">0043784D    FF35 39FC4100       push dword ptr ds:[41FC39]</span><br><span class="line">00437853    5B                  pop ebx</span><br><span class="line">00437854    8F05 09FE4100       pop dword ptr ds:[41FE09]</span><br><span class="line">0043785A    891D 21FC4100       mov dword ptr ds:[41FC21],ebx</span><br><span class="line">00437860    FF35 21FC4100       push dword ptr ds:[41FC21]</span><br><span class="line">00437866    C705 19FC4100 09FE4&gt;mov dword ptr ds:[41FC19],NgaMy.0041FE09</span><br><span class="line">00437870    8B1D 19FC4100       mov ebx,dword ptr ds:[41FC19]</span><br><span class="line">00437876    8B33                mov esi,dword ptr ds:[ebx]</span><br><span class="line">00437878    8F05 FDFB4100       pop dword ptr ds:[41FBFD]</span><br><span class="line">0043787E    8B1D FDFB4100       mov ebx,dword ptr ds:[41FBFD]</span><br><span class="line">00437884    FF15 45FE4100       call dword ptr ds:[41FE45]</span><br><span class="line">0043788A    90                  nop</span><br><span class="line">0043788B    90                  nop</span><br><span class="line">0043788C    60                  pushad</span><br><span class="line">0043788D    E8 01000000         call NgaMy.00437893</span><br><span class="line"></span><br><span class="line">8B 1D 31 FE 41 00 89 33 8F 05 39 FC 41 00 FF 35 39 FC 41 00 5B 8F 05 09 FE 41 00 89 1D 21 FC 41</span><br><span class="line">00 FF 35 21 FC 41 00 C7 05 19 FC 41 00 09 FE 41 00 8B 1D 19 FC 41 00 8B 33 8F 05 FD FB 41 00 8B</span><br><span class="line">1D FD FB 41 00 FF 15 45 FE 41 00</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">11、hr 0012ff24，F9（多几次）</span><br><span class="line"></span><br><span class="line">0043813D    890D B1FD4100       mov dword ptr ds:[41FDB1],ecx</span><br><span class="line">00438143    FF35 B1FD4100       push dword ptr ds:[41FDB1]</span><br><span class="line">00438149    8F05 B5FC4100       pop dword ptr ds:[41FCB5]</span><br><span class="line">0043814F    FF35 B5FC4100       push dword ptr ds:[41FCB5]</span><br><span class="line">00438155    56                  push esi</span><br><span class="line">00438156    BE FDFC4100         mov esi,NgaMy.0041FCFD</span><br><span class="line">0043815B    893E                mov dword ptr ds:[esi],edi</span><br><span class="line">0043815D    5E                  pop esi</span><br><span class="line">0043815E    FF35 FDFC4100       push dword ptr ds:[41FCFD]</span><br><span class="line">00438164    68 94000000         push 94</span><br><span class="line">00438169    8F05 E5FC4100       pop dword ptr ds:[41FCE5]</span><br><span class="line">0043816F    FF35 E5FC4100       push dword ptr ds:[41FCE5]</span><br><span class="line">00438175    5F                  pop edi</span><br><span class="line">00438176    893D 3DFE4100       mov dword ptr ds:[41FE3D],edi</span><br><span class="line">0043817C    FF35 3DFE4100       push dword ptr ds:[41FE3D]</span><br><span class="line">00438182    8B0C24              mov ecx,dword ptr ss:[esp]</span><br><span class="line">00438185    8F05 7DFE4100       pop dword ptr ds:[41FE7D]</span><br><span class="line">0043818B    90                  nop</span><br><span class="line">0043818C    90                  nop</span><br><span class="line">0043818D    60                  pushad</span><br><span class="line">0043818E    50                  push eax</span><br><span class="line"></span><br><span class="line">89 0D B1 FD 41 00 FF 35 B1 FD 41 00 8F 05 B5 FC 41 00 FF 35 B5 FC 41 00 56 BE FD FC 41 00 89 3E</span><br><span class="line">5E FF 35 FD FC 41 00 68 94 00 00 00 8F 05 E5 FC 41 00 FF 35 E5 FC 41 00 5F 89 3D 3D FE 41 00 FF</span><br><span class="line">35 3D FE 41 00 8B 0C 24 8F 05 7D FE 41 00</span><br><span class="line"></span><br><span class="line">12、hr 0012ff1c，F9（多试几次）</span><br><span class="line"></span><br><span class="line">00438ACD    8B3C24              mov edi,dword ptr ss:[esp]</span><br><span class="line">00438AD0    8F05 79FD4100       pop dword ptr ds:[41FD79]                       ; ntdll.7C930738</span><br><span class="line">00438AD6    8935 25FC4100       mov dword ptr ds:[41FC25],esi</span><br><span class="line">00438ADC    FF35 25FC4100       push dword ptr ds:[41FC25]</span><br><span class="line">00438AE2    890C24              mov dword ptr ss:[esp],ecx</span><br><span class="line">00438AE5    8B3C24              mov edi,dword ptr ss:[esp]</span><br><span class="line">00438AE8    8F05 B9FC4100       pop dword ptr ds:[41FCB9]</span><br><span class="line">00438AEE    8F05 19FE4100       pop dword ptr ds:[41FE19]</span><br><span class="line">00438AF4    8905 89FD4100       mov dword ptr ds:[41FD89],eax</span><br><span class="line">00438AFA    FF35 89FD4100       push dword ptr ds:[41FD89]</span><br><span class="line">00438B00    57                  push edi</span><br><span class="line">00438B01    BF 19FE4100         mov edi,NgaMy.0041FE19</span><br><span class="line">00438B06    8BC7                mov eax,edi</span><br><span class="line">00438B08    5F                  pop edi</span><br><span class="line">00438B09    8B08                mov ecx,dword ptr ds:[eax]</span><br><span class="line">00438B0B    8F05 95FC4100       pop dword ptr ds:[41FC95]</span><br><span class="line">00438B11    8B05 95FC4100       mov eax,dword ptr ds:[41FC95]</span><br><span class="line">00438B17    53                  push ebx</span><br><span class="line">00438B18    90                  nop</span><br><span class="line">00438B19    90                  nop</span><br><span class="line">00438B1A    60                  pushad</span><br><span class="line">00438B1B    50                  push eax</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">8B 3C 24 8F 05 79 FD 41 00 89 35 25 FC 41 00 FF 35 25 FC 41 00 89 0C 24 8B 3C 24 8F 05 B9 FC 41</span><br><span class="line">00 8F 05 19 FE 41 00 89 05 89 FD 41 00 FF 35 89 FD 41 00 57 BF 19 FE 41 00 8B C7 5F 8B 08 8F 05</span><br><span class="line">95 FC 41 00 8B 05 95 FC 41 00 53</span><br><span class="line"></span><br><span class="line">13、hr 0012ff20，F9</span><br><span class="line"></span><br><span class="line">004393FF    8F05 5DFE4100       pop dword ptr ds:[41FE5D]                       ; 0012FF40</span><br><span class="line">00439405    FF35 5DFE4100       push dword ptr ds:[41FE5D]</span><br><span class="line">0043940B    890C24              mov dword ptr ss:[esp],ecx</span><br><span class="line">0043940E    893D 91FE4100       mov dword ptr ds:[41FE91],edi</span><br><span class="line">00439414    FF35 91FE4100       push dword ptr ds:[41FE91]</span><br><span class="line">0043941A    8F05 81FC4100       pop dword ptr ds:[41FC81]</span><br><span class="line">00439420    891D 89FE4100       mov dword ptr ds:[41FE89],ebx</span><br><span class="line">00439426    FF35 89FE4100       push dword ptr ds:[41FE89]</span><br><span class="line">0043942C    68 81FC4100         push NgaMy.0041FC81</span><br><span class="line">00439431    5B                  pop ebx</span><br><span class="line">00439432    8B0B                mov ecx,dword ptr ds:[ebx]</span><br><span class="line">00439434    8F05 C9FC4100       pop dword ptr ds:[41FCC9]</span><br><span class="line">0043943A    8B1D C9FC4100       mov ebx,dword ptr ds:[41FCC9]</span><br><span class="line">00439440    57                  push edi</span><br><span class="line">00439441    890424              mov dword ptr ss:[esp],eax</span><br><span class="line">00439444    890C24              mov dword ptr ss:[esp],ecx</span><br><span class="line">00439447    8B0424              mov eax,dword ptr ss:[esp]</span><br><span class="line">0043944A    90                  nop</span><br><span class="line">0043944B    90                  nop</span><br><span class="line">0043944C    60                  pushad</span><br><span class="line">0043944D    76 03               jbe short NgaMy.00439452</span><br><span class="line"></span><br><span class="line">8F 05 5D FE 41 00 FF 35 5D FE 41 00 89 0C 24 89 3D 91 FE 41 00 FF 35 91 FE 41 00 8F 05 81 FC 41</span><br><span class="line">00 89 1D 89 FE 41 00 FF 35 89 FE 41 00 68 81 FC 41 00 5B 8B 0B 8F 05 C9 FC 41 00 8B 1D C9 FC 41</span><br><span class="line">00 57 89 04 24 89 0C 24 8B 04 24</span><br><span class="line"></span><br><span class="line">14、hr 0012ff1c，F9</span><br><span class="line"></span><br><span class="line">00439D39    8F05 D5FD4100       pop dword ptr ds:[41FDD5]                       ; ntdll.KiFastSystemCallRet</span><br><span class="line">00439D3F    8B0C24              mov ecx,dword ptr ss:[esp]</span><br><span class="line">00439D42    8F05 4DFC4100       pop dword ptr ds:[41FC4D]</span><br><span class="line">00439D48    50                  push eax</span><br><span class="line">00439D49    891424              mov dword ptr ss:[esp],edx</span><br><span class="line">00439D4C    8F05 BDFE4100       pop dword ptr ds:[41FEBD]</span><br><span class="line">00439D52    FF35 BDFE4100       push dword ptr ds:[41FEBD]</span><br><span class="line">00439D58    51                  push ecx</span><br><span class="line">00439D59    B9 DDFD4100         mov ecx,NgaMy.0041FDDD</span><br><span class="line">00439D5E    8939                mov dword ptr ds:[ecx],edi</span><br><span class="line">00439D60    59                  pop ecx</span><br><span class="line">00439D61    FF35 DDFD4100       push dword ptr ds:[41FDDD]</span><br><span class="line">00439D67    C705 A9FE4100 60554&gt;mov dword ptr ds:[41FEA9],NgaMy.00405560</span><br><span class="line">00439D71    FF35 A9FE4100       push dword ptr ds:[41FEA9]</span><br><span class="line">00439D77    8B3C24              mov edi,dword ptr ss:[esp]</span><br><span class="line">00439D7A    8F05 95FD4100       pop dword ptr ds:[41FD95]</span><br><span class="line">00439D80    891D 29FD4100       mov dword ptr ds:[41FD29],ebx</span><br><span class="line">00439D86    90                  nop</span><br><span class="line">00439D87    90                  nop</span><br><span class="line">00439D88    60                  pushad</span><br><span class="line">00439D89    E8 01000000         call NgaMy.00439D8F</span><br><span class="line"></span><br><span class="line">8F 05 D5 FD 41 00 8B 0C 24 8F 05 4D FC 41 00 50 89 14 24 8F 05 BD FE 41 00 FF 35 BD FE 41 00 51</span><br><span class="line">B9 DD FD 41 00 89 39 59 FF 35 DD FD 41 00 C7 05 A9 FE 41 00 60 55 40 00 FF 35 A9 FE 41 00 8B 3C</span><br><span class="line">24 8F 05 95 FD 41 00 89 1D 29 FD 41 00</span><br><span class="line"></span><br><span class="line">15、hr 0012ff1c，F9</span><br><span class="line"></span><br><span class="line">0043A6FB    FF35 29FD4100       push dword ptr ds:[41FD29]</span><br><span class="line">0043A701    8BDF                mov ebx,edi</span><br><span class="line">0043A703    8BD3                mov edx,ebx</span><br><span class="line">0043A705    5B                  pop ebx</span><br><span class="line">0043A706    8F05 E9FE4100       pop dword ptr ds:[41FEE9]</span><br><span class="line">0043A70C    8B3D E9FE4100       mov edi,dword ptr ds:[41FEE9]</span><br><span class="line">0043A712    52                  push edx</span><br><span class="line">0043A713    891C24              mov dword ptr ss:[esp],ebx</span><br><span class="line">0043A716    68 9DFE4100         push NgaMy.0041FE9D</span><br><span class="line">0043A71B    5B                  pop ebx</span><br><span class="line">0043A71C    8913                mov dword ptr ds:[ebx],edx</span><br><span class="line">0043A71E    8B1C24              mov ebx,dword ptr ss:[esp]</span><br><span class="line">0043A721    8F05 49FE4100       pop dword ptr ds:[41FE49]</span><br><span class="line">0043A727    8B1424              mov edx,dword ptr ss:[esp]</span><br><span class="line">0043A72A    8F05 69FD4100       pop dword ptr ds:[41FD69]</span><br><span class="line">0043A730    FF15 9DFE4100       call dword ptr ds:[41FE9D]</span><br><span class="line">0043A736    8965 E8             mov dword ptr ss:[ebp-18],esp</span><br><span class="line">0043A739    8925 C5FD4100       mov dword ptr ds:[41FDC5],esp</span><br><span class="line">0043A73F    891D 21FD4100       mov dword ptr ds:[41FD21],ebx</span><br><span class="line">0043A745    FF35 21FD4100       push dword ptr ds:[41FD21]</span><br><span class="line">0043A74B    60                  pushad</span><br><span class="line">0043A74C    74 03               je short NgaMy.0043A751</span><br><span class="line"></span><br><span class="line">FF 35 29 FD 41 00 8B DF 8B D3 5B 8F 05 E9 FE 41 00 8B 3D E9 FE 41 00 52 89 1C 24 68 9D FE 41 00</span><br><span class="line">5B 89 13 8B 1C 24 8F 05 49 FE 41 00 8B 14 24 8F 05 69 FD 41 00 FF 15 9D FE 41 00 89 65 E8 89 25</span><br><span class="line">C5 FD 41 00 89 1D 21 FD 41 00 FF 35 21 FD 41 00</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">16、hr 0012fe8c，F9</span><br><span class="line"></span><br><span class="line">0043B097    68 C5FD4100         push NgaMy.0041FDC5</span><br><span class="line">0043B09C    5B                  pop ebx</span><br><span class="line">0043B09D    8B33                mov esi,dword ptr ds:[ebx]</span><br><span class="line">0043B09F    8B1C24              mov ebx,dword ptr ss:[esp]</span><br><span class="line">0043B0A2    8F05 A9FC4100       pop dword ptr ds:[41FCA9]</span><br><span class="line">0043B0A8    893E                mov dword ptr ds:[esi],edi</span><br><span class="line">0043B0AA    57                  push edi</span><br><span class="line">0043B0AB    8F05 F5FE4100       pop dword ptr ds:[41FEF5]</span><br><span class="line">0043B0B1    FF35 F5FE4100       push dword ptr ds:[41FEF5]</span><br><span class="line">0043B0B7    893424              mov dword ptr ss:[esp],esi</span><br><span class="line">0043B0BA    FF15 BCA04000       call dword ptr ds:[40A0BC]                      ; NgaMy.0041F23F</span><br><span class="line">0043B0C0    8B4E 10             mov ecx,dword ptr ds:[esi+10]</span><br><span class="line">0043B0C3    50                  push eax</span><br><span class="line">0043B0C4    B8 F9FB4100         mov eax,NgaMy.0041FBF9</span><br><span class="line">0043B0C9    8910                mov dword ptr ds:[eax],edx</span><br><span class="line">0043B0CB    58                  pop eax</span><br><span class="line">0043B0CC    FF35 F9FB4100       push dword ptr ds:[41FBF9]</span><br><span class="line">0043B0D2    56                  push esi</span><br><span class="line">0043B0D3    C70424 ACDE4000     mov dword ptr ss:[esp],NgaMy.0040DEAC</span><br><span class="line">0043B0DA    8B1424              mov edx,dword ptr ss:[esp]</span><br><span class="line">0043B0DD    8F05 ADFD4100       pop dword ptr ds:[41FDAD]</span><br><span class="line">0043B0E3    890A                mov dword ptr ds:[edx],ecx</span><br><span class="line">0043B0E5    90                  nop</span><br><span class="line">0043B0E6    90                  nop</span><br><span class="line">0043B0E7    60                  pushad</span><br><span class="line">0043B0E8    E8 01000000         call NgaMy.0043B0EE</span><br><span class="line"></span><br><span class="line">68 C5 FD 41 00 5B 8B 33 8B 1C 24 8F 05 A9 FC 41 00 89 3E 57 8F 05 F5 FE 41 00 FF 35 F5 FE 41 00</span><br><span class="line">89 34 24 FF 15 BC A0 40 00 8B 4E 10 50 B8 F9 FB 41 00 89 10 58 FF 35 F9 FB 41 00 56 C7 04 24 AC</span><br><span class="line">DE 40 00 8B 14 24 8F 05 AD FD 41 00 89 0A</span><br><span class="line"></span><br><span class="line">17、hr 0012fe8c，F9</span><br><span class="line"></span><br><span class="line">0043B9DA    8F05 29FE4100       pop dword ptr ds:[41FE29]                       ; 7FFB0000</span><br><span class="line">0043B9E0    FF35 29FE4100       push dword ptr ds:[41FE29]</span><br><span class="line">0043B9E6    5A                  pop edx</span><br><span class="line">0043B9E7    8B46 04             mov eax,dword ptr ds:[esi+4]</span><br><span class="line">0043B9EA    A3 B8DE4000         mov dword ptr ds:[40DEB8],eax</span><br><span class="line">0043B9EF    8B56 08             mov edx,dword ptr ds:[esi+8]</span><br><span class="line">0043B9F2    52                  push edx</span><br><span class="line">0043B9F3    8F05 3DFD4100       pop dword ptr ds:[41FD3D]</span><br><span class="line">0043B9F9    FF35 3DFD4100       push dword ptr ds:[41FD3D]</span><br><span class="line">0043B9FF    8F05 BCDE4000       pop dword ptr ds:[40DEBC]</span><br><span class="line">0043BA05    8B76 0C             mov esi,dword ptr ds:[esi+C]</span><br><span class="line">0043BA08    81E6 FF7F0000       and esi,7FFF</span><br><span class="line">0043BA0E    53                  push ebx</span><br><span class="line">0043BA0F    BB 35FE4100         mov ebx,NgaMy.0041FE35</span><br><span class="line">0043BA14    8933                mov dword ptr ds:[ebx],esi</span><br><span class="line">0043BA16    5B                  pop ebx</span><br><span class="line">0043BA17    FF35 35FE4100       push dword ptr ds:[41FE35]</span><br><span class="line">0043BA1D    8F05 B0DE4000       pop dword ptr ds:[40DEB0]</span><br><span class="line">0043BA23    90                  nop</span><br><span class="line">0043BA24    90                  nop</span><br><span class="line">0043BA25    60                  pushad</span><br><span class="line">0043BA26    E8 01000000         call NgaMy.0043BA2C</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">8F 05 29 FE 41 00 FF 35 29 FE 41 00 5A 8B 46 04 A3 B8 DE 40 00 8B 56 08 52 8F 05 3D FD 41 00 FF</span><br><span class="line">35 3D FD 41 00 8F 05 BC DE 40 00 8B 76 0C 81 E6 FF 7F 00 00 53 BB 35 FE 41 00 89 33 5B FF 35 35</span><br><span class="line">FE 41 00 8F 05 B0 DE 40 00</span><br><span class="line"></span><br><span class="line">18、hr 0012fe90，F9</span><br><span class="line"></span><br><span class="line">0043BE77   /EB 01               jmp short NgaMy.0043BE7A  //F8</span><br><span class="line">0043BE79   |E8 FF25BCBE         call BEFFE47D</span><br><span class="line">0043BE7E    43                  inc ebx</span><br><span class="line">0043BE7F    0060 E8             add byte ptr ds:[eax-18],ah</span><br><span class="line">0043BE82    0000                add byte ptr ds:[eax],al</span><br><span class="line">0043BE84    0000                add byte ptr ds:[eax],al</span><br><span class="line">0043BE86    5E                  pop esi</span><br><span class="line">0043BE87    83EE 06             sub esi,6</span><br><span class="line">0043BE8A    B9 66000000         mov ecx,66</span><br><span class="line">0043BE8F    29CE                sub esi,ecx</span><br><span class="line">0043BE91    BA 8A261D6A         mov edx,6A1D268A</span><br><span class="line">0043BE96    C1E9 02             shr ecx,2</span><br><span class="line">0043BE99    83E9 02             sub ecx,2</span><br><span class="line">0043BE9C    83F9 00             cmp ecx,0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0043BE7A  - FF25 BCBE4300       jmp dword ptr ds:[43BEBC]                       ; NgaMy.0040305C //跳到OEP</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">19、把所有的代码汇总一下：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89 15 F5 FD 41 00 FF 35 F5 FD 41 00 8F 05 2D FE 41 00 FF 35 2D FE 41 00 C7 04 24 60 00 00 00 56</span><br><span class="line">89 0C 24 68 8D FD 41 00 59 89 19 8B 0C 24 8F 05 AD FE 41 00 FF 35 8D FD 41 00 C7 04 24 48 A2 40</span><br><span class="line">00 89 05 B9 FD 41 00 FF 35 B9 FD 41 00 68 1D FD 41 00 58 89 30 8F 05 79 FC 41 00 8B 05 79 FC 41 </span><br><span class="line">00 FF 35 1D FD 41 00 56 89 1C 24 C7 04 24 38 3D 40 00 8B 34 24 8F 05 A5 FE 41 00 89 05 01 FF 41 </span><br><span class="line">00 FF 35 01 FF 41 00 89 1C 24 56 C7 04 24 45 FE 41 00 8F 05 31 FE 41 00 8B 1D 31 FE 41 00 89 33 </span><br><span class="line">8F 05 39 FC 41 00 FF 35 39 FC 41 00 5B 8F 05 09 FE 41 00 89 1D 21 FC 41 00 FF 35 21 FC 41 00 C7 </span><br><span class="line">05 19 FC 41 00 09 FE 41 00 8B 1D 19 FC 41 00 8B 33 8F 05 FD FB 41 00 8B 1D FD FB 41 00 FF 15 45 </span><br><span class="line">FE 41 00 89 0D B1 FD 41 00 FF 35 B1 FD 41 00 8F 05 B5 FC 41 00 FF 35 B5 FC 41 00 56 BE FD FC 41 </span><br><span class="line">00 89 3E 5E FF 35 FD FC 41 00 68 94 00 00 00 8F 05 E5 FC 41 00 FF 35 E5 FC 41 00 5F 89 3D 3D FE </span><br><span class="line">41 00 FF 35 3D FE 41 00 8B 0C 24 8F 05 7D FE 41 00 8B 3C 24 8F 05 79 FD 41 00 89 35 25 FC 41 00 </span><br><span class="line">FF 35 25 FC 41 00 89 0C 24 8B 3C 24 8F 05 B9 FC 41 00 8F 05 19 FE 41 00 89 05 89 FD 41 00 FF 35 </span><br><span class="line">89 FD 41 00 57 BF 19 FE 41 00 8B C7 5F 8B 08 8F 05 95 FC 41 00 8B 05 95 FC 41 00 53 8F 05 5D FE </span><br><span class="line">41 00 FF 35 5D FE 41 00 89 0C 24 89 3D 91 FE 41 00 FF 35 91 FE 41 00 8F 05 81 FC 41 00 89 1D 89 </span><br><span class="line">FE 41 00 FF 35 89 FE 41 00 68 81 FC 41 00 5B 8B 0B 8F 05 C9 FC 41 00 8B 1D C9 FC 41 00 57 89 04 </span><br><span class="line">24 89 0C 24 8B 04 24 8F 05 D5 FD 41 00 8B 0C 24 8F 05 4D FC 41 00 50 89 14 24 8F 05 BD FE 41 00 </span><br><span class="line">FF 35 BD FE 41 00 51 B9 DD FD 41 00 89 39 59 FF 35 DD FD 41 00 C7 05 A9 FE 41 00 60 55 40 00 FF </span><br><span class="line">35 A9 FE 41 00 8B 3C 24 8F 05 95 FD 41 00 89 1D 29 FD 41 00 FF 35 29 FD 41 00 8B DF 8B D3 5B 8F </span><br><span class="line">05 E9 FE 41 00 8B 3D E9 FE 41 00 52 89 1C 24 68 9D FE 41 00 5B 89 13 8B 1C 24 8F 05 49 FE 41 00 </span><br><span class="line">8B 14 24 8F 05 69 FD 41 00 FF 15 9D FE 41 00 89 65 E8 89 25 C5 FD 41 00 89 1D 21 FD 41 00 FF 35 </span><br><span class="line">21 FD 41 00 68 C5 FD 41 00 5B 8B 33 8B 1C 24 8F 05 A9 FC 41 00 89 3E 57 8F 05 F5 FE 41 00 FF 35 </span><br><span class="line">F5 FE 41 00 89 34 24 FF 15 BC A0 40 00 8B 4E 10 50 B8 F9 FB 41 00 89 10 58 FF 35 F9 FB 41 00 56 </span><br><span class="line">C7 04 24 AC DE 40 00 8B 14 24 8F 05 AD FD 41 00 89 0A 8F 05 29 FE 41 00 FF 35 29 FE 41 00 5A 8B </span><br><span class="line">46 04 A3 B8 DE 40 00 8B 56 08 52 8F 05 3D FD 41 00 FF 35 3D FD 41 00 8F 05 BC DE 40 00 8B 76 0C </span><br><span class="line">81 E6 FF 7F 00 00 53 BB 35 FE 41 00 89 33 5B FF 35 35 FE 41 00 8F 05 B0 DE 40 00</span><br><span class="line"></span><br><span class="line">20、用工具申请一个新的区段</span><br><span class="line"></span><br><span class="line">记下起始的地址：0043E000</span><br><span class="line"></span><br><span class="line">21、OD打开创建完后的。找到0043E000，粘贴入代码，保存</span><br><span class="line"></span><br><span class="line">记住，后面得加跳向假OEP的代码！！</span><br><span class="line"></span><br><span class="line">JMP 0040305C </span><br><span class="line"></span><br><span class="line">22、修正入口点</span><br></pre></td></tr></table></figure>
<h2 id="asprotect-1212c"><a class="markdownIt-Anchor" href="#asprotect-1212c">#</a> ASProtect 1.2/1.2C</h2>
<h3 id="最后一次异常-2"><a class="markdownIt-Anchor" href="#最后一次异常-2">#</a> 最后一次异常</h3>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203357806.png" alt="image-20230823203357806"></p>
<p>到最后一次异常之后，在下一个 ret 下段，执行到下段的地方</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203409091.png" alt="image-20230823203409091"></p>
<p>在 401000 下段</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203440885.png" alt="image-20230823203440885"></p>
<p>运行来到 oep</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203451370.png" alt="image-20230823203451370"></p>
<h2 id="asprotect-123"><a class="markdownIt-Anchor" href="#asprotect-123">#</a> ASProtect 1.23</h2>
<p>忽略除内存访问以外的断点</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203502855.png" alt="image-20230823203502855"></p>
<p>找到最后一次异常</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203515794.png" alt="image-20230823203515794"></p>
<p>运行到 ret</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203526429.png" alt="image-20230823203526429"></p>
<p>401000 下段</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203537369.png" alt="image-20230823203537369"></p>
<p>到 oep</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203547637.png" alt="image-20230823203547637"></p>
<p>或者运行到 retn 之后：</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203604011.png" alt="image-20230823203604011"></p>
<p>hr 12ffa4   执行，到 oep</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203624615.png" alt="image-20230823203624615"></p>
<h3 id="使用工具修复"><a class="markdownIt-Anchor" href="#使用工具修复">#</a> 使用工具修复</h3>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203636722.png" alt="image-20230823203636722"></p>
<p>运行，程序会在可能的 oep 暂停，这时在采用 rec 修复</p>
<h2 id="asprotect-123-rc4"><a class="markdownIt-Anchor" href="#asprotect-123-rc4">#</a> ASProtect 1.23 rc4</h2>
<p>插件查壳</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203650794.png" alt="image-20230823203650794"></p>
<p>版本的判断：</p>
<p>判断版本：</p>
<p>ASProtect 1.23 RC4 按 shift+f9 键 26 次后来到典型异常，在最近处的 retn 处设断，跳过异常，f8 步跟就会来到 foep。</p>
<p>ASProtect 1.31 04.27 按 shift+f9 键 36 次后来到典型异常，在最近处的 retn 处设断，跳过异常，f8 步跟就会来到 foep。</p>
<p>ASProtect 1.31 05.18 按 shift+f9 键 40 次后来到典型异常，在最近处的 retn 处设断，跳过异常，f8 步跟就会来到 foep。</p>
<p>ASProtect 1.31 06.14 按 shift+f9 键 38 次后来到典型异常，在最近处的 retn 处设断，跳过异常，f8 步跟就会来到 foep。</p>
<p>1、忽略除内存访问的所有异常，隐藏一下 OD，SHIFT+F9 26 次后来到最后一次异常</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203707216.png" alt="image-20230823203707216"></p>
<p>00C739EC    3100                xor dword ptr ds:[eax],eax        // 断在这</p>
<p>00C739EE    64:8F05 00000000    pop dword ptr fs:[0]</p>
<p>00C739F5    58                  pop eax</p>
<p>00C739F6    833D B07EC700 00    cmp dword ptr ds:[C77EB0],0</p>
<p>00C739FD    74 14               je short 00C73A13</p>
<p>00C739FF    6A 0C               push 0C</p>
<p>00C73A01    B9 B07EC700         mov ecx,0C77EB0</p>
<p>00C73A06    8D45 F8             lea eax,dword ptr ss:[ebp-8]</p>
<p>00C73A09    BA 04000000         mov edx,4</p>
<p>00C73A0E    E8 2DD1FFFF         call 00C70B40</p>
<p>00C73A13    FF75 FC             push dword ptr ss:[ebp-4]</p>
<p>00C73A16    FF75 F8             push dword ptr ss:[ebp-8]</p>
<p>00C73A19    8B45 F4             mov eax,dword ptr ss:[ebp-C]</p>
<p>00C73A1C    8338 00             cmp dword ptr ds:[eax],0</p>
<p>00C73A1F    74 02               je short 00C73A23</p>
<p>00C73A21    FF30                push dword ptr ds:[eax]</p>
<p>00C73A23    FF75 F0             push dword ptr ss:[ebp-10]</p>
<p>00C73A26    FF75 EC             push dword ptr ss:[ebp-14]</p>
<p>00C73A29    C3                  retn</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203719637.png" alt="image-20230823203719637"></p>
<p>2、在 RETN 处下断，SHIFT+F9，取消断点</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203733449.png" alt="image-20230823203733449"></p>
<p>3、在堆栈窗口找显示程序名的下面 2 行，下 HR 12FFA4</p>
<p>4、一直 F8，到这里</p>
<p>00C85C47    BD 4D5CC800         mov ebp,0C85C4D</p>
<p>00C85C4C    FF55 03             call dword ptr ss:[ebp+3]          // 到这 F7 跟</p>
<p>00C85C4F    E8 595CC800         call 0190B8AD</p>
<p>00C85C54    9A E969F29A 5DF3    call far F35D:9AF269E9</p>
<p>00C85C5B    EB 02               jmp short 00C85C5F</p>
<p>00C85C5D    CD20 1BE9EB02       vxdjump 2EBE91B</p>
<p>00C85C63    CD20 33E8EB02       vxdjump 2EBE833</p>
<p>00C85C69    CD20 EB010F8D       vxdcall 8D0F01EB</p>
<p>00C85C6F    6C                  ins byte ptr es:[edi],dx</p>
<p>00C85C70    75 37               jnz short 00C85CA9</p>
<p>00C85C72    5D                  pop ebp</p>
<p>00C85C73    EB 01               jmp short 00C85C76</p>
<p>00C85C75    C7                  ???                                     ; 未知命令</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203745294.png" alt="image-20230823203745294"></p>
<p>5、一直 F7 跟，找抽取代码</p>
<p>(1)</p>
<p>00C84F0A    55                  push ebp</p>
<p>00C84F0B    8BEC                mov ebp,esp</p>
<p>00C84F0D    6A FF               push -1</p>
<p>00C84F0F    68 78E35300         push 53E378</p>
<p>00C84F14    68 407B4F00         push 4F7B40</p>
<p>00C84F19    64:A1 00000000      mov eax,dword ptr fs:[0]</p>
<p>55 8B EC 6A FF 68 78 E3 53 00 68 40 7B 4F 00 64 A1 00 00 00 00</p>
<p>(2)</p>
<p>00C84F22    50                  push eax</p>
<p>00C84F23    64:8925 00000000    mov dword ptr fs:[0],esp</p>
<p>00C84F2A    83EC 58             sub esp,58</p>
<p>50 64 89 25 00 00 00 00 83 EC 58</p>
<p>(3)</p>
<p>00C84F30    53                  push ebx</p>
<p>53</p>
<p>(4)</p>
<p>00C84F34    56                  push esi</p>
<p>56</p>
<p>(5)</p>
<p>00C84F38    57                  push edi</p>
<p>00C84F39    8965 E8             mov dword ptr ss:[ebp-18],esp</p>
<p>57 89 65 E8</p>
<p>6、把代码汇总一下</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203758265.png" alt="image-20230823203758265"></p>
<p>55 8B EC 6A FF 68 78 E3 53 00 68 40 7B 4F 00 64 A1 00 00 00 00 50 64 89 25 00 00 00 00 83 EC 58 53 56 57 89 65 E8</p>
<p>7、继续 F7，来到这，就 F8</p>
<p>00C85B74    51                  push ecx</p>
<p>00C85B75    57                  push edi</p>
<p>00C85B76    9C                  pushfd</p>
<p>00C85B77    FC                  cld</p>
<p>00C85B78    BF B55BC800         mov edi,0C85BB5</p>
<p>00C85B7D    B9 5E140000         mov ecx,145E</p>
<p>00C85B82    F3:AA               rep stos byte ptr es:[edi]</p>
<p>00C85B84    9D                  popfd</p>
<p>00C85B85    5F                  pop edi</p>
<p>00C85B86    59                  pop ecx</p>
<p>00C85B87    C3                  retn</p>
<p>8、一直 F8 到这里，然后向上看</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203808712.png" alt="image-20230823203808712"></p>
<p>004F27CF    FF15 9CC25200       call dword ptr ds:[52C29C]</p>
<p>004F27D5    33D2                xor edx,edx</p>
<p>004F27D7    8AD4                mov dl,ah</p>
<p>004F27D9    8915 34306900       mov dword ptr ds:[693034],edx</p>
<p>004F27DF    8BC8                mov ecx,eax</p>
<p>004F27E1    81E1 FF000000       and ecx,0FF</p>
<p>004F27E7    890D 30306900       mov dword ptr ds:[693030],ecx</p>
<p>004F27ED    C1E1 08             shl ecx,8</p>
<p>004F27F0    03CA                add ecx,edx</p>
<p>004F27F2    890D 2C306900       mov dword ptr ds:[69302C],ecx</p>
<p>004F27F8    C1E8 10             shr eax,10</p>
<p>004F27FB    A3 28306900         mov dword ptr ds:[693028],eax</p>
<p>004F2800    6A 01               push 1</p>
<p>004F2802    E8 933B0000         call SoWorker.004F639A</p>
<p>9、</p>
<p>004F27A4    C3                  retn</p>
<p>004F27A5    33C0                xor eax,eax</p>
<p>004F27A7  ^ EB F8               jmp short SoWorker.004F27A1</p>
<p>004F27A9    0000                add byte ptr ds:[eax],al                // 这里就是真正的 OEP 了</p>
<p>004F27AB    0000                add byte ptr ds:[eax],al</p>
<p>004F27AD    0000                add byte ptr ds:[eax],al</p>
<p>004F27AF    0000                add byte ptr ds:[eax],al</p>
<p>004F27B1    0000                add byte ptr ds:[eax],al</p>
<p>004F27B3    0000                add byte ptr ds:[eax],al</p>
<p>004F27B5    0000                add byte ptr ds:[eax],al</p>
<p>004F27B7    0000                add byte ptr ds:[eax],al</p>
<p>004F27B9    0000                add byte ptr ds:[eax],al</p>
<p>004F27BB    0000                add byte ptr ds:[eax],al</p>
<p>004F27BD    0000                add byte ptr ds:[eax],al</p>
<p>004F27BF    0000                add byte ptr ds:[eax],al</p>
<p>004F27C1    0000                add byte ptr ds:[eax],al</p>
<p>004F27C3    0000                add byte ptr ds:[eax],al</p>
<p>004F27C5    0000                add byte ptr ds:[eax],al</p>
<p>004F27C7    0000                add byte ptr ds:[eax],al</p>
<p>004F27C9    0000                add byte ptr ds:[eax],al</p>
<p>004F27CB    0000                add byte ptr ds:[eax],al</p>
<p>004F27CD    0000                add byte ptr ds:[eax],al</p>
<p>004F27CF    FF15 9CC25200       call dword ptr ds:[52C29C]</p>
<p>004F27D5    33D2                xor edx,edx</p>
<p>10、补上代码，脱壳，修复</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203826479.png" alt="image-20230823203826479"></p>
<p>先用等级 1，再用插件，都修不了直接删除。</p>
<p>转存后的修不了用远程程序修</p>
<p>或者使用 401000 下段也可以，但是还需要手动跟</p>
<h2 id="asprotect-加壳-区段"><a class="markdownIt-Anchor" href="#asprotect-加壳-区段">#</a> ASProtect 加壳 区段</h2>
<p>如果壳中存在校验，会出现大问题</p>
<p>1、忽略除内存访问外的所有异常，SHIFT+F9，来到最后一次异常</p>
<p>2、来到最近的 RETN</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203836382.png" alt="image-20230823203836382"></p>
<p>3、打开内存镜像，在 00401000 处下断，SHIFT+F9，到达假 OEP，记下</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203851980.png" alt="image-20230823203851980"></p>
<p>004F27CF     FF15 9CC25200       call dword ptr ds:[52C29C]</p>
<p>004F27D5     33D2                xor edx,edx</p>
<p>004F27D7     8AD4                mov dl,ah</p>
<p>004F27D9     8915 34306900       mov dword ptr ds:[693034],edx</p>
<p>004F27DF     8BC8                mov ecx,eax</p>
<p>004F27E1     81E1 FF000000       and ecx,0FF</p>
<p>004F27E7     890D 30306900       mov dword ptr ds:[693030],ecx</p>
<p>004F27ED     C1E1 08             shl ecx,8</p>
<p>004F27F0     03CA                add ecx,edx</p>
<p>004F27F2     890D 2C306900       mov dword ptr ds:[69302C],ecx</p>
<p>004F27F8     C1E8 10             shr eax,10</p>
<p>004F27FB     A3 28306900         mov dword ptr ds:[693028],eax</p>
<p>004F2800     6A 01               push 1</p>
<p>004F2802     E8 933B0000         call SoWorker.004F639A</p>
<p>004F2807     59                  pop ecx</p>
<p>004F2808     85C0                test eax,eax</p>
<p>004F280A     75 08               jnz short SoWorker.004F2814</p>
<p>4、重新来，重复上面 1 和 2 步，下 hr 0012ff68，SHIFT+F9，取消断点，F8，来到最佳的以壳解壳地方</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203912073.png" alt="image-20230823203912073"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203923850.png" alt="image-20230823203923850"></p>
<p>00C85793     BB A2000000         mov ebx,0A2  // 最佳地</p>
<p>00C85798     0BDB                or ebx,ebx</p>
<p>00C8579A     75 07               jnz short 00C857A3</p>
<p>00C8579C     894424 1C           mov dword ptr ss:[esp+1C],eax</p>
<p>00C857A0     61                  popad</p>
<p>00C857A1     50                  push eax</p>
<p>00C857A2     C3                  retn</p>
<p>00C857A3     E8 00000000         call 00C857A8</p>
<p>00C857A8     5D                  pop ebp</p>
<p>00C857A9     81ED 4DE14B00       sub ebp,4BE14D</p>
<p>5、完整转存，区域转存</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203941909.png" alt="image-20230823203941909"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823203959096.png" alt="image-20230823203959096"></p>
<p>选择区段，在最后一个区段选择从磁盘载入刚刚部分转存的区段</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823204011420.png" alt="image-20230823204011420"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823204023782.png" alt="image-20230823204023782"></p>
<p>保存</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823204034685.png" alt="image-20230823204034685"></p>
<p>重建 pe</p>
<p>6、修复</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230823204045107.png" alt="image-20230823204045107"></p>
<p>修改 oep 为 885793</p>

  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2023-08-23 20:41:55" itemprop="dateModified" datetime="2023-08-23T20:41:55+08:00">2023-08-23</time>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> Donate</button>
  <p>Give me a cup of [coffee]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="John Doe WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="John Doe Alipay">
        <p>Alipay</p>
      </div>
      
      <div>
        <img data-src="/images/paypal.png" alt="John Doe PayPal">
        <p>PayPal</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>Post author:  </strong>John Doe <i class="ic i-at"><em>@</em></i>Hexo
  </li>
  <li class="link">
    <strong>Post link: </strong>
    <a href="http://example.com/2023/08/15/%E7%A0%B4%E8%A7%A3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B9%8B%E8%AE%A4%E8%AF%86%E5%A3%B3%E4%B8%8E%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%89%B9%E5%BE%81/" title="破解基础知识之认识壳与程序的特征">http://example.com/2023/08/15/破解基础知识之认识壳与程序的特征/</a>
  </li>
  <li class="license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2023/08/02/Capabilities/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipet4bz0yj20zk0m8e81.jpg" title="docker底层原理+capability">
  <span class="type">Previous Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>docker底层原理+capability</h3>
  </a>

    </div>
    <div class="item right">
    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A0%B4%E8%A7%A3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B9%8B%E8%AE%A4%E8%AF%86%E5%A3%B3%E4%B8%8E%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%89%B9%E5%BE%81"><span class="toc-number">1.</span> <span class="toc-text"> 破解基础知识之认识壳与程序的特征</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#vc60"><span class="toc-number">1.1.</span> <span class="toc-text"> vc6.0</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#vc"><span class="toc-number">1.1.1.</span> <span class="toc-text"> VC++</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vc-7"><span class="toc-number">1.1.2.</span> <span class="toc-text"> VC 7</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vs-2008-vs2013"><span class="toc-number">1.2.</span> <span class="toc-text"> VS 2008 &amp; VS2013</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%98%93%E8%AF%AD%E8%A8%80"><span class="toc-number">1.3.</span> <span class="toc-text"> 易语言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#delhpi"><span class="toc-number">1.4.</span> <span class="toc-text"> Delhpi</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#net"><span class="toc-number">1.5.</span> <span class="toc-text"> .NET</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#asm"><span class="toc-number">1.6.</span> <span class="toc-text"> ASM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bc-60"><span class="toc-number">1.7.</span> <span class="toc-text"> BC++ 6.0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vb"><span class="toc-number">1.8.</span> <span class="toc-text"> VB</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%84%E7%A7%8D%E8%BD%AF%E4%BB%B6%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.9.</span> <span class="toc-text"> 各种软件优缺点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#upx"><span class="toc-number">1.10.</span> <span class="toc-text"> upx</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%AD%A5%E8%B7%9F%E8%B8%AA"><span class="toc-number">1.10.1.</span> <span class="toc-text"> 单步跟踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#esp"><span class="toc-number">1.10.2.</span> <span class="toc-text"> ESP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E6%AC%A1%E5%86%85%E5%AD%98%E9%95%9C%E5%83%8F"><span class="toc-number">1.10.3.</span> <span class="toc-text"> 二次内存镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE"><span class="toc-number">1.10.4.</span> <span class="toc-text"> 查找</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#asp"><span class="toc-number">1.11.</span> <span class="toc-text"> ASP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E5%8D%95%E6%AD%A5%E8%B7%9F%E8%B8%AA"><span class="toc-number">1.11.1.</span> <span class="toc-text"> 1. 单步跟踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2esp"><span class="toc-number">1.11.2.</span> <span class="toc-text"> 2.ESP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E6%89%BEpopad"><span class="toc-number">1.11.3.</span> <span class="toc-text"> 查找 popad</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E9%95%9C%E5%83%8F"><span class="toc-number">1.11.4.</span> <span class="toc-text"> 内存镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E8%B7%9F%E8%B8%AA"><span class="toc-number">1.11.5.</span> <span class="toc-text"> 模拟跟踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sfx"><span class="toc-number">1.11.6.</span> <span class="toc-text"> SFX</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nsp"><span class="toc-number">1.12.</span> <span class="toc-text"> NSP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#esp-2"><span class="toc-number">1.12.1.</span> <span class="toc-text"> ESP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%AD%A5%E8%B7%9F%E8%B8%AA-2"><span class="toc-number">1.12.2.</span> <span class="toc-text"> 单步跟踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E8%B7%9F%E8%B8%AA-2"><span class="toc-number">1.12.3.</span> <span class="toc-text"> 模拟跟踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E6%AC%A1%E5%86%85%E5%AD%98%E9%95%9C%E5%83%8F"><span class="toc-number">1.12.4.</span> <span class="toc-text"> 两次内存镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E6%96%B9%E6%B3%95"><span class="toc-number">1.12.5.</span> <span class="toc-text"> 特殊方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fsg"><span class="toc-number">1.13.</span> <span class="toc-text"> FSG</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E5%A4%8D"><span class="toc-number">1.13.1.</span> <span class="toc-text"> 修复</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#esp-3"><span class="toc-number">1.13.2.</span> <span class="toc-text"> esp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E6%AE%8Aesp"><span class="toc-number">1.13.3.</span> <span class="toc-text"> 特殊 esp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pe-compact-2x"><span class="toc-number">1.14.</span> <span class="toc-text"> PE compact 2.x</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%AD%A5"><span class="toc-number">1.14.1.</span> <span class="toc-text"> 单步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#esp-4"><span class="toc-number">1.14.2.</span> <span class="toc-text"> esp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.14.3.</span> <span class="toc-text"> ？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-2"><span class="toc-number">1.14.4.</span> <span class="toc-text"> ？？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-3"><span class="toc-number">1.14.5.</span> <span class="toc-text"> ？？？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-4"><span class="toc-number">1.14.6.</span> <span class="toc-text"> ？？？？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8"><span class="toc-number">1.14.7.</span> <span class="toc-text"> 异常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E6%AC%A1%E5%86%85%E5%AD%98"><span class="toc-number">1.14.8.</span> <span class="toc-text"> 两次内存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#at-getversion"><span class="toc-number">1.14.9.</span> <span class="toc-text"> at getversion</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezip"><span class="toc-number">1.15.</span> <span class="toc-text"> ezip</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%AD%A5-2"><span class="toc-number">1.15.1.</span> <span class="toc-text"> 单步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#esp-5"><span class="toc-number">1.15.2.</span> <span class="toc-text"> esp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#telock-098b1"><span class="toc-number">1.16.</span> <span class="toc-text"> telock 0.98b1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%90%8E%E4%B8%80%E6%AC%A1%E5%BC%82%E5%B8%B8"><span class="toc-number">1.16.1.</span> <span class="toc-text"> 最后一次异常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E8%B7%9F%E8%B8%AA-3"><span class="toc-number">1.16.2.</span> <span class="toc-text"> 模拟跟踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E6%AC%A1%E5%86%85%E5%AD%98-2"><span class="toc-number">1.16.3.</span> <span class="toc-text"> 两次内存</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exe32"><span class="toc-number">1.17.</span> <span class="toc-text"> exe32</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#esp-6"><span class="toc-number">1.17.1.</span> <span class="toc-text"> esp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#isdeubggerpresent"><span class="toc-number">1.17.2.</span> <span class="toc-text"> IsDeubggerPresent</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#win"><span class="toc-number">1.18.</span> <span class="toc-text"> win</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%96%AD%E7%82%B9"><span class="toc-number">1.18.1.</span> <span class="toc-text"> 条件断点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%E5%8A%A0%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95"><span class="toc-number">1.19.</span> <span class="toc-text"> 附加数据处理方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%BB%E9%99%A4%E8%87%AA%E6%A0%A1%E9%AA%8C"><span class="toc-number">1.20.</span> <span class="toc-text"> 去除自校验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%84%B1%E5%A3%B3%E7%AE%80%E5%8D%95%E5%BA%94%E7%94%A8-%E6%B1%89%E5%8C%96-diy"><span class="toc-number">1.21.</span> <span class="toc-text"> 脱壳简单应用 - 汉化 - diy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#asp%E5%8F%98%E5%BD%A2%E5%A3%B3"><span class="toc-number">1.22.</span> <span class="toc-text"> ASP 变形壳</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%AD%A5-3"><span class="toc-number">1.22.1.</span> <span class="toc-text"> 单步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%84%B1asp%E5%8F%98%E5%BD%A2%E5%A3%B301%E6%B1%89%E5%8C%96%E7%89%88"><span class="toc-number">1.22.2.</span> <span class="toc-text"> 脱 ASP 变形壳 0.1 汉化版</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E8%84%B1%E5%A3%B3"><span class="toc-number">1.23.</span> <span class="toc-text"> 脚本脱壳</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#acprotect"><span class="toc-number">1.24.</span> <span class="toc-text"> ACProtect</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#acprotect-stolen"><span class="toc-number">1.25.</span> <span class="toc-text"> ACProtect （stolen）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BB%E6%89%BE%E4%BF%AE%E9%A5%B0%E7%9A%84stolen-code"><span class="toc-number">1.26.</span> <span class="toc-text"> 寻找修饰的 stolen code</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#acprotect-2x"><span class="toc-number">1.27.</span> <span class="toc-text"> ACProtect 2.x</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#-5"><span class="toc-number">1.27.1.</span> <span class="toc-text"> </span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E7%9A%84acprotect"><span class="toc-number">1.28.</span> <span class="toc-text"> 特殊的 ACProtect</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#anti-protect"><span class="toc-number">1.29.</span> <span class="toc-text"> anti protect</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#asprotect-1212c"><span class="toc-number">1.30.</span> <span class="toc-text"> ASProtect 1.2&#x2F;1.2C</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%90%8E%E4%B8%80%E6%AC%A1%E5%BC%82%E5%B8%B8-2"><span class="toc-number">1.30.1.</span> <span class="toc-text"> 最后一次异常</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#asprotect-123"><span class="toc-number">1.31.</span> <span class="toc-text"> ASProtect 1.23</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7%E4%BF%AE%E5%A4%8D"><span class="toc-number">1.31.1.</span> <span class="toc-text"> 使用工具修复</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#asprotect-123-rc4"><span class="toc-number">1.32.</span> <span class="toc-text"> ASProtect 1.23 rc4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#asprotect-%E5%8A%A0%E5%A3%B3-%E5%8C%BA%E6%AE%B5"><span class="toc-number">1.33.</span> <span class="toc-text"> ASProtect 加壳 区段</span></a></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="John Doe"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">John Doe</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">34</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">4</span>
        <span class="name">categories</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">4</span>
        <span class="name">tags</span>
      </a>
    </div>
</nav>

<div class="social">
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>Random Posts</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E9%80%86%E5%90%91/" title="In 逆向">逆向</a>
</div>

    <span><a href="/2023/01/03/%E6%BB%B4%E6%B0%B4reverse/" title="水滴rev">水滴rev</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2022/12/28/mysql/" title="Mysql">Mysql</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/web%E5%AE%89%E5%85%A8/" title="In web安全">web安全</a>
</div>

    <span><a href="/2022/05/27/CSRF/" title="CSRF">CSRF</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/web%E5%AE%89%E5%85%A8/" title="In web安全">web安全</a>
</div>

    <span><a href="/2022/11/17/JWT%20%E5%9F%BA%E7%A1%80/" title="JWT">JWT</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2022/02/28/XSS/" title="XSS">XSS</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E9%80%86%E5%90%91/" title="In 逆向">逆向</a>
</div>

    <span><a href="/2022/11/11/reverse/" title="逆向">逆向</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/08/15/%E7%A0%B4%E8%A7%A3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B9%8B%E8%AE%A4%E8%AF%86%E5%A3%B3%E4%B8%8E%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%89%B9%E5%BE%81/" title="破解基础知识之认识壳与程序的特征">破解基础知识之认识壳与程序的特征</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E9%80%86%E5%90%91/" title="In 逆向">逆向</a>
</div>

    <span><a href="/2022/11/01/%E6%B1%87%E7%BC%96/" title="汇编">汇编</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%86%85%E7%BD%91/" title="In 内网">内网</a>
</div>

    <span><a href="/2022/05/27/emergency%20response/" title="应急响应">应急响应</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E7%A7%8B%E6%8B%9B/" title="In 秋招">秋招</a>
</div>

    <span><a href="/2022/10/27/%E7%A7%8B%E6%8B%9B%E6%80%BB%E7%BB%93/" title="秋招总结">秋招总结</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>Recent Comments</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">John Doe @ Yume Shoka</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2023/08/15/破解基础知识之认识壳与程序的特征/',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,fancybox: true,
    copyright: 'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
