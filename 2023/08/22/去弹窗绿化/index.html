



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="Hexo" href="http://example.com/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="Hexo" href="http://example.com/atom.xml" />
<link rel="alternate" type="application/json" title="Hexo" href="http://example.com/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="逆向" />


<link rel="canonical" href="http://example.com/2023/08/22/%E5%8E%BB%E5%BC%B9%E7%AA%97%E7%BB%BF%E5%8C%96/">



  <title>
破解相关 - 逆向 |
Yume Shoka = Hexo</title>
<meta name="generator" content="Hexo 5.4.2"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">破解相关
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2023-08-22 13:38:45">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2023-08-22T13:38:45+08:00">2023-08-22</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Yume Shoka</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://img.timelessq.com/images/2022/07/26/666b3077b407f3c0ce9c10c00b861abe.jpg"></li>
          <li class="item" data-background-image="https://img.timelessq.com/images/2022/07/26/84ffd76b69056962d5e97a5fa075a9f4.jpg"></li>
          <li class="item" data-background-image="https://img.timelessq.com/images/2022/07/26/2a42af8906eaa0a898ee31569cbd2661.jpg"></li>
          <li class="item" data-background-image="https://img.timelessq.com/images/2022/07/26/2aaa20665dd5e5704a35cf4f6de766db.jpg"></li>
          <li class="item" data-background-image="https://img.timelessq.com/images/2022/07/26/a05ebdd3b7f197e626fa1253c6521ef5.jpg"></li>
          <li class="item" data-background-image="https://img.timelessq.com/images/2022/07/26/31105e606c74614c7f8f7b1d08e1619a.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span><i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E9%80%86%E5%90%91/" itemprop="item" rel="index" title="In 逆向"><span itemprop="name">逆向</span></a>
<meta itemprop="position" content="1" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="en">
  <link itemprop="mainEntityOfPage" href="http://example.com/2023/08/22/%E5%8E%BB%E5%BC%B9%E7%AA%97%E7%BB%BF%E5%8C%96/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="John Doe">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Hexo">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="破解"><a class="markdownIt-Anchor" href="#破解">#</a> 破解</h1>
<blockquote>
<p>PUSHFD 指令把 32 位 EFLAGS 寄存器内容压入堆栈，而 POPFD 指令则把栈顶单元内容弹出到 EFLAGS 寄存器：</p>
<p>PUSHAD 指令按照 EAX、ECX、EDX、EBX、ESP（执行 PUSHAD 之前的值）、EBP、ESI 和 EDI 的顺序，将所有 32 位通用寄存器压入堆栈</p>
</blockquote>
<p>脱壳之后记得 fix res</p>
<h2 id="常用函数"><a class="markdownIt-Anchor" href="#常用函数">#</a> 常用函数</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">了解Windows API：</span><br><span class="line">//消息框</span><br><span class="line">1.MessageBoxA/W</span><br><span class="line"></span><br><span class="line">//弹网页</span><br><span class="line">2.ShellExecuteA/W</span><br><span class="line">3.WinExec</span><br><span class="line">4.CreateProcessA/W</span><br><span class="line"></span><br><span class="line">5.CreateThread</span><br><span class="line"></span><br><span class="line">//注册表</span><br><span class="line">6.RegCreateKeyExA/W</span><br><span class="line">7.RegOpenKeyExA/W</span><br><span class="line">8.RegDeleteKeyExA/W</span><br><span class="line"></span><br><span class="line">//创建窗口</span><br><span class="line">DialogBox</span><br><span class="line">CreateWindowExA/W</span><br></pre></td></tr></table></figure>
<h2 id="nop-填充"><a class="markdownIt-Anchor" href="#nop-填充">#</a> nop 填充</h2>
<p>整条填充 00</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230817121220618.png" alt="image-20230817121220618"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230817121353324.png" alt="image-20230817121353324"></p>
<p>nop 填充 MessageBox</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230817131409135.png" alt="image-20230817131409135"></p>
<h2 id="函数下段"><a class="markdownIt-Anchor" href="#函数下段">#</a> 函数下段</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//弹网页</span><br><span class="line">2.ShellExecuteA/W</span><br><span class="line">3.WinExec</span><br><span class="line">4.CreateProcessA/W</span><br></pre></td></tr></table></figure>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230817132219720.png" alt="image-20230817132219720"></p>
<p>回车第一条转到调用的地方，同时注意有两个参数</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230817132458596.png" alt="image-20230817132458596"></p>
<p>nop 填充</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230817132604822.png" alt="image-20230817132604822"></p>
<p>一样的方法把调用的地方 nop</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230817132710378.png" alt="image-20230817132710378"></p>
<h2 id="修复改浏览器主页"><a class="markdownIt-Anchor" href="#修复改浏览器主页">#</a> 修复改浏览器主页</h2>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230817133248989.png" alt="image-20230817133248989"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230817133306465.png" alt="image-20230817133306465"></p>
<p>整个函数都是修改注册表的</p>
<p>可以在首行 ret，或者一个个 nop</p>
<h2 id="编辑资源"><a class="markdownIt-Anchor" href="#编辑资源">#</a> 编辑资源</h2>
<p>使用资源编辑器删除或者设置为不可见</p>
<p>建议使用工具 resourcehacker 或者 restorator</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230817134553253.png" alt="image-20230817134553253"></p>
<h2 id="查找窗口"><a class="markdownIt-Anchor" href="#查找窗口">#</a> 查找窗口</h2>
<p>procexp 查找窗口属于哪个程序</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230817135114574.png" alt="image-20230817135114574"></p>
<h2 id="调用函数过滤"><a class="markdownIt-Anchor" href="#调用函数过滤">#</a> 调用函数过滤</h2>
<p>处理窗口</p>
<p>一样给函数下段</p>
<p>// 创建窗口<br>
 DialogBox<br>
CreateWindowExA/W</p>
<p>如果不知道调用的函数，使用 procmon</p>
<p>先使用过滤器找到程序名</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230817135804780.png" alt="image-20230817135804780"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230817135749844.png" alt="image-20230817135749844"></p>
<h2 id="编辑资源-2"><a class="markdownIt-Anchor" href="#编辑资源-2">#</a> 编辑资源</h2>
<p>1. 资源编辑工具</p>
<p>2.winapi</p>
<p>SetDlgItemTextW/A</p>
<p>DialogBox</p>
<p>3.16 进制编辑器</p>
<p>winhex</p>
<h1 id="破解程序重启验证"><a class="markdownIt-Anchor" href="#破解程序重启验证">#</a> 破解程序重启验证</h1>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">吾爱破解培训第五课：反击作者的挑衅--实战解除程序重启验证</span><br><span class="line"></span><br><span class="line">吾爱破解专用版Ollydbg:http://down.52pojie.cn/Tools/Debuggers/</span><br><span class="line">ProcMon:http://down.52pojie.cn/Tools/Anti_Rootkit/</span><br><span class="line"></span><br><span class="line">题外话:</span><br><span class="line">    编程是逆向的基础,破解只是逆向的一个很小的分支。如果真喜欢逆向,建议好好的去学一下编程,毕竟写软件不容易。</span><br><span class="line"></span><br><span class="line">0xFFFFFFFF:预习</span><br><span class="line">    熟悉OD字符串插件的使用</span><br><span class="line">Ctrl+F搜索字符串</span><br><span class="line"></span><br><span class="line">    熟悉OD如何下断点</span><br><span class="line">Ctrl+G:直接断API</span><br><span class="line">Ctrl+N:输入表断API</span><br><span class="line">利用插件</span><br><span class="line"></span><br><span class="line">    熟悉procmon的使用</span><br><span class="line">可以监控文件，注册表，网络，进线程信息</span><br><span class="line">排除进程:ExClude</span><br><span class="line">查看指定进程:Include</span><br><span class="line"></span><br><span class="line">    熟悉文件操作API的使用</span><br><span class="line">CreateFileA(W):创建文件</span><br><span class="line">ReadFile:读取文件</span><br><span class="line">WriteFile:写入文件</span><br><span class="line">CloseHandle:关闭句柄</span><br><span class="line">读取文件:CreateFile-&gt;ReadFile-&gt;CloseHandle</span><br><span class="line">写入文件:CreateFile-&gt;WriteFile-&gt;CloseHandle</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    熟悉注册表操作API的使用</span><br><span class="line">创建注册表Key:RegCreateKey</span><br><span class="line">打开注册表Key:RegOpenKey</span><br><span class="line">查询注册表键值:RegQueryValue(Ex)</span><br><span class="line">写入注册表键值:RegSetValueEx</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0x0:什么是重启验证</span><br><span class="line">    重启验证顾名思义就是在程序启动时验证注册信息。 </span><br><span class="line"></span><br><span class="line">0x1:执行流程</span><br><span class="line">    基本的执行流程:注册信息输入--&gt;程序重启--&gt;执行验证机制--&gt;正常执行</span><br><span class="line"></span><br><span class="line">    扩展的执行流程:注册信息输入--&gt;执行部分验证机制/执行假验证机制--&gt;程序重启--&gt;执行真验证机制--&gt;正常执行</span><br><span class="line"></span><br><span class="line">    对于有经验的作者来说,可以在注册信息输入和程序重启之间加入假的验证机制,假的验证机制一般比较简单,比如说只是当单纯的明码比较,当我们输入这个假的注册码的,程序一般会提示注册成功,此时程序就会知道我们是逆向者,在程序重启时就会假装注册成功,在执行程序功能时就会报错或是无反应,这就是所谓的暗桩。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0x2:重启验证的类型</span><br><span class="line">    重启验证根据写入信息位置的不同一般分两类,一类是将注册信息写入文件中,一类是将注册信息写入注册表中。</span><br><span class="line"></span><br><span class="line">0x3:定位关键代码</span><br><span class="line">    1.字符串定位</span><br><span class="line">     通过OD字符串插件扫描敏感字符串,一般出现的文件路径或是注册表路径都可能是验证信息的保存位置</span><br><span class="line"></span><br><span class="line">    2.监控工具定位</span><br><span class="line">    通过procmon等监控工具监控注册信息的写入位置</span><br><span class="line"></span><br><span class="line">    3.API定位</span><br><span class="line">    通过定位CreateFile,RegCreateKey等API来获取注册信息的写入位置</span><br><span class="line"></span><br><span class="line">0x4:Demo演示</span><br><span class="line">重启验证1:写入信息进txt:JXU2MjExJXU2</span><br><span class="line">CreateFile-&gt;WriteFile-&gt;ReadFile-&gt;比较算法</span><br><span class="line">重启验证2:写入信息进ini</span><br><span class="line">WritePrivateProfileStringA:写入配置信息</span><br><span class="line">0012F530   00544638  |Section = &quot;验证&quot;</span><br><span class="line">0012F534   00544634  |Key = &quot;Key&quot;</span><br><span class="line">0012F538   001C9578  |String = &quot;987654321&quot;</span><br><span class="line">0012F53C   001D7F70  \FileName = &quot;C:\Users\Administrator\Desktop\52Pojie.ini&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GetPrivateProfileStringA:读取配置信息</span><br><span class="line"></span><br><span class="line">NjJGJXU3NTI</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">重启验证3:写入信息进注册表</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">4JXU2MjM3</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230820115917972.png" alt="image-20230820115917972"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230820120137839.png" alt="image-20230820120137839"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230820133027331.png" alt="image-20230820133027331"></p>
<h3 id="写入到txt"><a class="markdownIt-Anchor" href="#写入到txt">#</a> 写入到 txt</h3>
<p>1. 在重启验证 1 处下段，关键代码如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">004026F0  |.  55                    push    ebp</span><br><span class="line">004026F1  |.  8BEC                  mov     ebp,esp</span><br><span class="line">004026F3  |.  6A FF                 push    -0x1</span><br><span class="line">004026F5  |.  68 68385300           push    00533868</span><br><span class="line">004026FA  |.  64:A1 00000000        mov     eax,dword ptr fs:[0]</span><br><span class="line">00402700  |.  50                    push    eax</span><br><span class="line">00402701  |.  83EC 0C               sub     esp,0xC</span><br><span class="line">00402704  |.  A1 B0275900           mov     eax,dword ptr ds:[0x5927B0]</span><br><span class="line">00402709  |.  33C5                  xor     eax,ebp</span><br><span class="line">0040270B  |.  8945 F0               mov     [local.4],eax</span><br><span class="line">0040270E  |.  56                    push    esi</span><br><span class="line">0040270F  |.  57                    push    edi</span><br><span class="line">00402710  |.  50                    push    eax</span><br><span class="line">00402711  |.  8D45 F4               lea     eax,[local.3]</span><br><span class="line">00402714  |.  64:A3 00000000        mov     dword ptr fs:[0],eax</span><br><span class="line">0040271A  |.  8BF1                  mov     esi,ecx</span><br><span class="line">0040271C  |.  C745 EC 00000000      mov     [local.5],0x0</span><br><span class="line">00402723  |.  E8 75270000           call    00404E9D</span><br><span class="line">00402728  |.  33D2                  xor     edx,edx</span><br><span class="line">0040272A  |.  8BC8                  mov     ecx,eax</span><br><span class="line">0040272C  |.  85C9                  test    ecx,ecx</span><br><span class="line">0040272E  |.  0F95C2                setne   dl</span><br><span class="line">00402731  |.  85D2                  test    edx,edx</span><br><span class="line">00402733  |.  75 0A                 jnz     short 0040273F</span><br><span class="line">00402735  |.  68 05400080           push    0x80004005</span><br><span class="line">0040273A  |.  E8 B1ECFFFF           call    004013F0</span><br><span class="line">0040273F  |&gt;  8B01                  mov     eax,dword ptr ds:[ecx]</span><br><span class="line">00402741  |.  FF50 0C               call    dword ptr ds:[eax+0xC]</span><br><span class="line">00402744  |.  83C0 10               add     eax,0x10</span><br><span class="line">00402747  |.  8945 EC               mov     [local.5],eax</span><br><span class="line">0040274A  |.  8D45 EC               lea     eax,[local.5]</span><br><span class="line">0040274D  |.  50                    push    eax</span><br><span class="line">0040274E  |.  8D8E C8000000         lea     ecx,dword ptr ds:[esi+0xC8]</span><br><span class="line">00402754  |.  C745 FC 00000000      mov     [local.1],0x0</span><br><span class="line">0040275B  |.  E8 C8590100           call    00418128</span><br><span class="line">00402760  |.  8B45 EC               mov     eax,[local.5]                      ;  获取文本框内容</span><br><span class="line">00402763  |.  8378 F4 00            cmp     dword ptr ds:[eax-0xC],0x0</span><br><span class="line">00402767  |.  74 74                 je      short 004027DD</span><br><span class="line">00402769  |.  6A 00                 push    0x0                                ; /hTemplateFile = NULL</span><br><span class="line">0040276B  |.  6A 00                 push    0x0                                ; |Attributes = 0</span><br><span class="line">0040276D  |.  6A 02                 push    0x2                                ; |Mode = CREATE_ALWAYS</span><br><span class="line">0040276F  |.  6A 00                 push    0x0                                ; |pSecurity = NULL</span><br><span class="line">00402771  |.  6A 01                 push    0x1                                ; |ShareMode = FILE_SHARE_READ</span><br><span class="line">00402773  |.  68 00000040           push    0x40000000                         ; |Access = GENERIC_WRITE</span><br><span class="line">00402778  |.  FFB6 BC000000         push    dword ptr ds:[esi+0xBC]            ; |FileName</span><br><span class="line">0040277E  |.  FF15 10345400         call    dword ptr ds:[&lt;&amp;KERNEL32.CreateFil&gt;; \CreateFileA</span><br><span class="line">00402784  |.  8BF0                  mov     esi,eax</span><br><span class="line">00402786  |.  83FE FF               cmp     esi,-0x1                           ;  文件是否创建</span><br><span class="line">00402789  |.  74 52                 je      short 004027DD</span><br><span class="line">0040278B  |.  8B4D EC               mov     ecx,[local.5]                      ;  ecx就是我们输入的值</span><br><span class="line">0040278E  |.  BA 01000000           mov     edx,0x1</span><br><span class="line">00402793  |.  2B51 FC               sub     edx,dword ptr ds:[ecx-0x4]</span><br><span class="line">00402796  |.  8B41 F8               mov     eax,dword ptr ds:[ecx-0x8]</span><br><span class="line">00402799  |.  0BC2                  or      eax,edx</span><br><span class="line">0040279B  |.  8B79 F4               mov     edi,dword ptr ds:[ecx-0xC]</span><br><span class="line">0040279E  |.  7D 0D                 jge     short 004027AD</span><br><span class="line">004027A0  |.  6A 00                 push    0x0</span><br><span class="line">004027A2  |.  8D4D EC               lea     ecx,[local.5]</span><br><span class="line">004027A5  |.  E8 B6EEFFFF           call    00401660</span><br><span class="line">004027AA  |.  8B4D EC               mov     ecx,[local.5]</span><br><span class="line">004027AD  |&gt;  6A 00                 push    0x0                                ; /pOverlapped = NULL</span><br><span class="line">004027AF  |.  8D45 E8               lea     eax,[local.6]                      ; |</span><br><span class="line">004027B2  |.  50                    push    eax                                ; |pBytesWritten</span><br><span class="line">004027B3  |.  57                    push    edi                                ; |nBytesToWrite</span><br><span class="line">004027B4  |.  51                    push    ecx                                ; |Buffer</span><br><span class="line">004027B5  |.  56                    push    esi                                ; |hFile</span><br><span class="line">004027B6  |.  FF15 2C345400         call    dword ptr ds:[&lt;&amp;KERNEL32.WriteFile&gt;; \WriteFile</span><br><span class="line">004027BC  |.  85C0                  test    eax,eax</span><br><span class="line">004027BE  |.  74 16                 je      short 004027D6</span><br><span class="line">004027C0  |.  6A 00                 push    0x0</span><br><span class="line">004027C2  |.  6A 00                 push    0x0</span><br><span class="line">004027C4  |.  68 60465400           push    00544660                           ;  你选择的验证类型是重启验证1</span><br><span class="line">004027C9  |.  E8 B17F0000           call    0040A77F                           ;  弹窗</span><br><span class="line">004027CE  |.  6A 00                 push    0x0                                ; /ExitCode = 0x0</span><br><span class="line">004027D0  |.  FF15 40385400         call    dword ptr ds:[&lt;&amp;USER32.PostQuitMes&gt;; \PostQuitMessage</span><br><span class="line">004027D6  |&gt;  56                    push    esi                                ; /hObject</span><br><span class="line">004027D7  |.  FF15 24345400         call    dword ptr ds:[&lt;&amp;KERNEL32.CloseHand&gt;; \CloseHandle</span><br></pre></td></tr></table></figure>
<p>执行完写文件程序会自动退出</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230821215838073.png" alt="image-20230821215838073"></p>
<p>2. 重新载入程序，在 txt 处下段</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230821215937761.png" alt="image-20230821215937761"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">00402A60  /.  55                    push    ebp</span><br><span class="line">00402A61  |.  8BEC                  mov     ebp,esp</span><br><span class="line">00402A63  |.  6A FF                 push    -0x1</span><br><span class="line">00402A65  |.  68 FB385300           push    005338FB</span><br><span class="line">00402A6A  |.  64:A1 00000000        mov     eax,dword ptr fs:[0]</span><br><span class="line">00402A70  |.  50                    push    eax</span><br><span class="line">00402A71  |.  81EC 1C010000         sub     esp,0x11C</span><br><span class="line">00402A77  |.  A1 B0275900           mov     eax,dword ptr ds:[0x5927B0]</span><br><span class="line">00402A7C  |.  33C5                  xor     eax,ebp</span><br><span class="line">00402A7E  |.  8945 F0               mov     [local.4],eax</span><br><span class="line">00402A81  |.  53                    push    ebx</span><br><span class="line">00402A82  |.  56                    push    esi</span><br><span class="line">00402A83  |.  57                    push    edi</span><br><span class="line">00402A84  |.  50                    push    eax</span><br><span class="line">00402A85  |.  8D45 F4               lea     eax,[local.3]</span><br><span class="line">00402A88  |.  64:A3 00000000        mov     dword ptr fs:[0],eax</span><br><span class="line">00402A8E  |.  8BF9                  mov     edi,ecx</span><br><span class="line">00402A90  |.  89BD E4FEFFFF         mov     [local.71],edi</span><br><span class="line">00402A96  |.  E8 2E4B0000           call    004075C9</span><br><span class="line">00402A9B  |.  FFB7 B8000000         push    dword ptr ds:[edi+0xB8]                            ; /lParam</span><br><span class="line">00402AA1  |.  8B35 44385400         mov     esi,dword ptr ds:[&lt;&amp;USER32.SendMessageA&gt;]          ; |user32.SendMessageA</span><br><span class="line">00402AA7  |.  6A 01                 push    0x1                                                ; |wParam = 0x1</span><br><span class="line">00402AA9  |.  68 80000000           push    0x80                                               ; |Message = WM_SETICON</span><br><span class="line">00402AAE  |.  FF77 20               push    dword ptr ds:[edi+0x20]                            ; |hWnd</span><br><span class="line">00402AB1  |.  FFD6                  call    esi                                                ; \SendMessageA</span><br><span class="line">00402AB3  |.  FFB7 B8000000         push    dword ptr ds:[edi+0xB8]                            ; /lParam</span><br><span class="line">00402AB9  |.  6A 00                 push    0x0                                                ; |wParam = 0x0</span><br><span class="line">00402ABB  |.  68 80000000           push    0x80                                               ; |Message = WM_SETICON</span><br><span class="line">00402AC0  |.  FF77 20               push    dword ptr ds:[edi+0x20]                            ; |hWnd</span><br><span class="line">00402AC3  |.  FFD6                  call    esi                                                ; \SendMessageA</span><br><span class="line">00402AC5  |.  68 04010000           push    0x104</span><br><span class="line">00402ACA  |.  33DB                  xor     ebx,ebx</span><br><span class="line">00402ACC  |.  8D85 ECFEFFFF         lea     eax,[local.69]</span><br><span class="line">00402AD2  |.  53                    push    ebx</span><br><span class="line">00402AD3  |.  50                    push    eax</span><br><span class="line">00402AD4  |.  E8 E7971100           call    0051C2C0</span><br><span class="line">00402AD9  |.  83C4 0C               add     esp,0xC</span><br><span class="line">00402ADC  |.  8D85 ECFEFFFF         lea     eax,[local.69]</span><br><span class="line">00402AE2  |.  50                    push    eax                                                ; /Buffer</span><br><span class="line">00402AE3  |.  68 04010000           push    0x104                                              ; |BufSize = 104 (260.)</span><br><span class="line">00402AE8  |.  FF15 14345400         call    dword ptr ds:[&lt;&amp;KERNEL32.GetCurrentDirectoryA&gt;]    ; \GetCurrentDirectoryA</span><br><span class="line">00402AEE  |.  8D85 ECFEFFFF         lea     eax,[local.69]</span><br><span class="line">00402AF4  |.  50                    push    eax</span><br><span class="line">00402AF5  |.  8DB7 BC000000         lea     esi,dword ptr ds:[edi+0xBC]</span><br><span class="line">00402AFB  |.  68 D8455400           push    005445D8                                           ;  %s\52Pojie.txt</span><br><span class="line">00402B00  |.  56                    push    esi</span><br><span class="line">00402B01  |.  E8 8AE9FFFF           call    00401490										;  CString 拼接函数</span><br><span class="line">00402B06  |.  8D8D ECFEFFFF         lea     ecx,[local.69]</span><br><span class="line">00402B0C  |.  51                    push    ecx</span><br><span class="line">00402B0D  |.  8D87 C0000000         lea     eax,dword ptr ds:[edi+0xC0]</span><br><span class="line">00402B13  |.  68 E8455400           push    005445E8                                           ;  %s\52Pojie.ini</span><br><span class="line">00402B18  |.  50                    push    eax</span><br><span class="line">00402B19  |.  8985 E0FEFFFF         mov     [local.72],eax</span><br><span class="line">00402B1F  |.  E8 6CE9FFFF           call    00401490</span><br><span class="line">00402B24  |.  8D87 C4000000         lea     eax,dword ptr ds:[edi+0xC4]</span><br><span class="line">00402B2A  |.  68 F8455400           push    005445F8                                           ;  Software\52Pojie</span><br><span class="line">00402B2F  |.  50                    push    eax</span><br><span class="line">00402B30  |.  E8 5BE9FFFF           call    00401490</span><br><span class="line">00402B35  |.  83C4 20               add     esp,0x20</span><br><span class="line">00402B38  |.  8D87 3C010000         lea     eax,dword ptr ds:[edi+0x13C]</span><br><span class="line">00402B3E  |.  68 0C465400           push    0054460C                                           ;  验证失败</span><br><span class="line">00402B43  |.  8BC8                  mov     ecx,eax</span><br><span class="line">00402B45  |.  8985 DCFEFFFF         mov     [local.73],eax</span><br><span class="line">00402B4B  |.  E8 70990100           call    0041C4C0                                           ;  标签初始化</span><br><span class="line">00402B50  |.  8D8F B0010000         lea     ecx,dword ptr ds:[edi+0x1B0]</span><br><span class="line">00402B56  |.  68 0C465400           push    0054460C                                           ;  验证失败</span><br><span class="line">00402B5B  |.  E8 60990100           call    0041C4C0</span><br><span class="line">00402B60  |.  8D8F 24020000         lea     ecx,dword ptr ds:[edi+0x224]</span><br><span class="line">00402B66  |.  68 0C465400           push    0054460C                                           ;  验证失败</span><br><span class="line">00402B6B  |.  E8 50990100           call    0041C4C0</span><br><span class="line">00402B70  |.  8B06                  mov     eax,dword ptr ds:[esi]</span><br><span class="line">00402B72  |.  83E8 10               sub     eax,0x10</span><br><span class="line">00402B75  |.  50                    push    eax</span><br><span class="line">00402B76  |.  E8 F5F3FFFF           call    00401F70</span><br><span class="line">00402B7B  |.  83C4 04               add     esp,0x4</span><br><span class="line">00402B7E  |.  8D70 10               lea     esi,dword ptr ds:[eax+0x10]</span><br><span class="line">00402B81  |.  56                    push    esi                                                ; /FileName</span><br><span class="line">00402B82  |.  FF15 0C345400         call    dword ptr ds:[&lt;&amp;KERNEL32.GetFileAttributesA&gt;]      ; \GetFileAttributesA</span><br><span class="line">00402B88  |.  33C9                  xor     ecx,ecx</span><br><span class="line">00402B8A  |.  83F8 FF               cmp     eax,-0x1                                           ;  判断文件是否存在</span><br><span class="line">00402B8D  |.  0F95C1                setne   cl</span><br><span class="line">00402B90  |.  83C6 F0               add     esi,-0x10</span><br><span class="line">00402B93  |.  83CF FF               or      edi,0xFFFFFFFF</span><br><span class="line">00402B96  |.  8BC7                  mov     eax,edi</span><br><span class="line">00402B98  |.  898D E8FEFFFF         mov     [local.70],ecx</span><br><span class="line">00402B9E  |.  8D4E 0C               lea     ecx,dword ptr ds:[esi+0xC]</span><br><span class="line">00402BA1  |.  F0:0FC101             lock xadd dword ptr ds:[ecx],eax</span><br><span class="line">00402BA5  |.  48                    dec     eax</span><br><span class="line">00402BA6  |.  85C0                  test    eax,eax</span><br><span class="line">00402BA8  |.  7F 08                 jg      short 00402BB2</span><br><span class="line">00402BAA  |.  8B0E                  mov     ecx,dword ptr ds:[esi]</span><br><span class="line">00402BAC  |.  56                    push    esi</span><br><span class="line">00402BAD  |.  8B01                  mov     eax,dword ptr ds:[ecx]</span><br><span class="line">00402BAF  |.  FF50 04               call    dword ptr ds:[eax+0x4]</span><br><span class="line">00402BB2  |&gt;  399D E8FEFFFF         cmp     [local.70],ebx</span><br><span class="line">00402BB8  |.  74 24                 je      short 00402BDE									;  nop 掉，或者跟入算法call</span><br><span class="line">00402BBA  |.  8B8D E4FEFFFF         mov     ecx,[local.71]</span><br><span class="line">00402BC0  |.  E8 1BF4FFFF           call    00401FE0                                           ;  算法call</span><br><span class="line">00402BC5  |.  85C0                  test    eax,eax</span><br><span class="line">00402BC7  |.  74 15                 je      short 00402BDE</span><br><span class="line">00402BC9  |.  8B8D DCFEFFFF         mov     ecx,[local.73]</span><br><span class="line">00402BCF  |.  68 18465400           push    00544618                                           ;  验证通过</span><br><span class="line">00402BD4  |.  E8 E7980100           call    0041C4C0</span><br><span class="line">00402BD9  |.  BB 01000000           mov     ebx,0x1</span><br><span class="line">00402BDE  |&gt;  8B85 E0FEFFFF         mov     eax,[local.72]</span><br><span class="line">00402BE4  |.  8B00                  mov     eax,dword ptr ds:[eax]</span><br><span class="line">00402BE6  |.  83E8 10               sub     eax,0x10</span><br><span class="line">00402BE9  |.  50                    push    eax</span><br><span class="line">00402BEA  |.  E8 81F3FFFF           call    00401F70</span><br><span class="line">00402BEF  |.  83C4 04               add     esp,0x4</span><br><span class="line">00402BF2  |.  8D70 10               lea     esi,dword ptr ds:[eax+0x10]</span><br><span class="line">00402BF5  |.  56                    push    esi                                                ; /FileName</span><br><span class="line">00402BF6  |.  FF15 0C345400         call    dword ptr ds:[&lt;&amp;KERNEL32.GetFileAttributesA&gt;]      ; \GetFileAttributesA</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"># 算法call</span><br><span class="line">00401FE0  |$  55                    push    ebp</span><br><span class="line">00401FE1  |.  8BEC                  mov     ebp,esp</span><br><span class="line">00401FE3  |.  81EC 10010000         sub     esp,0x110</span><br><span class="line">00401FE9  |.  A1 B0275900           mov     eax,dword ptr ds:[0x5927B0]</span><br><span class="line">00401FEE  |.  33C5                  xor     eax,ebp</span><br><span class="line">00401FF0  |.  8945 FC               mov     [local.1],eax</span><br><span class="line">00401FF3  |.  56                    push    esi</span><br><span class="line">00401FF4  |.  57                    push    edi</span><br><span class="line">00401FF5  |.  33F6                  xor     esi,esi</span><br><span class="line">00401FF7  |.  56                    push    esi                                                ; /hTemplateFile =&gt; NULL</span><br><span class="line">00401FF8  |.  56                    push    esi                                                ; |Attributes =&gt; 0</span><br><span class="line">00401FF9  |.  6A 03                 push    0x3                                                ; |Mode = OPEN_EXISTING</span><br><span class="line">00401FFB  |.  56                    push    esi                                                ; |pSecurity =&gt; NULL</span><br><span class="line">00401FFC  |.  6A 01                 push    0x1                                                ; |ShareMode = FILE_SHARE_READ</span><br><span class="line">00401FFE  |.  6A 01                 push    0x1                                                ; |Access = 1</span><br><span class="line">00402000  |.  FFB1 BC000000         push    dword ptr ds:[ecx+0xBC]                            ; |FileName</span><br><span class="line">00402006  |.  FF15 10345400         call    dword ptr ds:[&lt;&amp;KERNEL32.CreateFileA&gt;]             ; \CreateFileA</span><br><span class="line">0040200C  |.  8BF8                  mov     edi,eax</span><br><span class="line">0040200E  |.  83FF FF               cmp     edi,-0x1</span><br><span class="line">00402011  |.  0F84 7F000000         je      00402096</span><br><span class="line">00402017  |.  68 04010000           push    0x104</span><br><span class="line">0040201C  |.  8D85 F5FEFFFF         lea     eax,dword ptr ss:[ebp-0x10B]</span><br><span class="line">00402022  |.  56                    push    esi</span><br><span class="line">00402023  |.  50                    push    eax</span><br><span class="line">00402024  |.  C685 F4FEFFFF 00      mov     byte ptr ss:[ebp-0x10C],0x0</span><br><span class="line">0040202B  |.  E8 90A21100           call    0051C2C0</span><br><span class="line">00402030  |.  83C4 0C               add     esp,0xC</span><br><span class="line">00402033  |.  8D85 F0FEFFFF         lea     eax,[local.68]</span><br><span class="line">00402039  |.  56                    push    esi                                                ; /pOverlapped</span><br><span class="line">0040203A  |.  50                    push    eax                                                ; |pBytesRead</span><br><span class="line">0040203B  |.  68 04010000           push    0x104                                              ; |BytesToRead = 104 (260.)</span><br><span class="line">00402040  |.  8D85 F4FEFFFF         lea     eax,[local.67]                                     ; |</span><br><span class="line">00402046  |.  50                    push    eax                                                ; |Buffer</span><br><span class="line">00402047  |.  57                    push    edi                                                ; |hFile</span><br><span class="line">00402048  |.  FF15 28345400         call    dword ptr ds:[&lt;&amp;KERNEL32.ReadFile&gt;]                ; \ReadFile</span><br><span class="line">0040204E  |.  85C0                  test    eax,eax</span><br><span class="line">00402050  |.  74 3D                 je      short 0040208F</span><br><span class="line">00402052  |.  B9 24465400           mov     ecx,00544624                                       ;  JXU2MjExJXU2</span><br><span class="line">00402057  |.  8D85 F4FEFFFF         lea     eax,[local.67]</span><br><span class="line">0040205D  |.  8D49 00               lea     ecx,dword ptr ds:[ecx]</span><br><span class="line">00402060  |&gt;  8A10                  /mov     dl,byte ptr ds:[eax]                              ;  strcmp</span><br><span class="line">00402062  |.  3A11                  |cmp     dl,byte ptr ds:[ecx]</span><br><span class="line">00402064  |.  75 1A                 |jnz     short 00402080</span><br><span class="line">00402066  |.  84D2                  |test    dl,dl</span><br><span class="line">00402068  |.  74 12                 |je      short 0040207C</span><br><span class="line">0040206A  |.  8A50 01               |mov     dl,byte ptr ds:[eax+0x1]</span><br><span class="line">0040206D  |.  3A51 01               |cmp     dl,byte ptr ds:[ecx+0x1]</span><br><span class="line">00402070  |.  75 0E                 |jnz     short 00402080</span><br><span class="line">00402072  |.  83C0 02               |add     eax,0x2</span><br><span class="line">00402075  |.  83C1 02               |add     ecx,0x2</span><br><span class="line">00402078  |.  84D2                  |test    dl,dl</span><br><span class="line">0040207A  |.^ 75 E4                 \jnz     short 00402060</span><br><span class="line">0040207C  |&gt;  33C0                  xor     eax,eax</span><br><span class="line">0040207E  |.  EB 05                 jmp     short 00402085</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>我们可以爆破跳过验证环节，也可以跟入算法 call 找到真正的验证码</p>
<h3 id="写入到ini"><a class="markdownIt-Anchor" href="#写入到ini">#</a> 写入到 ini</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">00402820  /.  55                    push    ebp</span><br><span class="line">00402821  |.  8BEC                  mov     ebp,esp</span><br><span class="line">00402823  |.  6A FF                 push    -0x1</span><br><span class="line">00402825  |.  68 98385300           push    00533898</span><br><span class="line">0040282A  |.  64:A1 00000000        mov     eax,dword ptr fs:[0]</span><br><span class="line">00402830  |.  50                    push    eax</span><br><span class="line">00402831  |.  83EC 08               sub     esp,0x8</span><br><span class="line">00402834  |.  A1 B0275900           mov     eax,dword ptr ds:[0x5927B0]</span><br><span class="line">00402839  |.  33C5                  xor     eax,ebp</span><br><span class="line">0040283B  |.  8945 F0               mov     [local.4],eax</span><br><span class="line">0040283E  |.  56                    push    esi</span><br><span class="line">0040283F  |.  50                    push    eax</span><br><span class="line">00402840  |.  8D45 F4               lea     eax,[local.3]</span><br><span class="line">00402843  |.  64:A3 00000000        mov     dword ptr fs:[0],eax</span><br><span class="line">00402849  |.  8BF1                  mov     esi,ecx</span><br><span class="line">0040284B  |.  C745 EC 00000000      mov     [local.5],0x0</span><br><span class="line">00402852  |.  E8 46260000           call    00404E9D</span><br><span class="line">00402857  |.  33D2                  xor     edx,edx</span><br><span class="line">00402859  |.  8BC8                  mov     ecx,eax</span><br><span class="line">0040285B  |.  85C9                  test    ecx,ecx</span><br><span class="line">0040285D  |.  0F95C2                setne   dl</span><br><span class="line">00402860  |.  85D2                  test    edx,edx</span><br><span class="line">00402862  |.  75 0A                 jnz     short 0040286E</span><br><span class="line">00402864  |.  68 05400080           push    0x80004005</span><br><span class="line">00402869  |.  E8 82EBFFFF           call    004013F0</span><br><span class="line">0040286E  |&gt;  8B01                  mov     eax,dword ptr ds:[ecx]</span><br><span class="line">00402870  |.  FF50 0C               call    dword ptr ds:[eax+0xC]</span><br><span class="line">00402873  |.  83C0 10               add     eax,0x10</span><br><span class="line">00402876  |.  8945 EC               mov     [local.5],eax</span><br><span class="line">00402879  |.  8D45 EC               lea     eax,[local.5]</span><br><span class="line">0040287C  |.  50                    push    eax</span><br><span class="line">0040287D  |.  8D8E C8000000         lea     ecx,dword ptr ds:[esi+0xC8]</span><br><span class="line">00402883  |.  C745 FC 00000000      mov     [local.1],0x0</span><br><span class="line">0040288A  |.  E8 99580100           call    00418128                                                    ;  获取输入</span><br><span class="line">0040288F  |.  8B45 EC               mov     eax,[local.5]</span><br><span class="line">00402892  |.  8378 F4 00            cmp     dword ptr ds:[eax-0xC],0x0</span><br><span class="line">00402896  |.  74 51                 je      short 004028E9                                              ;  输入为空直接结束</span><br><span class="line">00402898  |.  8B48 F8               mov     ecx,dword ptr ds:[eax-0x8]</span><br><span class="line">0040289B  |.  8BB6 C0000000         mov     esi,dword ptr ds:[esi+0xC0]</span><br><span class="line">004028A1  |.  BA 01000000           mov     edx,0x1</span><br><span class="line">004028A6  |.  2B50 FC               sub     edx,dword ptr ds:[eax-0x4]</span><br><span class="line">004028A9  |.  0BCA                  or      ecx,edx</span><br><span class="line">004028AB  |.  7D 0D                 jge     short 004028BA</span><br><span class="line">004028AD  |.  6A 00                 push    0x0</span><br><span class="line">004028AF  |.  8D4D EC               lea     ecx,[local.5]</span><br><span class="line">004028B2  |.  E8 A9EDFFFF           call    00401660</span><br><span class="line">004028B7  |.  8B45 EC               mov     eax,[local.5]</span><br><span class="line">004028BA  |&gt;  56                    push    esi                                                         ; /FileName</span><br><span class="line">004028BB  |.  50                    push    eax                                                         ; |String</span><br><span class="line">004028BC  |.  68 34465400           push    00544634                                                    ; |Key</span><br><span class="line">004028C1  |.  68 38465400           push    00544638                                                    ; |验证</span><br><span class="line">004028C6  |.  FF15 18345400         call    dword ptr ds:[&lt;&amp;KERNEL32.WritePrivateProfileStringA&gt;]       ; \WritePrivateProfileStringA</span><br><span class="line">004028CC  |.  85C0                  test    eax,eax                                                     ;  写文件</span><br><span class="line">004028CE  |.  74 16                 je      short 004028E6</span><br><span class="line">004028D0  |.  6A 00                 push    0x0</span><br><span class="line">004028D2  |.  6A 00                 push    0x0</span><br><span class="line">004028D4  |.  68 7C465400           push    0054467C                                                    ;  你选择的验证类型是重启验证2</span><br><span class="line">004028D9  |.  E8 A17E0000           call    0040A77F                                                    ;  弹窗</span><br><span class="line">004028DE  |.  6A 00                 push    0x0                                                         ; /ExitCode = 0x0</span><br><span class="line">004028E0  |.  FF15 40385400         call    dword ptr ds:[&lt;&amp;USER32.PostQuitMessage&gt;]                    ; \PostQuitMessage</span><br><span class="line">004028E6  |&gt;  8B45 EC               mov     eax,[local.5]</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>或者通过给函数下段也，也能断下来</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230821222933923.png" alt="image-20230821222933923"></p>
<h3 id="写入注册表"><a class="markdownIt-Anchor" href="#写入注册表">#</a> 写入注册表</h3>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230821223559082.png" alt="image-20230821223559082"></p>
<p>通过下段找到写入和读取注册表的地方，读取注册表就是算法 call</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230821223930345.png" alt="image-20230821223930345"></p>
<p>下段记得下的是 ExA</p>
<p>JXU2MjExJXU2</p>
<p>NjJGJXU3NTI</p>
<p>4JXU2MjM3</p>
<h1 id="破解程序自校验md5"><a class="markdownIt-Anchor" href="#破解程序自校验md5">#</a> 破解程序自校验 (md5)</h1>
<p>1. 搜索字符串，找到关键字符串，比如注册，激活，通过 xx</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230820151928757.png" alt="image-20230820151928757"></p>
<p>2、在关键字符串所在函数处下段</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230820151949493.png" alt="image-20230820151949493"></p>
<p>3. 运行程序，点击注册，使程序断下来</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230820152059610.png" alt="image-20230820152059610"></p>
<p>4. 搜索常量，找到有哪些位置访问了这个常量</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230820152736054.png" alt="image-20230820152736054"></p>
<p>5. 对所有下段，找到常量的赋值点</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230820152806264.png" alt="image-20230820152806264"></p>
<p>6. 重新运行程序，程序被断在，说明此处可能对上面说的常量做了改变</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230820153407165.png" alt="image-20230820153407165"></p>
<p>7. 第一处关键点：会对前两个字符做验证，是否为 02</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230820193839511.png" alt="image-20230820193839511"></p>
<p>8. 第二处关键点：sn 判断 call 跟进去</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230820193956146.png" alt="image-20230820193956146"></p>
<p>9.sn 判断</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230820194328180.png" alt="image-20230820194328180"></p>
<p>10. 跳过网络验证</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230820194548582.png" alt="image-20230820194548582"></p>
<p>11. 找到验证函数最开始，直接 retn</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230820194627641.png" alt="image-20230820194627641"></p>
<p>12. 去除自校验。对 delphi 程序下按键断点，去除无关断点，点击任意触发断点</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230821165626093.png" alt="image-20230821165626093"></p>
<p>F7 进入函数，逐个函数跟踪</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230821165708555.png" alt="image-20230821165708555"></p>
<p>跟入第一个 call 4b2dc0</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230821165755920.png" alt="image-20230821165755920"></p>
<p>跟入 4B1F34</p>
<p>跟入 4B1F6A</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230821165849410.png" alt="image-20230821165849410"></p>
<p>这个函数是读文件的地方</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230821165952866.png" alt="image-20230821165952866"></p>
<p>返回到上层，4B1F74 就是读取 md5 的地方</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230821171219967.png" alt="image-20230821171219967"></p>
<p>被修改后的 md5： 4b1f74</p>
<p>DE7449CB2D3E11159C405532F86B6657</p>
<p>重新安装找到原来的 md5:</p>
<p>11ea70a3c3735c29b48552776756406a</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">004B1F74  |.  8D5D EC       lea      ebx,dword ptr ss:[ebp-0x14]</span><br><span class="line">004B1F77  |&gt;  8D55 E8       /lea     edx,dword ptr ss:[ebp-0x18]</span><br><span class="line">004B1F7A  |.  33C0          |xor     eax,eax</span><br><span class="line">004B1F7C  |.  8A03          |mov     al,byte ptr ds:[ebx]</span><br><span class="line">004B1F7E  |.  E8 35F1FFFF   |call    004B10B8</span><br><span class="line">004B1F83  |.  8B55 E8       |mov     edx,dword ptr ss:[ebp-0x18]</span><br><span class="line">004B1F86  |.  8BC7          |mov     eax,edi</span><br><span class="line">004B1F88  |.  E8 3F26F5FF   |call    004045CC</span><br><span class="line">004B1F8D  |.  43            |inc     ebx</span><br><span class="line">004B1F8E  |.  4E            |dec     esi</span><br><span class="line">004B1F8F  |.^ 75 E6         \jnz     short 004B1F77</span><br><span class="line"></span><br><span class="line">8D 5D EC 8D 55 E8 33 C0 8A 03 E8 35 F1 FF FF 8B 55 E8 8B C7 E8 3F 26 F5 FF 43 4E 75 E6</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img data-src="../AppData/Roaming/Typora/typora-user-images/image-20230821181650298.png" alt="image-20230821181650298"></p>
<p>找一块全 0 的地址  56b0a0</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230821180304129.png" alt="image-20230821180304129"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">0056B0A0      C745 EC 11EA7&gt;mov     dword ptr ss:[ebp-0x14],0xA370EA11</span><br><span class="line">0056B0A7      C745 F0 C3735&gt;mov     dword ptr ss:[ebp-0x10],0x295C73C3</span><br><span class="line">0056B0AE      C745 F4 B4855&gt;mov     dword ptr ss:[ebp-0xC],0x775285B4</span><br><span class="line">0056B0B5      C745 F8 67564&gt;mov     dword ptr ss:[ebp-0x8],0x6A405667</span><br><span class="line">0056B0BC      8D5D EC       lea     ebx,dword ptr ss:[ebp-0x14]</span><br><span class="line">0056B0BF      8D55 E8       lea     edx,dword ptr ss:[ebp-0x18]</span><br><span class="line">0056B0C2      33C0          xor     eax,eax</span><br><span class="line">0056B0C4      8A03          mov     al,byte ptr ds:[ebx]</span><br><span class="line">0056B0C6      E8 ED5FF4FF   call    004B10B8</span><br><span class="line">0056B0CB      8B55 E8       mov     edx,dword ptr ss:[ebp-0x18]</span><br><span class="line">0056B0CE      8BC7          mov     eax,edi</span><br><span class="line">0056B0D0      E8 F794E9FF   call    004045CC</span><br><span class="line">0056B0D5      43            inc     ebx</span><br><span class="line">0056B0D6      4E            dec     esi</span><br><span class="line">0056B0D7    ^ 75 E6         jnz     short 0056B0BF</span><br><span class="line">0056B0D9    ^ E9 B36EF4FF   jmp     004B1F91</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>附上 delphi 按键断点</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var Addr</span><br><span class="line">mov Addr,401000</span><br><span class="line">loop:</span><br><span class="line">find Addr,#740E8BD38B83????????FF93????????#</span><br><span class="line">cmp $RESULT,0</span><br><span class="line">je Exit</span><br><span class="line">add $RESULT,0A</span><br><span class="line">bp $RESULT</span><br><span class="line">add $RESULT,1</span><br><span class="line">mov Addr,$RESULT</span><br><span class="line">jmp loop</span><br><span class="line">Exit:</span><br><span class="line">ret</span><br></pre></td></tr></table></figure>
<h1 id="od-function-script"><a class="markdownIt-Anchor" href="#od-function-script">#</a> OD function script</h1>
<h2 id="导入表iat"><a class="markdownIt-Anchor" href="#导入表iat">#</a> 导入表（IAT）</h2>
<blockquote>
<p>Import Address Table 由于导入函数就是被程序调用但其执行代码又不在程序中的函数，这些函数的代码位于一个或者多个 DLL 中。当 PE 文件被装入内存的时候，Windows 装载器才将 DLL 装入，并将调用导入函数的指令和函数实际所处的地址联系起来 (动态连接)，这操作就需要导入表完成。其中导入地址表就指示函数实际地址。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sti   f7</span><br><span class="line">sto   f8</span><br><span class="line">bp    f2</span><br><span class="line">run   f9</span><br><span class="line">bphws [],&quot;r&quot;   硬件断点 hr esp </span><br></pre></td></tr></table></figure>
<h2 id="oep-script"><a class="markdownIt-Anchor" href="#oep-script">#</a> OEP script</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">bp oep</span><br><span class="line">run </span><br><span class="line">sti</span><br><span class="line">MSG &quot;OEP 到了&quot;</span><br><span class="line">ret </span><br></pre></td></tr></table></figure>
<h2 id="iat-script"><a class="markdownIt-Anchor" href="#iat-script">#</a> IAT script</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">sti	;pushad</span><br><span class="line">bphws esp,&quot;r&quot; ;hr esp</span><br><span class="line">run</span><br><span class="line">sti</span><br><span class="line">sti</span><br><span class="line">sti	;到了jnz</span><br><span class="line">bp eip	;</span><br><span class="line">@LOOP:</span><br><span class="line">run</span><br><span class="line">cmp esp,eax</span><br><span class="line">jnz @LOOP</span><br><span class="line">sti</span><br><span class="line">sti</span><br><span class="line">sti</span><br><span class="line"></span><br><span class="line">MSG &quot;到OEP了&quot;</span><br><span class="line">ret</span><br></pre></td></tr></table></figure>
<p>通过 ff15 或 ff25 找 iat</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"># 查找ff 15</span><br><span class="line">0041E0CC    56              push    esi</span><br><span class="line">0041E0CD    6A 00           push    0x0</span><br><span class="line">0041E0CF    FF35 2C3F4400   push    dword ptr ds:[0x443F2C]</span><br><span class="line">0041E0D5    FF15 6C214300   call    dword ptr ds:[0x43216C]</span><br><span class="line">0041E0DB    85C0            test    eax,eax</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># iat begin</span><br><span class="line">00431FF8  00000000</span><br><span class="line">00431FFC  00000000</span><br><span class="line">00432000  00970306</span><br><span class="line">00432004  0097030C</span><br><span class="line">00432008  00970312</span><br><span class="line"># iat end</span><br><span class="line">00432548  0097045C</span><br><span class="line">0043254C  00000000</span><br><span class="line">00432550  009704AA</span><br><span class="line">00432554  00000000</span><br><span class="line">00432558  00000000</span><br><span class="line"></span><br><span class="line">把原来的调用改成自己的地址，然后在自己的代码里，跳到真实的api地址</span><br><span class="line"></span><br><span class="line">00970288    68 FF83837C     push    kernel32.ConvertDefaultLocale</span><br><span class="line">0097028D    C3              retn</span><br><span class="line">0097028E    68 9906867C     push    kernel32.EnumResourceLanguagesW</span><br><span class="line">00970293    C3              retn</span><br><span class="line">00970294    68 75B4807C     push    kernel32.GetModuleFileNameW</span><br><span class="line">00970299    C3              retn</span><br><span class="line">0097029A    68 7C0D837C     push    kernel32.lstrcmpA</span><br><span class="line">0097029F    C3              retn</span><br><span class="line">009702A0    68 0216817C     push    kernel32.GetLocaleInfoW</span><br><span class="line">009702A5    C3              retn</span><br><span class="line">009702A6    68 EBAE807C     push    kernel32.LoadLibraryW</span><br><span class="line">009702AB    C3              retn</span><br><span class="line">009702AC    68 74A1807C     push    kernel32.WideCharToMultiByte</span><br><span class="line">009702B1    C3              retn</span><br><span class="line">009702B2    68 17D1807C     push    kernel32.CompareStringA</span><br><span class="line">009702B7    C3              retn</span><br><span class="line">009702B8    68 989C807C     push    kernel32.MultiByteToWideChar</span><br><span class="line">009702BD    C3              retn</span><br><span class="line">009702BE    68 6EBC807C     push    kernel32.FindResourceW</span><br><span class="line">009702C3    C3              retn</span><br><span class="line">009702C4    68 55A0807C     push    kernel32.LoadResource</span><br><span class="line">009702C9    C3              retn</span><br><span class="line">009702CA    68 37CD807C     push    kernel32.SetHandleCount</span><br><span class="line">009702CF    C3              retn</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="修复iat"><a class="markdownIt-Anchor" href="#修复iat">#</a> 修复 IAT</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">mov iat_b,00432000</span><br><span class="line">mov iat_e,00432554  </span><br><span class="line">;iat_b=00432000</span><br><span class="line"></span><br><span class="line">sti	;pushad</span><br><span class="line">bphws esp,&quot;r&quot; ;hr esp</span><br><span class="line">run</span><br><span class="line">sti</span><br><span class="line">sti</span><br><span class="line">sti	;到了jnz</span><br><span class="line">bp eip	;</span><br><span class="line">@LOOP:</span><br><span class="line">run</span><br><span class="line">cmp esp,eax</span><br><span class="line">jnz @LOOP</span><br><span class="line">sti</span><br><span class="line">sti</span><br><span class="line">sti</span><br><span class="line"></span><br><span class="line">MSG &quot;到OEP了&quot;</span><br><span class="line"></span><br><span class="line">@IAT_LOOP:</span><br><span class="line">mov iat,[iat_b]</span><br><span class="line">cmp iat,0</span><br><span class="line">je  @NEXT_LOOP</span><br><span class="line"></span><br><span class="line">mov api,[iat+1]</span><br><span class="line">mov [iat_b],api	;重建iat</span><br><span class="line"></span><br><span class="line">@NEXT_LOOP:</span><br><span class="line">add iat_b,4</span><br><span class="line">cmp iat_b,iat_e</span><br><span class="line">jne @IAT_LOOP</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">MSG &quot;OK IAT 修复已经完成 fuck kido&quot;</span><br><span class="line">ret</span><br></pre></td></tr></table></figure>
<p>载入脚本，空格运行</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230824133330558.png" alt="image-20230824133330558"></p>
<p>运行结束后，可以看到 iat 已经被修复</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230824133443438.png" alt="image-20230824133443438"></p>
<p>修复完所有的 iat 都是有效的</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230824133958639.png" alt="image-20230824133958639"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230824134029024.png" alt="image-20230824134029024"></p>
<p>或者直接使用 od 插件 ollydump 也能脱</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230824135813010.png" alt="image-20230824135813010"></p>
<h1 id="制作补丁"><a class="markdownIt-Anchor" href="#制作补丁">#</a> 制作补丁</h1>
<p>吾爱破解内存补丁生成器</p>
<p>keymake</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">4028AB 75 07 jnz short 004028B4</span><br><span class="line"></span><br><span class="line">jnz 0x75</span><br><span class="line">je 0x74</span><br></pre></td></tr></table></figure>
<p>拖入程序</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230825105921769.png" alt="image-20230825105921769"></p>
<p>导出补丁</p>
<p>如果注册码在程序中以明文存在，可以使用注册机</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">8B4D E8 mov ecx,[local.6]</span><br><span class="line">8B45 E4 mov eax,[local.7]</span><br><span class="line">402880 8A 10   mov dl, byte ptr ds:[eax]    //eax 中即为真实注册码</span><br><span class="line">3A 11   cmp dl, byte ptr ds:[ecx]</span><br></pre></td></tr></table></figure>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230825111225188.png" alt="image-20230825111225188"></p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230825111048015.png" alt="image-20230825111048015"></p>
<p>用户信息处可以自定义窗口和标题</p>
<p>生成</p>
<h1 id="x64"><a class="markdownIt-Anchor" href="#x64">#</a> x64</h1>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">0000000000401000</span><br><span class="line">R8b		byte</span><br><span class="line">R8w		word</span><br><span class="line">R8d		dword	</span><br><span class="line">R8</span><br><span class="line"></span><br><span class="line">AL</span><br><span class="line">AH</span><br><span class="line">AX</span><br><span class="line">EAX</span><br><span class="line">RAX</span><br><span class="line"></span><br><span class="line">mov r8d,ecx</span><br></pre></td></tr></table></figure>
<h1 id="ida"><a class="markdownIt-Anchor" href="#ida">#</a> IDA</h1>
<p>导入文件</p>
<p><img data-src="https://kbshire-1308981697.cos.ap-shanghai.myqcloud.com/img/image-20230825113612693.png" alt="image-20230825113612693"></p>

      <div class="tags">
          <a href="/tags/%E9%80%86%E5%90%91/" rel="tag"><i class="ic i-tag"></i> 逆向</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2023-10-03 23:01:44" itemprop="dateModified" datetime="2023-10-03T23:01:44+08:00">2023-10-03</time>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> Donate</button>
  <p>Give me a cup of [coffee]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="John Doe WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="John Doe Alipay">
        <p>Alipay</p>
      </div>
      
      <div>
        <img data-src="/images/paypal.png" alt="John Doe PayPal">
        <p>PayPal</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>Post author:  </strong>John Doe <i class="ic i-at"><em>@</em></i>Hexo
  </li>
  <li class="link">
    <strong>Post link: </strong>
    <a href="http://example.com/2023/08/22/%E5%8E%BB%E5%BC%B9%E7%AA%97%E7%BB%BF%E5%8C%96/" title="破解相关">http://example.com/2023/08/22/去弹窗绿化/</a>
  </li>
  <li class="license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2023/08/15/%E7%A0%B4%E8%A7%A3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B9%8B%E8%AE%A4%E8%AF%86%E5%A3%B3%E4%B8%8E%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%89%B9%E5%BE%81/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;img.timelessq.com&#x2F;images&#x2F;2022&#x2F;07&#x2F;26&#x2F;1406d3cdecfa0dd6e62f13a601eb9230.jpg" title="破解基础知识之认识壳与程序的特征">
  <span class="type">Previous Post</span>
  <span class="category"><i class="ic i-flag"></i> 逆向</span>
  <h3>破解基础知识之认识壳与程序的特征</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2023/09/01/border%20leaf/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;img.timelessq.com&#x2F;images&#x2F;2022&#x2F;07&#x2F;26&#x2F;20179998b27b569ef4634293516e8d09.jpg" title="从三层架构到spine leaf">
  <span class="type">Next Post</span>
  <span class="category"><i class="ic i-flag"></i> 网络</span>
  <h3>从三层架构到spine leaf</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.</span> <span class="toc-text"> 破解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">1.1.</span> <span class="toc-text"> 常用函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nop-%E5%A1%AB%E5%85%85"><span class="toc-number">1.2.</span> <span class="toc-text"> nop 填充</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E4%B8%8B%E6%AE%B5"><span class="toc-number">1.3.</span> <span class="toc-text"> 函数下段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E5%A4%8D%E6%94%B9%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%BB%E9%A1%B5"><span class="toc-number">1.4.</span> <span class="toc-text"> 修复改浏览器主页</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E8%B5%84%E6%BA%90"><span class="toc-number">1.5.</span> <span class="toc-text"> 编辑资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE%E7%AA%97%E5%8F%A3"><span class="toc-number">1.6.</span> <span class="toc-text"> 查找窗口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E8%BF%87%E6%BB%A4"><span class="toc-number">1.7.</span> <span class="toc-text"> 调用函数过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E8%B5%84%E6%BA%90-2"><span class="toc-number">1.8.</span> <span class="toc-text"> 编辑资源</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A0%B4%E8%A7%A3%E7%A8%8B%E5%BA%8F%E9%87%8D%E5%90%AF%E9%AA%8C%E8%AF%81"><span class="toc-number">2.</span> <span class="toc-text"> 破解程序重启验证</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%99%E5%85%A5%E5%88%B0txt"><span class="toc-number">2.0.1.</span> <span class="toc-text"> 写入到 txt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%99%E5%85%A5%E5%88%B0ini"><span class="toc-number">2.0.2.</span> <span class="toc-text"> 写入到 ini</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%99%E5%85%A5%E6%B3%A8%E5%86%8C%E8%A1%A8"><span class="toc-number">2.0.3.</span> <span class="toc-text"> 写入注册表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A0%B4%E8%A7%A3%E7%A8%8B%E5%BA%8F%E8%87%AA%E6%A0%A1%E9%AA%8Cmd5"><span class="toc-number">3.</span> <span class="toc-text"> 破解程序自校验 (md5)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#od-function-script"><span class="toc-number">4.</span> <span class="toc-text"> OD function script</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E8%A1%A8iat"><span class="toc-number">4.1.</span> <span class="toc-text"> 导入表（IAT）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#oep-script"><span class="toc-number">4.2.</span> <span class="toc-text"> OEP script</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#iat-script"><span class="toc-number">4.3.</span> <span class="toc-text"> IAT script</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E5%A4%8Diat"><span class="toc-number">4.4.</span> <span class="toc-text"> 修复 IAT</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%B6%E4%BD%9C%E8%A1%A5%E4%B8%81"><span class="toc-number">5.</span> <span class="toc-text"> 制作补丁</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#x64"><span class="toc-number">6.</span> <span class="toc-text"> x64</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ida"><span class="toc-number">7.</span> <span class="toc-text"> IDA</span></a></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
        <ul>
          <li><a href="/2022/11/01/%E6%B1%87%E7%BC%96/" rel="bookmark" title="汇编">汇编</a></li><li><a href="/2022/11/11/reverse/" rel="bookmark" title="逆向">逆向</a></li><li><a href="/2023/01/03/%E6%BB%B4%E6%B0%B4reverse/" rel="bookmark" title="水滴rev">水滴rev</a></li><li><a href="/2023/08/15/%E7%A0%B4%E8%A7%A3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B9%8B%E8%AE%A4%E8%AF%86%E5%A3%B3%E4%B8%8E%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%89%B9%E5%BE%81/" rel="bookmark" title="破解基础知识之认识壳与程序的特征">破解基础知识之认识壳与程序的特征</a></li><li class="active"><a href="/2023/08/22/%E5%8E%BB%E5%BC%B9%E7%AA%97%E7%BB%BF%E5%8C%96/" rel="bookmark" title="破解相关">破解相关</a></li><li><a href="/2023/10/01/1234567/" rel="bookmark" title="windows逆向进阶">windows逆向进阶</a></li><li><a href="/2023/10/03/hg%20ker/" rel="bookmark" title="hg内核">hg内核</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="John Doe"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">John Doe</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">42</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">6</span>
        <span class="name">categories</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">6</span>
        <span class="name">tags</span>
      </a>
    </div>
</nav>

<div class="social">
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2023/08/15/%E7%A0%B4%E8%A7%A3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B9%8B%E8%AE%A4%E8%AF%86%E5%A3%B3%E4%B8%8E%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%89%B9%E5%BE%81/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2023/09/01/border%20leaf/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>Random Posts</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E7%A7%8B%E6%8B%9B/" title="In 秋招">秋招</a>
</div>

    <span><a href="/2022/10/27/%E7%A7%8B%E6%8B%9B%E6%80%BB%E7%BB%93/" title="秋招总结">秋招总结</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/web%E5%AE%89%E5%85%A8/" title="In web安全">web安全</a>
</div>

    <span><a href="/2022/08/16/Unserialize/" title="unserialize">unserialize</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/web%E5%AE%89%E5%85%A8/" title="In web安全">web安全</a>
</div>

    <span><a href="/2022/06/27/SSRF/" title="SSRF">SSRF</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E9%80%86%E5%90%91/" title="In 逆向">逆向</a>
</div>

    <span><a href="/2022/11/11/reverse/" title="逆向">逆向</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%86%85%E7%BD%91/" title="In 内网">内网</a>
</div>

    <span><a href="/2022/12/25/%E5%86%85%E7%BD%91/" title="内网渗透">内网渗透</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E9%80%86%E5%90%91/" title="In 逆向">逆向</a>
</div>

    <span><a href="/2023/01/03/%E6%BB%B4%E6%B0%B4reverse/" title="水滴rev">水滴rev</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/web%E5%AE%89%E5%85%A8/" title="In web安全">web安全</a>
</div>

    <span><a href="/2022/11/17/JWT%20%E5%9F%BA%E7%A1%80/" title="JWT">JWT</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/07/15/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E/" title="中间件漏洞">中间件漏洞</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%86%85%E7%BD%91/" title="In 内网">内网</a>
</div>

    <span><a href="/2022/05/27/emergency%20response/" title="应急响应">应急响应</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/03/27/http/" title="http">http</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>Recent Comments</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">John Doe @ Yume Shoka</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2023/08/22/去弹窗绿化/',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,fancybox: true,
    copyright: 'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
